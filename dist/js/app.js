this.createjs=this.createjs||{},createjs.extend=function(t,e){"use strict";function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i},this.createjs=this.createjs||{},createjs.promote=function(t,e){"use strict";var i=t.prototype,n=Object.getPrototypeOf&&Object.getPrototypeOf(i)||i.__proto__;if(n){i[(e+="_")+"constructor"]=n.constructor;for(var s in n)i.hasOwnProperty(s)&&"function"==typeof n[s]&&(i[e+s]=n[s])}return t},this.createjs=this.createjs||{},createjs.indexOf=function(t,e){"use strict";for(var i=0,n=t.length;n>i;i++)if(e===t[i])return i;return-1},this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.type=t,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!e,this.cancelable=!!i,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var e=t.prototype;e.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},e.stopPropagation=function(){this.propagationStopped=!0},e.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},e.remove=function(){this.removed=!0},e.clone=function(){return new t(this.type,this.bubbles,this.cancelable)},e.set=function(t){for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[Event (type="+this.type+")]"},createjs.Event=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(){this._listeners=null,this._captureListeners=null}var e=t.prototype;t.initialize=function(t){t.addEventListener=e.addEventListener,t.on=e.on,t.removeEventListener=t.off=e.removeEventListener,t.removeAllEventListeners=e.removeAllEventListeners,t.hasEventListener=e.hasEventListener,t.dispatchEvent=e.dispatchEvent,t._dispatchEvent=e._dispatchEvent,t.willTrigger=e.willTrigger},e.addEventListener=function(t,e,i){var n;n=i?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{};var s=n[t];return s&&this.removeEventListener(t,e,i),s=n[t],s?s.push(e):n[t]=[e],e},e.on=function(t,e,i,n,s,r){return e.handleEvent&&(i=i||e,e=e.handleEvent),i=i||this,this.addEventListener(t,function(t){e.call(i,t,s),n&&t.remove()},r)},e.removeEventListener=function(t,e,i){var n=i?this._captureListeners:this._listeners;if(n){var s=n[t];if(s)for(var r=0,o=s.length;o>r;r++)if(s[r]==e){1==o?delete n[t]:s.splice(r,1);break}}},e.off=e.removeEventListener,e.removeAllEventListeners=function(t){t?(this._listeners&&delete this._listeners[t],this._captureListeners&&delete this._captureListeners[t]):this._listeners=this._captureListeners=null},e.dispatchEvent=function(t,e,i){if("string"==typeof t){var n=this._listeners;if(!(e||n&&n[t]))return!0;t=new createjs.Event(t,e,i)}else t.target&&t.clone&&(t=t.clone());try{t.target=this}catch(s){}if(t.bubbles&&this.parent){for(var r=this,o=[r];r.parent;)o.push(r=r.parent);var a,h=o.length;for(a=h-1;a>=0&&!t.propagationStopped;a--)o[a]._dispatchEvent(t,1+(0==a));for(a=1;h>a&&!t.propagationStopped;a++)o[a]._dispatchEvent(t,3)}else this._dispatchEvent(t,2);return!t.defaultPrevented},e.hasEventListener=function(t){var e=this._listeners,i=this._captureListeners;return!!(e&&e[t]||i&&i[t])},e.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.parent}return!1},e.toString=function(){return"[EventDispatcher]"},e._dispatchEvent=function(t,e){var i,n=1==e?this._captureListeners:this._listeners;if(t&&n){var s=n[t.type];if(!s||!(i=s.length))return;try{t.currentTarget=this}catch(r){}try{t.eventPhase=e}catch(r){}t.removed=!1,s=s.slice();for(var o=0;i>o&&!t.immediatePropagationStopped;o++){var a=s[o];a.handleEvent?a.handleEvent(t):a(t),t.removed&&(this.off(t.type,a,1==e),t.removed=!1)}}},createjs.EventDispatcher=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(){throw"Ticker cannot be instantiated."}t.RAF_SYNCHED="synched",t.RAF="raf",t.TIMEOUT="timeout",t.useRAF=!1,t.timingMode=null,t.maxDelta=0,t.paused=!1,t.removeEventListener=null,t.removeAllEventListeners=null,t.dispatchEvent=null,t.hasEventListener=null,t._listeners=null,createjs.EventDispatcher.initialize(t),t._addEventListener=t.addEventListener,t.addEventListener=function(){return!t._inited&&t.init(),t._addEventListener.apply(t,arguments)},t._inited=!1,t._startTime=0,t._pausedTime=0,t._ticks=0,t._pausedTicks=0,t._interval=50,t._lastTime=0,t._times=null,t._tickTimes=null,t._timerId=null,t._raf=!0,t.setInterval=function(e){t._interval=e,t._inited&&t._setupTick()},t.getInterval=function(){return t._interval},t.setFPS=function(e){t.setInterval(1e3/e)},t.getFPS=function(){return 1e3/t._interval};try{Object.defineProperties(t,{interval:{get:t.getInterval,set:t.setInterval},framerate:{get:t.getFPS,set:t.setFPS}})}catch(e){console.log(e)}t.init=function(){t._inited||(t._inited=!0,t._times=[],t._tickTimes=[],t._startTime=t._getTime(),t._times.push(t._lastTime=0),t.interval=t._interval)},t.reset=function(){if(t._raf){var e=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame;e&&e(t._timerId)}else clearTimeout(t._timerId);t.removeAllEventListeners("tick"),t._timerId=t._times=t._tickTimes=null,t._startTime=t._lastTime=t._ticks=0,t._inited=!1},t.getMeasuredTickTime=function(e){var i=0,n=t._tickTimes;if(!n||n.length<1)return-1;e=Math.min(n.length,e||0|t.getFPS());for(var s=0;e>s;s++)i+=n[s];return i/e},t.getMeasuredFPS=function(e){var i=t._times;return!i||i.length<2?-1:(e=Math.min(i.length-1,e||0|t.getFPS()),1e3/((i[0]-i[e])/e))},t.setPaused=function(e){t.paused=e},t.getPaused=function(){return t.paused},t.getTime=function(e){return t._startTime?t._getTime()-(e?t._pausedTime:0):-1},t.getEventTime=function(e){return t._startTime?(t._lastTime||t._startTime)-(e?t._pausedTime:0):-1},t.getTicks=function(e){return t._ticks-(e?t._pausedTicks:0)},t._handleSynch=function(){t._timerId=null,t._setupTick(),t._getTime()-t._lastTime>=.97*(t._interval-1)&&t._tick()},t._handleRAF=function(){t._timerId=null,t._setupTick(),t._tick()},t._handleTimeout=function(){t._timerId=null,t._setupTick(),t._tick()},t._setupTick=function(){if(null==t._timerId){var e=t.timingMode||t.useRAF&&t.RAF_SYNCHED;if(e==t.RAF_SYNCHED||e==t.RAF){var i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(i)return t._timerId=i(e==t.RAF?t._handleRAF:t._handleSynch),void(t._raf=!0)}t._raf=!1,t._timerId=setTimeout(t._handleTimeout,t._interval)}},t._tick=function(){var e=t.paused,i=t._getTime(),n=i-t._lastTime;if(t._lastTime=i,t._ticks++,e&&(t._pausedTicks++,t._pausedTime+=n),t.hasEventListener("tick")){var s=new createjs.Event("tick"),r=t.maxDelta;s.delta=r&&n>r?r:n,s.paused=e,s.time=i,s.runTime=i-t._pausedTime,t.dispatchEvent(s)}for(t._tickTimes.unshift(t._getTime()-i);t._tickTimes.length>100;)t._tickTimes.pop();for(t._times.unshift(i);t._times.length>100;)t._times.pop()};var i=window.performance&&(performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow);t._getTime=function(){return(i&&i.call(performance)||(new Date).getTime())-t._startTime},createjs.Ticker=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(){throw"UID cannot be instantiated"}t._nextID=0,t.get=function(){return t._nextID++},createjs.UID=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i,n,s,r,o,a,h,l,c){this.Event_constructor(t,e,i),this.stageX=n,this.stageY=s,this.rawX=null==h?n:h,this.rawY=null==l?s:l,this.nativeEvent=r,this.pointerID=o,this.primary=!!a,this.relatedTarget=c}var e=createjs.extend(t,createjs.Event);e._get_localX=function(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).x},e._get_localY=function(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).y},e._get_isTouch=function(){return-1!==this.pointerID};try{Object.defineProperties(e,{localX:{get:e._get_localX},localY:{get:e._get_localY},isTouch:{get:e._get_isTouch}})}catch(i){}e.clone=function(){return new t(this.type,this.bubbles,this.cancelable,this.stageX,this.stageY,this.nativeEvent,this.pointerID,this.primary,this.rawX,this.rawY)},e.toString=function(){return"[MouseEvent (type="+this.type+" stageX="+this.stageX+" stageY="+this.stageY+")]"},createjs.MouseEvent=createjs.promote(t,"Event")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i,n,s,r){this.setValues(t,e,i,n,s,r)}var e=t.prototype;t.DEG_TO_RAD=Math.PI/180,t.identity=null,e.setValues=function(t,e,i,n,s,r){return this.a=null==t?1:t,this.b=e||0,this.c=i||0,this.d=null==n?1:n,this.tx=s||0,this.ty=r||0,this},e.append=function(t,e,i,n,s,r){var o=this.a,a=this.b,h=this.c,l=this.d;return(1!=t||0!=e||0!=i||1!=n)&&(this.a=o*t+h*e,this.b=a*t+l*e,this.c=o*i+h*n,this.d=a*i+l*n),this.tx=o*s+h*r+this.tx,this.ty=a*s+l*r+this.ty,this},e.prepend=function(t,e,i,n,s,r){var o=this.a,a=this.c,h=this.tx;return this.a=t*o+i*this.b,this.b=e*o+n*this.b,this.c=t*a+i*this.d,this.d=e*a+n*this.d,this.tx=t*h+i*this.ty+s,this.ty=e*h+n*this.ty+r,this},e.appendMatrix=function(t){return this.append(t.a,t.b,t.c,t.d,t.tx,t.ty)},e.prependMatrix=function(t){return this.prepend(t.a,t.b,t.c,t.d,t.tx,t.ty)},e.appendTransform=function(e,i,n,s,r,o,a,h,l){if(r%360)var c=r*t.DEG_TO_RAD,u=Math.cos(c),d=Math.sin(c);else u=1,d=0;return o||a?(o*=t.DEG_TO_RAD,a*=t.DEG_TO_RAD,this.append(Math.cos(a),Math.sin(a),-Math.sin(o),Math.cos(o),e,i),this.append(u*n,d*n,-d*s,u*s,0,0)):this.append(u*n,d*n,-d*s,u*s,e,i),(h||l)&&(this.tx-=h*this.a+l*this.c,this.ty-=h*this.b+l*this.d),this},e.prependTransform=function(e,i,n,s,r,o,a,h,l){if(r%360)var c=r*t.DEG_TO_RAD,u=Math.cos(c),d=Math.sin(c);else u=1,d=0;return(h||l)&&(this.tx-=h,this.ty-=l),o||a?(o*=t.DEG_TO_RAD,a*=t.DEG_TO_RAD,this.prepend(u*n,d*n,-d*s,u*s,0,0),this.prepend(Math.cos(a),Math.sin(a),-Math.sin(o),Math.cos(o),e,i)):this.prepend(u*n,d*n,-d*s,u*s,e,i),this},e.rotate=function(e){e*=t.DEG_TO_RAD;var i=Math.cos(e),n=Math.sin(e),s=this.a,r=this.b;return this.a=s*i+this.c*n,this.b=r*i+this.d*n,this.c=-s*n+this.c*i,this.d=-r*n+this.d*i,this},e.skew=function(e,i){return e*=t.DEG_TO_RAD,i*=t.DEG_TO_RAD,this.append(Math.cos(i),Math.sin(i),-Math.sin(e),Math.cos(e),0,0),this},e.scale=function(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this},e.translate=function(t,e){return this.tx+=this.a*t+this.c*e,this.ty+=this.b*t+this.d*e,this},e.identity=function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},e.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,s=this.tx,r=t*n-e*i;return this.a=n/r,this.b=-e/r,this.c=-i/r,this.d=t/r,this.tx=(i*this.ty-n*s)/r,this.ty=-(t*this.ty-e*s)/r,this},e.isIdentity=function(){return 0===this.tx&&0===this.ty&&1===this.a&&0===this.b&&0===this.c&&1===this.d},e.equals=function(t){return this.tx===t.tx&&this.ty===t.ty&&this.a===t.a&&this.b===t.b&&this.c===t.c&&this.d===t.d},e.transformPoint=function(t,e,i){return i=i||{},i.x=t*this.a+e*this.c+this.tx,i.y=t*this.b+e*this.d+this.ty,i},e.decompose=function(e){null==e&&(e={}),e.x=this.tx,e.y=this.ty,e.scaleX=Math.sqrt(this.a*this.a+this.b*this.b),e.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);var i=Math.atan2(-this.c,this.d),n=Math.atan2(this.b,this.a),s=Math.abs(1-i/n);return 1e-5>s?(e.rotation=n/t.DEG_TO_RAD,this.a<0&&this.d>=0&&(e.rotation+=e.rotation<=0?180:-180),e.skewX=e.skewY=0):(e.skewX=i/t.DEG_TO_RAD,e.skewY=n/t.DEG_TO_RAD),e},e.copy=function(t){return this.setValues(t.a,t.b,t.c,t.d,t.tx,t.ty)},e.clone=function(){return new t(this.a,this.b,this.c,this.d,this.tx,this.ty)},e.toString=function(){return"[Matrix2D (a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+")]"},t.identity=new t,createjs.Matrix2D=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i,n,s){this.setValues(t,e,i,n,s)}var e=t.prototype;e.setValues=function(t,e,i,n,s){return this.visible=null==t?!0:!!t,this.alpha=null==e?1:e,this.shadow=i,this.compositeOperation=n,this.matrix=s||this.matrix&&this.matrix.identity()||new createjs.Matrix2D,this},e.append=function(t,e,i,n,s){return this.alpha*=e,this.shadow=i||this.shadow,this.compositeOperation=n||this.compositeOperation,this.visible=this.visible&&t,s&&this.matrix.appendMatrix(s),this},e.prepend=function(t,e,i,n,s){return this.alpha*=e,this.shadow=this.shadow||i,this.compositeOperation=this.compositeOperation||n,this.visible=this.visible&&t,s&&this.matrix.prependMatrix(s),this},e.identity=function(){return this.visible=!0,this.alpha=1,this.shadow=this.compositeOperation=null,this.matrix.identity(),this},e.clone=function(){return new t(this.alpha,this.shadow,this.compositeOperation,this.visible,this.matrix.clone())},createjs.DisplayProps=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.setValues(t,e)}var e=t.prototype;e.setValues=function(t,e){return this.x=t||0,this.y=e||0,this},e.copy=function(t){return this.x=t.x,this.y=t.y,this},e.clone=function(){return new t(this.x,this.y)},e.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"},createjs.Point=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i,n){this.setValues(t,e,i,n)}var e=t.prototype;e.setValues=function(t,e,i,n){return this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0,this},e.extend=function(t,e,i,n){return i=i||0,n=n||0,t+i>this.x+this.width&&(this.width=t+i-this.x),e+n>this.y+this.height&&(this.height=e+n-this.y),t<this.x&&(this.width+=this.x-t,this.x=t),e<this.y&&(this.height+=this.y-e,this.y=e),this},e.pad=function(t,e,i,n){return this.x-=e,this.y-=t,this.width+=e+n,this.height+=t+i,this},e.copy=function(t){return this.setValues(t.x,t.y,t.width,t.height)},e.contains=function(t,e,i,n){return i=i||0,n=n||0,t>=this.x&&t+i<=this.x+this.width&&e>=this.y&&e+n<=this.y+this.height},e.union=function(t){return this.clone().extend(t.x,t.y,t.width,t.height)},e.intersection=function(e){var i=e.x,n=e.y,s=i+e.width,r=n+e.height;return this.x>i&&(i=this.x),this.y>n&&(n=this.y),this.x+this.width<s&&(s=this.x+this.width),this.y+this.height<r&&(r=this.y+this.height),i>=s||n>=r?null:new t(i,n,s-i,r-n)},e.intersects=function(t){return t.x<=this.x+this.width&&this.x<=t.x+t.width&&t.y<=this.y+this.height&&this.y<=t.y+t.height},e.isEmpty=function(){return this.width<=0||this.height<=0},e.clone=function(){return new t(this.x,this.y,this.width,this.height)},e.toString=function(){return"[Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")]"},createjs.Rectangle=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i,n,s,r,o){t.addEventListener&&(this.target=t,this.overLabel=null==i?"over":i,this.outLabel=null==e?"out":e,this.downLabel=null==n?"down":n,this.play=s,this._isPressed=!1,this._isOver=!1,this._enabled=!1,t.mouseChildren=!1,this.enabled=!0,this.handleEvent({}),r&&(o&&(r.actionsEnabled=!1,r.gotoAndStop&&r.gotoAndStop(o)),t.hitArea=r))}var e=t.prototype;e.setEnabled=function(t){if(t!=this._enabled){var e=this.target;this._enabled=t,t?(e.cursor="pointer",e.addEventListener("rollover",this),e.addEventListener("rollout",this),e.addEventListener("mousedown",this),e.addEventListener("pressup",this),e._reset&&(e.__reset=e._reset,e._reset=this._reset)):(e.cursor=null,e.removeEventListener("rollover",this),e.removeEventListener("rollout",this),e.removeEventListener("mousedown",this),e.removeEventListener("pressup",this),e.__reset&&(e._reset=e.__reset,delete e.__reset))}},e.getEnabled=function(){return this._enabled};try{Object.defineProperties(e,{enabled:{get:e.getEnabled,set:e.setEnabled}})}catch(i){}e.toString=function(){return"[ButtonHelper]"},e.handleEvent=function(t){var e,i=this.target,n=t.type;"mousedown"==n?(this._isPressed=!0,e=this.downLabel):"pressup"==n?(this._isPressed=!1,e=this._isOver?this.overLabel:this.outLabel):"rollover"==n?(this._isOver=!0,e=this._isPressed?this.downLabel:this.overLabel):(this._isOver=!1,e=this._isPressed?this.overLabel:this.outLabel),this.play?i.gotoAndPlay&&i.gotoAndPlay(e):i.gotoAndStop&&i.gotoAndStop(e)},e._reset=function(){var t=this.paused;this.__reset(),this.paused=t},createjs.ButtonHelper=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i,n){this.color=t||"black",this.offsetX=e||0,this.offsetY=i||0,this.blur=n||0}var e=t.prototype;t.identity=new t("transparent",0,0,0),e.toString=function(){return"[Shadow]"},e.clone=function(){return new t(this.color,this.offsetX,this.offsetY,this.blur)},createjs.Shadow=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.EventDispatcher_constructor(),this.complete=!0,this.framerate=0,this._animations=null,this._frames=null,this._images=null,this._data=null,this._loadCount=0,this._frameHeight=0,this._frameWidth=0,this._numFrames=0,this._regX=0,this._regY=0,this._spacing=0,this._margin=0,this._parseData(t)}var e=createjs.extend(t,createjs.EventDispatcher);e.getAnimations=function(){return this._animations.slice()};try{Object.defineProperties(e,{animations:{get:e.getAnimations}})}catch(i){}e.getNumFrames=function(t){if(null==t)return this._frames?this._frames.length:this._numFrames||0;var e=this._data[t];return null==e?0:e.frames.length},e.getAnimation=function(t){return this._data[t]},e.getFrame=function(t){var e;return this._frames&&(e=this._frames[t])?e:null},e.getFrameBounds=function(t,e){var i=this.getFrame(t);return i?(e||new createjs.Rectangle).setValues(-i.regX,-i.regY,i.rect.width,i.rect.height):null},e.toString=function(){return"[SpriteSheet]"},e.clone=function(){throw"SpriteSheet cannot be cloned."},e._parseData=function(t){var e,i,n,s;if(null!=t){if(this.framerate=t.framerate||0,t.images&&(i=t.images.length)>0)for(s=this._images=[],e=0;i>e;e++){var r=t.images[e];if("string"==typeof r){var o=r;r=document.createElement("img"),r.src=o}s.push(r),r.getContext||r.naturalWidth||(this._loadCount++,this.complete=!1,function(t,e){r.onload=function(){t._handleImageLoad(e)}}(this,o),function(t,e){r.onerror=function(){t._handleImageError(e)}}(this,o))}if(null==t.frames);else if(Array.isArray(t.frames))for(this._frames=[],s=t.frames,e=0,i=s.length;i>e;e++){var a=s[e];this._frames.push({image:this._images[a[4]?a[4]:0],rect:new createjs.Rectangle(a[0],a[1],a[2],a[3]),regX:a[5]||0,regY:a[6]||0})}else n=t.frames,this._frameWidth=n.width,this._frameHeight=n.height,this._regX=n.regX||0,this._regY=n.regY||0,this._spacing=n.spacing||0,this._margin=n.margin||0,this._numFrames=n.count,0==this._loadCount&&this._calculateFrames();if(this._animations=[],null!=(n=t.animations)){this._data={};var h;for(h in n){var l={name:h},c=n[h];if("number"==typeof c)s=l.frames=[c];else if(Array.isArray(c))if(1==c.length)l.frames=[c[0]];else for(l.speed=c[3],l.next=c[2],s=l.frames=[],e=c[0];e<=c[1];e++)s.push(e);else{l.speed=c.speed,l.next=c.next;var u=c.frames;s=l.frames="number"==typeof u?[u]:u.slice(0)}(l.next===!0||void 0===l.next)&&(l.next=h),(l.next===!1||s.length<2&&l.next==h)&&(l.next=null),l.speed||(l.speed=1),this._animations.push(h),this._data[h]=l}}}},e._handleImageLoad=function(){0==--this._loadCount&&(this._calculateFrames(),this.complete=!0,this.dispatchEvent("complete"))},e._handleImageError=function(t){var e=new createjs.Event("error");e.src=t,this.dispatchEvent(e),0==--this._loadCount&&this.dispatchEvent("complete")},e._calculateFrames=function(){if(!this._frames&&0!=this._frameWidth){this._frames=[];var t=this._numFrames||1e5,e=0,i=this._frameWidth,n=this._frameHeight,s=this._spacing,r=this._margin;t:for(var o=0,a=this._images;o<a.length;o++)for(var h=a[o],l=h.width,c=h.height,u=r;c-r-n>=u;){for(var d=r;l-r-i>=d;){if(e>=t)break t;e++,this._frames.push({image:h,rect:new createjs.Rectangle(d,u,i,n),regX:this._regX,regY:this._regY}),d+=i+s}u+=n+s}this._numFrames=e}},createjs.SpriteSheet=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function t(){this.command=null,this._stroke=null,this._strokeStyle=null,this._oldStrokeStyle=null,this._strokeDash=null,this._oldStrokeDash=null,this._strokeIgnoreScale=!1,this._fill=null,this._instructions=[],this._commitIndex=0,this._activeInstructions=[],this._dirty=!1,this._storeIndex=0,this.clear()}var e=t.prototype,i=t;t.getRGB=function(t,e,i,n){return null!=t&&null==i&&(n=e,i=255&t,e=t>>8&255,t=t>>16&255),null==n?"rgb("+t+","+e+","+i+")":"rgba("+t+","+e+","+i+","+n+")"},t.getHSL=function(t,e,i,n){return null==n?"hsl("+t%360+","+e+"%,"+i+"%)":"hsla("+t%360+","+e+"%,"+i+"%,"+n+")"},t.BASE_64={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,a:26,b:27,c:28,d:29,e:30,f:31,g:32,h:33,i:34,j:35,k:36,l:37,m:38,n:39,o:40,p:41,q:42,r:43,s:44,t:45,u:46,v:47,w:48,x:49,y:50,z:51,0:52,1:53,2:54,3:55,4:56,5:57,6:58,7:59,8:60,9:61,"+":62,"/":63},t.STROKE_CAPS_MAP=["butt","round","square"],t.STROKE_JOINTS_MAP=["miter","round","bevel"];var n=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");n.getContext&&(t._ctx=n.getContext("2d"),n.width=n.height=1),e.getInstructions=function(){return this._updateInstructions(),this._instructions};try{Object.defineProperties(e,{instructions:{get:e.getInstructions}})}catch(s){}e.isEmpty=function(){return!(this._instructions.length||this._activeInstructions.length)},e.draw=function(t,e){this._updateInstructions();for(var i=this._instructions,n=this._storeIndex,s=i.length;s>n;n++)i[n].exec(t,e)},e.drawAsPath=function(t){this._updateInstructions();for(var e,i=this._instructions,n=this._storeIndex,s=i.length;s>n;n++)(e=i[n]).path!==!1&&e.exec(t)},e.moveTo=function(t,e){return this.append(new i.MoveTo(t,e),!0)},e.lineTo=function(t,e){return this.append(new i.LineTo(t,e))},e.arcTo=function(t,e,n,s,r){return this.append(new i.ArcTo(t,e,n,s,r))},e.arc=function(t,e,n,s,r,o){return this.append(new i.Arc(t,e,n,s,r,o))},e.quadraticCurveTo=function(t,e,n,s){return this.append(new i.QuadraticCurveTo(t,e,n,s))},e.bezierCurveTo=function(t,e,n,s,r,o){return this.append(new i.BezierCurveTo(t,e,n,s,r,o))},e.rect=function(t,e,n,s){return this.append(new i.Rect(t,e,n,s))},e.closePath=function(){return this._activeInstructions.length?this.append(new i.ClosePath):this},e.clear=function(){return this._instructions.length=this._activeInstructions.length=this._commitIndex=0,this._strokeStyle=this._oldStrokeStyle=this._stroke=this._fill=this._strokeDash=this._oldStrokeDash=null,this._dirty=this._strokeIgnoreScale=!1,this},e.beginFill=function(t){return this._setFill(t?new i.Fill(t):null)},e.beginLinearGradientFill=function(t,e,n,s,r,o){return this._setFill((new i.Fill).linearGradient(t,e,n,s,r,o))},e.beginRadialGradientFill=function(t,e,n,s,r,o,a,h){return this._setFill((new i.Fill).radialGradient(t,e,n,s,r,o,a,h))},e.beginBitmapFill=function(t,e,n){return this._setFill(new i.Fill(null,n).bitmap(t,e))},e.endFill=function(){return this.beginFill()},e.setStrokeStyle=function(t,e,n,s,r){return this._updateInstructions(!0),this._strokeStyle=this.command=new i.StrokeStyle(t,e,n,s,r),this._stroke&&(this._stroke.ignoreScale=r),this._strokeIgnoreScale=r,this},e.setStrokeDash=function(t,e){return this._updateInstructions(!0),this._strokeDash=this.command=new i.StrokeDash(t,e),this},e.beginStroke=function(t){return this._setStroke(t?new i.Stroke(t):null)},e.beginLinearGradientStroke=function(t,e,n,s,r,o){return this._setStroke((new i.Stroke).linearGradient(t,e,n,s,r,o))},e.beginRadialGradientStroke=function(t,e,n,s,r,o,a,h){return this._setStroke((new i.Stroke).radialGradient(t,e,n,s,r,o,a,h))},e.beginBitmapStroke=function(t,e){return this._setStroke((new i.Stroke).bitmap(t,e))},e.endStroke=function(){return this.beginStroke()},e.curveTo=e.quadraticCurveTo,e.drawRect=e.rect,e.drawRoundRect=function(t,e,i,n,s){return this.drawRoundRectComplex(t,e,i,n,s,s,s,s)},e.drawRoundRectComplex=function(t,e,n,s,r,o,a,h){return this.append(new i.RoundRect(t,e,n,s,r,o,a,h))},e.drawCircle=function(t,e,n){return this.append(new i.Circle(t,e,n))},e.drawEllipse=function(t,e,n,s){return this.append(new i.Ellipse(t,e,n,s))},e.drawPolyStar=function(t,e,n,s,r,o){return this.append(new i.PolyStar(t,e,n,s,r,o))},e.append=function(t,e){return this._activeInstructions.push(t),this.command=t,e||(this._dirty=!0),this},e.decodePath=function(e){for(var i=[this.moveTo,this.lineTo,this.quadraticCurveTo,this.bezierCurveTo,this.closePath],n=[2,2,4,6,0],s=0,r=e.length,o=[],a=0,h=0,l=t.BASE_64;r>s;){var c=e.charAt(s),u=l[c],d=u>>3,p=i[d];if(!p||3&u)throw"bad path data (@"+s+"): "+c;var f=n[d];d||(a=h=0),o.length=0,s++;for(var v=(u>>2&1)+2,m=0;f>m;m++){var g=l[e.charAt(s)],y=g>>5?-1:1;g=(31&g)<<6|l[e.charAt(s+1)],3==v&&(g=g<<6|l[e.charAt(s+2)]),g=y*g/10,m%2?a=g+=a:h=g+=h,o[m]=g,s+=v}p.apply(this,o)}return this},e.store=function(){return this._updateInstructions(!0),this._storeIndex=this._instructions.length,this},e.unstore=function(){return this._storeIndex=0,this},e.clone=function(){var e=new t;return e.command=this.command,e._stroke=this._stroke,e._strokeStyle=this._strokeStyle,e._strokeDash=this._strokeDash,e._strokeIgnoreScale=this._strokeIgnoreScale,e._fill=this._fill,e._instructions=this._instructions.slice(),e._commitIndex=this._commitIndex,e._activeInstructions=this._activeInstructions.slice(),e._dirty=this._dirty,e._storeIndex=this._storeIndex,e},e.toString=function(){return"[Graphics]"},e.mt=e.moveTo,e.lt=e.lineTo,e.at=e.arcTo,e.bt=e.bezierCurveTo,e.qt=e.quadraticCurveTo,e.a=e.arc,e.r=e.rect,e.cp=e.closePath,e.c=e.clear,e.f=e.beginFill,e.lf=e.beginLinearGradientFill,e.rf=e.beginRadialGradientFill,e.bf=e.beginBitmapFill,e.ef=e.endFill,e.ss=e.setStrokeStyle,e.sd=e.setStrokeDash,e.s=e.beginStroke,e.ls=e.beginLinearGradientStroke,e.rs=e.beginRadialGradientStroke,e.bs=e.beginBitmapStroke,e.es=e.endStroke,e.dr=e.drawRect,e.rr=e.drawRoundRect,e.rc=e.drawRoundRectComplex,e.dc=e.drawCircle,e.de=e.drawEllipse,e.dp=e.drawPolyStar,e.p=e.decodePath,e._updateInstructions=function(e){var i=this._instructions,n=this._activeInstructions,s=this._commitIndex;if(this._dirty&&n.length){i.length=s,i.push(t.beginCmd);var r=n.length,o=i.length;i.length=o+r;for(var a=0;r>a;a++)i[a+o]=n[a];this._fill&&i.push(this._fill),this._stroke&&(this._strokeDash!==this._oldStrokeDash&&(this._oldStrokeDash=this._strokeDash,i.push(this._strokeDash)),this._strokeStyle!==this._oldStrokeStyle&&(this._oldStrokeStyle=this._strokeStyle,i.push(this._strokeStyle)),i.push(this._stroke)),this._dirty=!1}e&&(n.length=0,this._commitIndex=i.length)},e._setFill=function(t){return this._updateInstructions(!0),this.command=this._fill=t,this},e._setStroke=function(t){return this._updateInstructions(!0),(this.command=this._stroke=t)&&(t.ignoreScale=this._strokeIgnoreScale),this},(i.LineTo=function(t,e){this.x=t,this.y=e}).prototype.exec=function(t){t.lineTo(this.x,this.y)},(i.MoveTo=function(t,e){this.x=t,this.y=e}).prototype.exec=function(t){t.moveTo(this.x,this.y)},(i.ArcTo=function(t,e,i,n,s){this.x1=t,this.y1=e,this.x2=i,this.y2=n,this.radius=s}).prototype.exec=function(t){t.arcTo(this.x1,this.y1,this.x2,this.y2,this.radius)},(i.Arc=function(t,e,i,n,s,r){this.x=t,this.y=e,this.radius=i,this.startAngle=n,this.endAngle=s,this.anticlockwise=!!r}).prototype.exec=function(t){t.arc(this.x,this.y,this.radius,this.startAngle,this.endAngle,this.anticlockwise)},(i.QuadraticCurveTo=function(t,e,i,n){this.cpx=t,this.cpy=e,this.x=i,this.y=n}).prototype.exec=function(t){t.quadraticCurveTo(this.cpx,this.cpy,this.x,this.y)},(i.BezierCurveTo=function(t,e,i,n,s,r){this.cp1x=t,this.cp1y=e,this.cp2x=i,this.cp2y=n,this.x=s,this.y=r}).prototype.exec=function(t){t.bezierCurveTo(this.cp1x,this.cp1y,this.cp2x,this.cp2y,this.x,this.y)},(i.Rect=function(t,e,i,n){this.x=t,this.y=e,this.w=i,this.h=n}).prototype.exec=function(t){t.rect(this.x,this.y,this.w,this.h)},(i.ClosePath=function(){}).prototype.exec=function(t){t.closePath()},(i.BeginPath=function(){}).prototype.exec=function(t){t.beginPath()},e=(i.Fill=function(t,e){this.style=t,this.matrix=e}).prototype,e.exec=function(t){if(this.style){t.fillStyle=this.style;var e=this.matrix;e&&(t.save(),t.transform(e.a,e.b,e.c,e.d,e.tx,e.ty)),t.fill(),e&&t.restore()}},e.linearGradient=function(e,i,n,s,r,o){for(var a=this.style=t._ctx.createLinearGradient(n,s,r,o),h=0,l=e.length;l>h;h++)a.addColorStop(i[h],e[h]);return a.props={colors:e,ratios:i,x0:n,y0:s,x1:r,y1:o,type:"linear"},this},e.radialGradient=function(e,i,n,s,r,o,a,h){for(var l=this.style=t._ctx.createRadialGradient(n,s,r,o,a,h),c=0,u=e.length;u>c;c++)l.addColorStop(i[c],e[c]);return l.props={colors:e,ratios:i,x0:n,y0:s,r0:r,x1:o,y1:a,r1:h,type:"radial"},this},e.bitmap=function(e,i){if(e.naturalWidth||e.getContext||e.readyState>=2){var n=this.style=t._ctx.createPattern(e,i||"");n.props={image:e,repetition:i,type:"bitmap"}}return this},e.path=!1,e=(i.Stroke=function(t,e){this.style=t,this.ignoreScale=e}).prototype,e.exec=function(t){this.style&&(t.strokeStyle=this.style,this.ignoreScale&&(t.save(),t.setTransform(1,0,0,1,0,0)),t.stroke(),this.ignoreScale&&t.restore())},e.linearGradient=i.Fill.prototype.linearGradient,e.radialGradient=i.Fill.prototype.radialGradient,e.bitmap=i.Fill.prototype.bitmap,e.path=!1,e=(i.StrokeStyle=function(t,e,i,n,s){this.width=t,this.caps=e,this.joints=i,this.miterLimit=n,this.ignoreScale=s}).prototype,e.exec=function(e){e.lineWidth=null==this.width?"1":this.width,e.lineCap=null==this.caps?"butt":isNaN(this.caps)?this.caps:t.STROKE_CAPS_MAP[this.caps],e.lineJoin=null==this.joints?"miter":isNaN(this.joints)?this.joints:t.STROKE_JOINTS_MAP[this.joints],e.miterLimit=null==this.miterLimit?"10":this.miterLimit,e.ignoreScale=null==this.ignoreScale?!1:this.ignoreScale},e.path=!1,(i.StrokeDash=function(t,e){this.segments=t,this.offset=e||0}).prototype.exec=function(t){t.setLineDash&&(t.setLineDash(this.segments||i.StrokeDash.EMPTY_SEGMENTS),t.lineDashOffset=this.offset||0)},i.StrokeDash.EMPTY_SEGMENTS=[],(i.RoundRect=function(t,e,i,n,s,r,o,a){this.x=t,this.y=e,this.w=i,this.h=n,this.radiusTL=s,this.radiusTR=r,this.radiusBR=o,this.radiusBL=a}).prototype.exec=function(t){var e=(l>h?h:l)/2,i=0,n=0,s=0,r=0,o=this.x,a=this.y,h=this.w,l=this.h,c=this.radiusTL,u=this.radiusTR,d=this.radiusBR,p=this.radiusBL;0>c&&(c*=i=-1),c>e&&(c=e),0>u&&(u*=n=-1),u>e&&(u=e),0>d&&(d*=s=-1),d>e&&(d=e),0>p&&(p*=r=-1),p>e&&(p=e),t.moveTo(o+h-u,a),t.arcTo(o+h+u*n,a-u*n,o+h,a+u,u),t.lineTo(o+h,a+l-d),t.arcTo(o+h+d*s,a+l+d*s,o+h-d,a+l,d),t.lineTo(o+p,a+l),t.arcTo(o-p*r,a+l+p*r,o,a+l-p,p),t.lineTo(o,a+c),t.arcTo(o-c*i,a-c*i,o+c,a,c),t.closePath()},(i.Circle=function(t,e,i){this.x=t,this.y=e,this.radius=i}).prototype.exec=function(t){t.arc(this.x,this.y,this.radius,0,2*Math.PI)},(i.Ellipse=function(t,e,i,n){this.x=t,this.y=e,this.w=i,this.h=n}).prototype.exec=function(t){var e=this.x,i=this.y,n=this.w,s=this.h,r=.5522848,o=n/2*r,a=s/2*r,h=e+n,l=i+s,c=e+n/2,u=i+s/2;t.moveTo(e,u),t.bezierCurveTo(e,u-a,c-o,i,c,i),t.bezierCurveTo(c+o,i,h,u-a,h,u),t.bezierCurveTo(h,u+a,c+o,l,c,l),t.bezierCurveTo(c-o,l,e,u+a,e,u)},(i.PolyStar=function(t,e,i,n,s,r){this.x=t,this.y=e,this.radius=i,this.sides=n,this.pointSize=s,this.angle=r}).prototype.exec=function(t){var e=this.x,i=this.y,n=this.radius,s=(this.angle||0)/180*Math.PI,r=this.sides,o=1-(this.pointSize||0),a=Math.PI/r;t.moveTo(e+Math.cos(s)*n,i+Math.sin(s)*n);for(var h=0;r>h;h++)s+=a,1!=o&&t.lineTo(e+Math.cos(s)*n*o,i+Math.sin(s)*n*o),s+=a,t.lineTo(e+Math.cos(s)*n,i+Math.sin(s)*n);t.closePath()},t.beginCmd=new i.BeginPath,createjs.Graphics=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(){this.EventDispatcher_constructor(),this.alpha=1,this.cacheCanvas=null,this.cacheID=0,this.id=createjs.UID.get(),this.mouseEnabled=!0,this.tickEnabled=!0,this.name=null,this.parent=null,this.regX=0,this.regY=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.skewX=0,this.skewY=0,this.shadow=null,this.visible=!0,this.x=0,this.y=0,this.transformMatrix=null,this.compositeOperation=null,this.snapToPixel=!0,this.filters=null,
this.mask=null,this.hitArea=null,this.cursor=null,this._cacheOffsetX=0,this._cacheOffsetY=0,this._filterOffsetX=0,this._filterOffsetY=0,this._cacheScale=1,this._cacheDataURLID=0,this._cacheDataURL=null,this._props=new createjs.DisplayProps,this._rectangle=new createjs.Rectangle,this._bounds=null}var e=createjs.extend(t,createjs.EventDispatcher);t._MOUSE_EVENTS=["click","dblclick","mousedown","mouseout","mouseover","pressmove","pressup","rollout","rollover"],t.suppressCrossDomainErrors=!1,t._snapToPixelEnabled=!1;var i=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");i.getContext&&(t._hitTestCanvas=i,t._hitTestContext=i.getContext("2d"),i.width=i.height=1),t._nextCacheID=1,e.getStage=function(){for(var t=this,e=createjs.Stage;t.parent;)t=t.parent;return t instanceof e?t:null};try{Object.defineProperties(e,{stage:{get:e.getStage}})}catch(n){}e.isVisible=function(){return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY)},e.draw=function(t,e){var i=this.cacheCanvas;if(e||!i)return!1;var n=this._cacheScale;return t.drawImage(i,this._cacheOffsetX+this._filterOffsetX,this._cacheOffsetY+this._filterOffsetY,i.width/n,i.height/n),!0},e.updateContext=function(e){var i=this,n=i.mask,s=i._props.matrix;n&&n.graphics&&!n.graphics.isEmpty()&&(n.getMatrix(s),e.transform(s.a,s.b,s.c,s.d,s.tx,s.ty),n.graphics.drawAsPath(e),e.clip(),s.invert(),e.transform(s.a,s.b,s.c,s.d,s.tx,s.ty)),this.getMatrix(s);var r=s.tx,o=s.ty;t._snapToPixelEnabled&&i.snapToPixel&&(r=r+(0>r?-.5:.5)|0,o=o+(0>o?-.5:.5)|0),e.transform(s.a,s.b,s.c,s.d,r,o),e.globalAlpha*=i.alpha,i.compositeOperation&&(e.globalCompositeOperation=i.compositeOperation),i.shadow&&this._applyShadow(e,i.shadow)},e.cache=function(t,e,i,n,s){s=s||1,this.cacheCanvas||(this.cacheCanvas=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas")),this._cacheWidth=i,this._cacheHeight=n,this._cacheOffsetX=t,this._cacheOffsetY=e,this._cacheScale=s,this.updateCache()},e.updateCache=function(e){var i=this.cacheCanvas;if(!i)throw"cache() must be called before updateCache()";var n=this._cacheScale,s=this._cacheOffsetX*n,r=this._cacheOffsetY*n,o=this._cacheWidth,a=this._cacheHeight,h=i.getContext("2d"),l=this._getFilterBounds();s+=this._filterOffsetX=l.x,r+=this._filterOffsetY=l.y,o=Math.ceil(o*n)+l.width,a=Math.ceil(a*n)+l.height,o!=i.width||a!=i.height?(i.width=o,i.height=a):e||h.clearRect(0,0,o+1,a+1),h.save(),h.globalCompositeOperation=e,h.setTransform(n,0,0,n,-s,-r),this.draw(h,!0),this._applyFilters(),h.restore(),this.cacheID=t._nextCacheID++},e.uncache=function(){this._cacheDataURL=this.cacheCanvas=null,this.cacheID=this._cacheOffsetX=this._cacheOffsetY=this._filterOffsetX=this._filterOffsetY=0,this._cacheScale=1},e.getCacheDataURL=function(){return this.cacheCanvas?(this.cacheID!=this._cacheDataURLID&&(this._cacheDataURL=this.cacheCanvas.toDataURL()),this._cacheDataURL):null},e.localToGlobal=function(t,e,i){return this.getConcatenatedMatrix(this._props.matrix).transformPoint(t,e,i||new createjs.Point)},e.globalToLocal=function(t,e,i){return this.getConcatenatedMatrix(this._props.matrix).invert().transformPoint(t,e,i||new createjs.Point)},e.localToLocal=function(t,e,i,n){return n=this.localToGlobal(t,e,n),i.globalToLocal(n.x,n.y,n)},e.setTransform=function(t,e,i,n,s,r,o,a,h){return this.x=t||0,this.y=e||0,this.scaleX=null==i?1:i,this.scaleY=null==n?1:n,this.rotation=s||0,this.skewX=r||0,this.skewY=o||0,this.regX=a||0,this.regY=h||0,this},e.getMatrix=function(t){var e=this,i=t&&t.identity()||new createjs.Matrix2D;return e.transformMatrix?i.copy(e.transformMatrix):i.appendTransform(e.x,e.y,e.scaleX,e.scaleY,e.rotation,e.skewX,e.skewY,e.regX,e.regY)},e.getConcatenatedMatrix=function(t){for(var e=this,i=this.getMatrix(t);e=e.parent;)i.prependMatrix(e.getMatrix(e._props.matrix));return i},e.getConcatenatedDisplayProps=function(t){t=t?t.identity():new createjs.DisplayProps;var e=this,i=e.getMatrix(t.matrix);do t.prepend(e.visible,e.alpha,e.shadow,e.compositeOperation),e!=this&&i.prependMatrix(e.getMatrix(e._props.matrix));while(e=e.parent);return t},e.hitTest=function(e,i){var n=t._hitTestContext;n.setTransform(1,0,0,1,-e,-i),this.draw(n);var s=this._testHit(n);return n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,2,2),s},e.set=function(t){for(var e in t)this[e]=t[e];return this},e.getBounds=function(){if(this._bounds)return this._rectangle.copy(this._bounds);var t=this.cacheCanvas;if(t){var e=this._cacheScale;return this._rectangle.setValues(this._cacheOffsetX,this._cacheOffsetY,t.width/e,t.height/e)}return null},e.getTransformedBounds=function(){return this._getBounds()},e.setBounds=function(t,e,i,n){null==t&&(this._bounds=t),this._bounds=(this._bounds||new createjs.Rectangle).setValues(t,e,i,n)},e.clone=function(){return this._cloneProps(new t)},e.toString=function(){return"[DisplayObject (name="+this.name+")]"},e._cloneProps=function(t){return t.alpha=this.alpha,t.mouseEnabled=this.mouseEnabled,t.tickEnabled=this.tickEnabled,t.name=this.name,t.regX=this.regX,t.regY=this.regY,t.rotation=this.rotation,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.shadow=this.shadow,t.skewX=this.skewX,t.skewY=this.skewY,t.visible=this.visible,t.x=this.x,t.y=this.y,t.compositeOperation=this.compositeOperation,t.snapToPixel=this.snapToPixel,t.filters=null==this.filters?null:this.filters.slice(0),t.mask=this.mask,t.hitArea=this.hitArea,t.cursor=this.cursor,t._bounds=this._bounds,t},e._applyShadow=function(t,e){e=e||Shadow.identity,t.shadowColor=e.color,t.shadowOffsetX=e.offsetX,t.shadowOffsetY=e.offsetY,t.shadowBlur=e.blur},e._tick=function(t){var e=this._listeners;e&&e.tick&&(t.target=null,t.propagationStopped=t.immediatePropagationStopped=!1,this.dispatchEvent(t))},e._testHit=function(e){try{var i=e.getImageData(0,0,1,1).data[3]>1}catch(n){if(!t.suppressCrossDomainErrors)throw"An error has occurred. This is most likely due to security restrictions on reading canvas pixel data with local or cross-domain images."}return i},e._applyFilters=function(){if(this.filters&&0!=this.filters.length&&this.cacheCanvas)for(var t=this.filters.length,e=this.cacheCanvas.getContext("2d"),i=this.cacheCanvas.width,n=this.cacheCanvas.height,s=0;t>s;s++)this.filters[s].applyFilter(e,0,0,i,n)},e._getFilterBounds=function(){var t,e=this.filters,i=this._rectangle.setValues(0,0,0,0);if(!e||!(t=e.length))return i;for(var n=0;t>n;n++){var s=this.filters[n];s.getBounds&&s.getBounds(i)}return i},e._getBounds=function(t,e){return this._transformBounds(this.getBounds(),t,e)},e._transformBounds=function(t,e,i){if(!t)return t;var n=t.x,s=t.y,r=t.width,o=t.height,a=this._props.matrix;a=i?a.identity():this.getMatrix(a),(n||s)&&a.appendTransform(0,0,1,1,0,0,0,-n,-s),e&&a.prependMatrix(e);var h=r*a.a,l=r*a.b,c=o*a.c,u=o*a.d,d=a.tx,p=a.ty,f=d,v=d,m=p,g=p;return(n=h+d)<f?f=n:n>v&&(v=n),(n=h+c+d)<f?f=n:n>v&&(v=n),(n=c+d)<f?f=n:n>v&&(v=n),(s=l+p)<m?m=s:s>g&&(g=s),(s=l+u+p)<m?m=s:s>g&&(g=s),(s=u+p)<m?m=s:s>g&&(g=s),t.setValues(f,m,v-f,g-m)},e._hasMouseEventListener=function(){for(var e=t._MOUSE_EVENTS,i=0,n=e.length;n>i;i++)if(this.hasEventListener(e[i]))return!0;return!!this.cursor},createjs.DisplayObject=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function t(){this.DisplayObject_constructor(),this.children=[],this.mouseChildren=!0,this.tickChildren=!0}var e=createjs.extend(t,createjs.DisplayObject);e.getNumChildren=function(){return this.children.length};try{Object.defineProperties(e,{numChildren:{get:e.getNumChildren}})}catch(i){}e.initialize=t,e.isVisible=function(){var t=this.cacheCanvas||this.children.length;return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&t)},e.draw=function(t,e){if(this.DisplayObject_draw(t,e))return!0;for(var i=this.children.slice(),n=0,s=i.length;s>n;n++){var r=i[n];r.isVisible()&&(t.save(),r.updateContext(t),r.draw(t),t.restore())}return!0},e.addChild=function(t){if(null==t)return t;var e=arguments.length;if(e>1){for(var i=0;e>i;i++)this.addChild(arguments[i]);return arguments[e-1]}return t.parent&&t.parent.removeChild(t),t.parent=this,this.children.push(t),t.dispatchEvent("added"),t},e.addChildAt=function(t,e){var i=arguments.length,n=arguments[i-1];if(0>n||n>this.children.length)return arguments[i-2];if(i>2){for(var s=0;i-1>s;s++)this.addChildAt(arguments[s],n+s);return arguments[i-2]}return t.parent&&t.parent.removeChild(t),t.parent=this,this.children.splice(e,0,t),t.dispatchEvent("added"),t},e.removeChild=function(t){var e=arguments.length;if(e>1){for(var i=!0,n=0;e>n;n++)i=i&&this.removeChild(arguments[n]);return i}return this.removeChildAt(createjs.indexOf(this.children,t))},e.removeChildAt=function(t){var e=arguments.length;if(e>1){for(var i=[],n=0;e>n;n++)i[n]=arguments[n];i.sort(function(t,e){return e-t});for(var s=!0,n=0;e>n;n++)s=s&&this.removeChildAt(i[n]);return s}if(0>t||t>this.children.length-1)return!1;var r=this.children[t];return r&&(r.parent=null),this.children.splice(t,1),r.dispatchEvent("removed"),!0},e.removeAllChildren=function(){for(var t=this.children;t.length;)this.removeChildAt(0)},e.getChildAt=function(t){return this.children[t]},e.getChildByName=function(t){for(var e=this.children,i=0,n=e.length;n>i;i++)if(e[i].name==t)return e[i];return null},e.sortChildren=function(t){this.children.sort(t)},e.getChildIndex=function(t){return createjs.indexOf(this.children,t)},e.swapChildrenAt=function(t,e){var i=this.children,n=i[t],s=i[e];n&&s&&(i[t]=s,i[e]=n)},e.swapChildren=function(t,e){for(var i,n,s=this.children,r=0,o=s.length;o>r&&(s[r]==t&&(i=r),s[r]==e&&(n=r),null==i||null==n);r++);r!=o&&(s[i]=e,s[n]=t)},e.setChildIndex=function(t,e){var i=this.children,n=i.length;if(!(t.parent!=this||0>e||e>=n)){for(var s=0;n>s&&i[s]!=t;s++);s!=n&&s!=e&&(i.splice(s,1),i.splice(e,0,t))}},e.contains=function(t){for(;t;){if(t==this)return!0;t=t.parent}return!1},e.hitTest=function(t,e){return null!=this.getObjectUnderPoint(t,e)},e.getObjectsUnderPoint=function(t,e,i){var n=[],s=this.localToGlobal(t,e);return this._getObjectsUnderPoint(s.x,s.y,n,i>0,1==i),n},e.getObjectUnderPoint=function(t,e,i){var n=this.localToGlobal(t,e);return this._getObjectsUnderPoint(n.x,n.y,null,i>0,1==i)},e.getBounds=function(){return this._getBounds(null,!0)},e.getTransformedBounds=function(){return this._getBounds()},e.clone=function(e){var i=this._cloneProps(new t);return e&&this._cloneChildren(i),i},e.toString=function(){return"[Container (name="+this.name+")]"},e._tick=function(t){if(this.tickChildren)for(var e=this.children.length-1;e>=0;e--){var i=this.children[e];i.tickEnabled&&i._tick&&i._tick(t)}this.DisplayObject__tick(t)},e._cloneChildren=function(t){t.children.length&&t.removeAllChildren();for(var e=t.children,i=0,n=this.children.length;n>i;i++){var s=this.children[i].clone(!0);s.parent=t,e.push(s)}},e._getObjectsUnderPoint=function(e,i,n,s,r,o){if(o=o||0,!o&&!this._testMask(this,e,i))return null;var a,h=createjs.DisplayObject._hitTestContext;r=r||s&&this._hasMouseEventListener();for(var l=this.children,c=l.length,u=c-1;u>=0;u--){var d=l[u],p=d.hitArea;if(d.visible&&(p||d.isVisible())&&(!s||d.mouseEnabled)&&(p||this._testMask(d,e,i)))if(!p&&d instanceof t){var f=d._getObjectsUnderPoint(e,i,n,s,r,o+1);if(!n&&f)return s&&!this.mouseChildren?this:f}else{if(s&&!r&&!d._hasMouseEventListener())continue;var v=d.getConcatenatedDisplayProps(d._props);if(a=v.matrix,p&&(a.appendMatrix(p.getMatrix(p._props.matrix)),v.alpha=p.alpha),h.globalAlpha=v.alpha,h.setTransform(a.a,a.b,a.c,a.d,a.tx-e,a.ty-i),(p||d).draw(h),!this._testHit(h))continue;if(h.setTransform(1,0,0,1,0,0),h.clearRect(0,0,2,2),!n)return s&&!this.mouseChildren?this:d;n.push(d)}}return null},e._testMask=function(t,e,i){var n=t.mask;if(!n||!n.graphics||n.graphics.isEmpty())return!0;var s=this._props.matrix,r=t.parent;s=r?r.getConcatenatedMatrix(s):s.identity(),s=n.getMatrix(n._props.matrix).prependMatrix(s);var o=createjs.DisplayObject._hitTestContext;return o.setTransform(s.a,s.b,s.c,s.d,s.tx-e,s.ty-i),n.graphics.drawAsPath(o),o.fillStyle="#000",o.fill(),this._testHit(o)?(o.setTransform(1,0,0,1,0,0),o.clearRect(0,0,2,2),!0):!1},e._getBounds=function(t,e){var i=this.DisplayObject_getBounds();if(i)return this._transformBounds(i,t,e);var n=this._props.matrix;n=e?n.identity():this.getMatrix(n),t&&n.prependMatrix(t);for(var s=this.children.length,r=null,o=0;s>o;o++){var a=this.children[o];a.visible&&(i=a._getBounds(n))&&(r?r.extend(i.x,i.y,i.width,i.height):r=i.clone())}return r},createjs.Container=createjs.promote(t,"DisplayObject")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.Container_constructor(),this.autoClear=!0,this.canvas="string"==typeof t?document.getElementById(t):t,this.mouseX=0,this.mouseY=0,this.drawRect=null,this.snapToPixelEnabled=!1,this.mouseInBounds=!1,this.tickOnUpdate=!0,this.mouseMoveOutside=!1,this.preventSelection=!0,this._pointerData={},this._pointerCount=0,this._primaryPointerID=null,this._mouseOverIntervalID=null,this._nextStage=null,this._prevStage=null,this.enableDOMEvents(!0)}var e=createjs.extend(t,createjs.Container);e._get_nextStage=function(){return this._nextStage},e._set_nextStage=function(t){this._nextStage&&(this._nextStage._prevStage=null),t&&(t._prevStage=this),this._nextStage=t};try{Object.defineProperties(e,{nextStage:{get:e._get_nextStage,set:e._set_nextStage}})}catch(i){}e.update=function(t){if(this.canvas&&(this.tickOnUpdate&&this.tick(t),this.dispatchEvent("drawstart",!1,!0)!==!1)){createjs.DisplayObject._snapToPixelEnabled=this.snapToPixelEnabled;var e=this.drawRect,i=this.canvas.getContext("2d");i.setTransform(1,0,0,1,0,0),this.autoClear&&(e?i.clearRect(e.x,e.y,e.width,e.height):i.clearRect(0,0,this.canvas.width+1,this.canvas.height+1)),i.save(),this.drawRect&&(i.beginPath(),i.rect(e.x,e.y,e.width,e.height),i.clip()),this.updateContext(i),this.draw(i,!1),i.restore(),this.dispatchEvent("drawend")}},e.tick=function(t){if(this.tickEnabled&&this.dispatchEvent("tickstart",!1,!0)!==!1){var e=new createjs.Event("tick");if(t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);this._tick(e),this.dispatchEvent("tickend")}},e.handleEvent=function(t){"tick"==t.type&&this.update(t)},e.clear=function(){if(this.canvas){var t=this.canvas.getContext("2d");t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,this.canvas.width+1,this.canvas.height+1)}},e.toDataURL=function(t,e){var i,n=this.canvas.getContext("2d"),s=this.canvas.width,r=this.canvas.height;if(t){i=n.getImageData(0,0,s,r);var o=n.globalCompositeOperation;n.globalCompositeOperation="destination-over",n.fillStyle=t,n.fillRect(0,0,s,r)}var a=this.canvas.toDataURL(e||"image/png");return t&&(n.putImageData(i,0,0),n.globalCompositeOperation=o),a},e.enableMouseOver=function(t){if(this._mouseOverIntervalID&&(clearInterval(this._mouseOverIntervalID),this._mouseOverIntervalID=null,0==t&&this._testMouseOver(!0)),null==t)t=20;else if(0>=t)return;var e=this;this._mouseOverIntervalID=setInterval(function(){e._testMouseOver()},1e3/Math.min(50,t))},e.enableDOMEvents=function(t){null==t&&(t=!0);var e,i,n=this._eventListeners;if(!t&&n){for(e in n)i=n[e],i.t.removeEventListener(e,i.f,!1);this._eventListeners=null}else if(t&&!n&&this.canvas){var s=window.addEventListener?window:document,r=this;n=this._eventListeners={},n.mouseup={t:s,f:function(t){r._handleMouseUp(t)}},n.mousemove={t:s,f:function(t){r._handleMouseMove(t)}},n.dblclick={t:this.canvas,f:function(t){r._handleDoubleClick(t)}},n.mousedown={t:this.canvas,f:function(t){r._handleMouseDown(t)}};for(e in n)i=n[e],i.t.addEventListener(e,i.f,!1)}},e.clone=function(){throw"Stage cannot be cloned."},e.toString=function(){return"[Stage (name="+this.name+")]"},e._getElementRect=function(t){var e;try{e=t.getBoundingClientRect()}catch(i){e={top:t.offsetTop,left:t.offsetLeft,width:t.offsetWidth,height:t.offsetHeight}}var n=(window.pageXOffset||document.scrollLeft||0)-(document.clientLeft||document.body.clientLeft||0),s=(window.pageYOffset||document.scrollTop||0)-(document.clientTop||document.body.clientTop||0),r=window.getComputedStyle?getComputedStyle(t,null):t.currentStyle,o=parseInt(r.paddingLeft)+parseInt(r.borderLeftWidth),a=parseInt(r.paddingTop)+parseInt(r.borderTopWidth),h=parseInt(r.paddingRight)+parseInt(r.borderRightWidth),l=parseInt(r.paddingBottom)+parseInt(r.borderBottomWidth);return{left:e.left+n+o,right:e.right+n-h,top:e.top+s+a,bottom:e.bottom+s-l}},e._getPointerData=function(t){var e=this._pointerData[t];return e||(e=this._pointerData[t]={x:0,y:0}),e},e._handleMouseMove=function(t){t||(t=window.event),this._handlePointerMove(-1,t,t.pageX,t.pageY)},e._handlePointerMove=function(t,e,i,n,s){if((!this._prevStage||void 0!==s)&&this.canvas){var r=this._nextStage,o=this._getPointerData(t),a=o.inBounds;this._updatePointerPosition(t,e,i,n),(a||o.inBounds||this.mouseMoveOutside)&&(-1===t&&o.inBounds==!a&&this._dispatchMouseEvent(this,a?"mouseleave":"mouseenter",!1,t,o,e),this._dispatchMouseEvent(this,"stagemousemove",!1,t,o,e),this._dispatchMouseEvent(o.target,"pressmove",!0,t,o,e)),r&&r._handlePointerMove(t,e,i,n,null)}},e._updatePointerPosition=function(t,e,i,n){var s=this._getElementRect(this.canvas);i-=s.left,n-=s.top;var r=this.canvas.width,o=this.canvas.height;i/=(s.right-s.left)/r,n/=(s.bottom-s.top)/o;var a=this._getPointerData(t);(a.inBounds=i>=0&&n>=0&&r-1>=i&&o-1>=n)?(a.x=i,a.y=n):this.mouseMoveOutside&&(a.x=0>i?0:i>r-1?r-1:i,a.y=0>n?0:n>o-1?o-1:n),a.posEvtObj=e,a.rawX=i,a.rawY=n,(t===this._primaryPointerID||-1===t)&&(this.mouseX=a.x,this.mouseY=a.y,this.mouseInBounds=a.inBounds)},e._handleMouseUp=function(t){this._handlePointerUp(-1,t,!1)},e._handlePointerUp=function(t,e,i,n){var s=this._nextStage,r=this._getPointerData(t);if(!this._prevStage||void 0!==n){var o=null,a=r.target;n||!a&&!s||(o=this._getObjectsUnderPoint(r.x,r.y,null,!0)),r.down&&(this._dispatchMouseEvent(this,"stagemouseup",!1,t,r,e,o),r.down=!1),o==a&&this._dispatchMouseEvent(a,"click",!0,t,r,e),this._dispatchMouseEvent(a,"pressup",!0,t,r,e),i?(t==this._primaryPointerID&&(this._primaryPointerID=null),delete this._pointerData[t]):r.target=null,s&&s._handlePointerUp(t,e,i,n||o&&this)}},e._handleMouseDown=function(t){this._handlePointerDown(-1,t,t.pageX,t.pageY)},e._handlePointerDown=function(t,e,i,n,s){this.preventSelection&&e.preventDefault(),(null==this._primaryPointerID||-1===t)&&(this._primaryPointerID=t),null!=n&&this._updatePointerPosition(t,e,i,n);var r=null,o=this._nextStage,a=this._getPointerData(t);s||(r=a.target=this._getObjectsUnderPoint(a.x,a.y,null,!0)),a.inBounds&&(this._dispatchMouseEvent(this,"stagemousedown",!1,t,a,e,r),a.down=!0),this._dispatchMouseEvent(r,"mousedown",!0,t,a,e),o&&o._handlePointerDown(t,e,i,n,s||r&&this)},e._testMouseOver=function(t,e,i){if(!this._prevStage||void 0!==e){var n=this._nextStage;if(!this._mouseOverIntervalID)return void(n&&n._testMouseOver(t,e,i));var s=this._getPointerData(-1);if(s&&(t||this.mouseX!=this._mouseOverX||this.mouseY!=this._mouseOverY||!this.mouseInBounds)){var r,o,a,h=s.posEvtObj,l=i||h&&h.target==this.canvas,c=null,u=-1,d="";!e&&(t||this.mouseInBounds&&l)&&(c=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,!0),this._mouseOverX=this.mouseX,this._mouseOverY=this.mouseY);var p=this._mouseOverTarget||[],f=p[p.length-1],v=this._mouseOverTarget=[];for(r=c;r;)v.unshift(r),d||(d=r.cursor),r=r.parent;for(this.canvas.style.cursor=d,!e&&i&&(i.canvas.style.cursor=d),o=0,a=v.length;a>o&&v[o]==p[o];o++)u=o;for(f!=c&&this._dispatchMouseEvent(f,"mouseout",!0,-1,s,h,c),o=p.length-1;o>u;o--)this._dispatchMouseEvent(p[o],"rollout",!1,-1,s,h,c);for(o=v.length-1;o>u;o--)this._dispatchMouseEvent(v[o],"rollover",!1,-1,s,h,f);f!=c&&this._dispatchMouseEvent(c,"mouseover",!0,-1,s,h,f),n&&n._testMouseOver(t,e||c&&this,i||l&&this)}}},e._handleDoubleClick=function(t,e){var i=null,n=this._nextStage,s=this._getPointerData(-1);e||(i=this._getObjectsUnderPoint(s.x,s.y,null,!0),this._dispatchMouseEvent(i,"dblclick",!0,-1,s,t)),n&&n._handleDoubleClick(t,e||i&&this)},e._dispatchMouseEvent=function(t,e,i,n,s,r,o){if(t&&(i||t.hasEventListener(e))){var a=new createjs.MouseEvent(e,i,!1,s.x,s.y,r,n,n===this._primaryPointerID||-1===n,s.rawX,s.rawY,o);t.dispatchEvent(a)}},createjs.Stage=createjs.promote(t,"Container")}(),this.createjs=this.createjs||{},function(){function t(t){this.DisplayObject_constructor(),"string"==typeof t?(this.image=document.createElement("img"),this.image.src=t):this.image=t,this.sourceRect=null}var e=createjs.extend(t,createjs.DisplayObject);e.initialize=t,e.isVisible=function(){var t=this.image,e=this.cacheCanvas||t&&(t.naturalWidth||t.getContext||t.readyState>=2);return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&e)},e.draw=function(t,e){if(this.DisplayObject_draw(t,e)||!this.image)return!0;var i=this.image,n=this.sourceRect;if(n){var s=n.x,r=n.y,o=s+n.width,a=r+n.height,h=0,l=0,c=i.width,u=i.height;0>s&&(h-=s,s=0),o>c&&(o=c),0>r&&(l-=r,r=0),a>u&&(a=u),t.drawImage(i,s,r,o-s,a-r,h,l,o-s,a-r)}else t.drawImage(i,0,0);return!0},e.getBounds=function(){var t=this.DisplayObject_getBounds();if(t)return t;var e=this.image,i=this.sourceRect||e,n=e&&(e.naturalWidth||e.getContext||e.readyState>=2);return n?this._rectangle.setValues(0,0,i.width,i.height):null},e.clone=function(){var e=new t(this.image);return this.sourceRect&&(e.sourceRect=this.sourceRect.clone()),this._cloneProps(e),e},e.toString=function(){return"[Bitmap (name="+this.name+")]"},createjs.Bitmap=createjs.promote(t,"DisplayObject")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.DisplayObject_constructor(),this.currentFrame=0,this.currentAnimation=null,this.paused=!0,this.spriteSheet=t,this.currentAnimationFrame=0,this.framerate=0,this._animation=null,this._currentFrame=null,this._skipAdvance=!1,null!=e&&this.gotoAndPlay(e)}var e=createjs.extend(t,createjs.DisplayObject);e.initialize=t,e.isVisible=function(){var t=this.cacheCanvas||this.spriteSheet.complete;return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&t)},e.draw=function(t,e){if(this.DisplayObject_draw(t,e))return!0;this._normalizeFrame();var i=this.spriteSheet.getFrame(0|this._currentFrame);if(!i)return!1;var n=i.rect;return n.width&&n.height&&t.drawImage(i.image,n.x,n.y,n.width,n.height,-i.regX,-i.regY,n.width,n.height),!0},e.play=function(){this.paused=!1},e.stop=function(){this.paused=!0},e.gotoAndPlay=function(t){this.paused=!1,this._skipAdvance=!0,this._goto(t)},e.gotoAndStop=function(t){this.paused=!0,this._goto(t)},e.advance=function(t){var e=this.framerate||this.spriteSheet.framerate,i=e&&null!=t?t/(1e3/e):1;this._normalizeFrame(i)},e.getBounds=function(){return this.DisplayObject_getBounds()||this.spriteSheet.getFrameBounds(this.currentFrame,this._rectangle)},e.clone=function(){return this._cloneProps(new t(this.spriteSheet))},e.toString=function(){return"[Sprite (name="+this.name+")]"},e._cloneProps=function(t){return this.DisplayObject__cloneProps(t),t.currentFrame=this.currentFrame,t.currentAnimation=this.currentAnimation,t.paused=this.paused,t.currentAnimationFrame=this.currentAnimationFrame,t.framerate=this.framerate,t._animation=this._animation,t._currentFrame=this._currentFrame,t._skipAdvance=this._skipAdvance,t},e._tick=function(t){this.paused||(this._skipAdvance||this.advance(t&&t.delta),this._skipAdvance=!1),this.DisplayObject__tick(t)},e._normalizeFrame=function(t){t=t||0;var e,i=this._animation,n=this.paused,s=this._currentFrame;if(i){var r=i.speed||1,o=this.currentAnimationFrame;if(e=i.frames.length,o+t*r>=e){var a=i.next;if(this._dispatchAnimationEnd(i,s,n,a,e-1))return;if(a)return this._goto(a,t-(e-o)/r);this.paused=!0,o=i.frames.length-1}else o+=t*r;this.currentAnimationFrame=o,this._currentFrame=i.frames[0|o]}else if(s=this._currentFrame+=t,e=this.spriteSheet.getNumFrames(),s>=e&&e>0&&!this._dispatchAnimationEnd(i,s,n,e-1)&&(this._currentFrame-=e)>=e)return this._normalizeFrame();s=0|this._currentFrame,this.currentFrame!=s&&(this.currentFrame=s,this.dispatchEvent("change"))},e._dispatchAnimationEnd=function(t,e,i,n,s){var r=t?t.name:null;if(this.hasEventListener("animationend")){var o=new createjs.Event("animationend");o.name=r,o.next=n,this.dispatchEvent(o)}var a=this._animation!=t||this._currentFrame!=e;return a||i||!this.paused||(this.currentAnimationFrame=s,a=!0),a},e._goto=function(t,e){if(this.currentAnimationFrame=0,isNaN(t)){var i=this.spriteSheet.getAnimation(t);i&&(this._animation=i,this.currentAnimation=t,this._normalizeFrame(e))}else this.currentAnimation=this._animation=null,this._currentFrame=t,this._normalizeFrame()},createjs.Sprite=createjs.promote(t,"DisplayObject")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.DisplayObject_constructor(),this.graphics=t?t:new createjs.Graphics}var e=createjs.extend(t,createjs.DisplayObject);e.isVisible=function(){var t=this.cacheCanvas||this.graphics&&!this.graphics.isEmpty();return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&t)},e.draw=function(t,e){return this.DisplayObject_draw(t,e)?!0:(this.graphics.draw(t,this),!0)},e.clone=function(e){var i=e&&this.graphics?this.graphics.clone():this.graphics;return this._cloneProps(new t(i))},e.toString=function(){return"[Shape (name="+this.name+")]"},createjs.Shape=createjs.promote(t,"DisplayObject")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.DisplayObject_constructor(),this.text=t,this.font=e,this.color=i,this.textAlign="left",this.textBaseline="top",this.maxWidth=null,this.outline=0,this.lineHeight=0,this.lineWidth=null}var e=createjs.extend(t,createjs.DisplayObject),i=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");i.getContext&&(t._workingContext=i.getContext("2d"),i.width=i.height=1),t.H_OFFSETS={start:0,left:0,center:-.5,end:-1,right:-1},t.V_OFFSETS={top:0,hanging:-.01,middle:-.4,alphabetic:-.8,ideographic:-.85,bottom:-1},e.isVisible=function(){var t=this.cacheCanvas||null!=this.text&&""!==this.text;return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&t)},e.draw=function(t,e){if(this.DisplayObject_draw(t,e))return!0;var i=this.color||"#000";return this.outline?(t.strokeStyle=i,t.lineWidth=1*this.outline):t.fillStyle=i,this._drawText(this._prepContext(t)),!0},e.getMeasuredWidth=function(){return this._getMeasuredWidth(this.text)},e.getMeasuredLineHeight=function(){return 1.2*this._getMeasuredWidth("M")},e.getMeasuredHeight=function(){return this._drawText(null,{}).height},e.getBounds=function(){var e=this.DisplayObject_getBounds();if(e)return e;if(null==this.text||""===this.text)return null;var i=this._drawText(null,{}),n=this.maxWidth&&this.maxWidth<i.width?this.maxWidth:i.width,s=n*t.H_OFFSETS[this.textAlign||"left"],r=this.lineHeight||this.getMeasuredLineHeight(),o=r*t.V_OFFSETS[this.textBaseline||"top"];return this._rectangle.setValues(s,o,n,i.height)},e.getMetrics=function(){var e={lines:[]};return e.lineHeight=this.lineHeight||this.getMeasuredLineHeight(),e.vOffset=e.lineHeight*t.V_OFFSETS[this.textBaseline||"top"],this._drawText(null,e,e.lines)},e.clone=function(){return this._cloneProps(new t(this.text,this.font,this.color))},e.toString=function(){return"[Text (text="+(this.text.length>20?this.text.substr(0,17)+"...":this.text)+")]"},e._cloneProps=function(t){return this.DisplayObject__cloneProps(t),t.textAlign=this.textAlign,t.textBaseline=this.textBaseline,t.maxWidth=this.maxWidth,t.outline=this.outline,t.lineHeight=this.lineHeight,t.lineWidth=this.lineWidth,t},e._prepContext=function(t){return t.font=this.font||"10px sans-serif",t.textAlign=this.textAlign||"left",t.textBaseline=this.textBaseline||"top",t},e._drawText=function(e,i,n){var s=!!e;s||(e=t._workingContext,e.save(),this._prepContext(e));for(var r=this.lineHeight||this.getMeasuredLineHeight(),o=0,a=0,h=String(this.text).split(/(?:\r\n|\r|\n)/),l=0,c=h.length;c>l;l++){var u=h[l],d=null;if(null!=this.lineWidth&&(d=e.measureText(u).width)>this.lineWidth){var p=u.split(/(\s)/);u=p[0],d=e.measureText(u).width;for(var f=1,v=p.length;v>f;f+=2){var m=e.measureText(p[f]+p[f+1]).width;d+m>this.lineWidth?(s&&this._drawTextLine(e,u,a*r),n&&n.push(u),d>o&&(o=d),u=p[f+1],d=e.measureText(u).width,a++):(u+=p[f]+p[f+1],d+=m)}}s&&this._drawTextLine(e,u,a*r),n&&n.push(u),i&&null==d&&(d=e.measureText(u).width),d>o&&(o=d),a++}return i&&(i.width=o,i.height=a*r),s||e.restore(),i},e._drawTextLine=function(t,e,i){this.outline?t.strokeText(e,0,i,this.maxWidth||65535):t.fillText(e,0,i,this.maxWidth||65535)},e._getMeasuredWidth=function(e){var i=t._workingContext;i.save();var n=this._prepContext(i).measureText(e).width;return i.restore(),n},createjs.Text=createjs.promote(t,"DisplayObject")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.Container_constructor(),this.text=t||"",this.spriteSheet=e,this.lineHeight=0,this.letterSpacing=0,this.spaceWidth=0,this._oldProps={text:0,spriteSheet:0,lineHeight:0,letterSpacing:0,spaceWidth:0}}var e=createjs.extend(t,createjs.Container);t.maxPoolSize=100,t._spritePool=[],e.draw=function(t,e){this.DisplayObject_draw(t,e)||(this._updateText(),this.Container_draw(t,e))},e.getBounds=function(){return this._updateText(),this.Container_getBounds()},e.isVisible=function(){var t=this.cacheCanvas||this.spriteSheet&&this.spriteSheet.complete&&this.text;return!!(this.visible&&this.alpha>0&&0!==this.scaleX&&0!==this.scaleY&&t)},e.clone=function(){return this._cloneProps(new t(this.text,this.spriteSheet))},e.addChild=e.addChildAt=e.removeChild=e.removeChildAt=e.removeAllChildren=function(){},e._cloneProps=function(t){return this.Container__cloneProps(t),t.lineHeight=this.lineHeight,t.letterSpacing=this.letterSpacing,t.spaceWidth=this.spaceWidth,t},e._getFrameIndex=function(t,e){var i,n=e.getAnimation(t);return n||(t!=(i=t.toUpperCase())||t!=(i=t.toLowerCase())||(i=null),i&&(n=e.getAnimation(i))),n&&n.frames[0]},e._getFrame=function(t,e){var i=this._getFrameIndex(t,e);return null==i?i:e.getFrame(i)},e._getLineHeight=function(t){var e=this._getFrame("1",t)||this._getFrame("T",t)||this._getFrame("L",t)||t.getFrame(0);return e?e.rect.height:1},e._getSpaceWidth=function(t){var e=this._getFrame("1",t)||this._getFrame("l",t)||this._getFrame("e",t)||this._getFrame("a",t)||t.getFrame(0);return e?e.rect.width:1},e._updateText=function(){var e,i=0,n=0,s=this._oldProps,r=!1,o=this.spaceWidth,a=this.lineHeight,h=this.spriteSheet,l=t._spritePool,c=this.children,u=0,d=c.length;for(var p in s)s[p]!=this[p]&&(s[p]=this[p],r=!0);if(r){var f=!!this._getFrame(" ",h);f||o||(o=this._getSpaceWidth(h)),a||(a=this._getLineHeight(h));for(var v=0,m=this.text.length;m>v;v++){var g=this.text.charAt(v);if(" "!=g||f)if("\n"!=g&&"\r"!=g){var y=this._getFrameIndex(g,h);null!=y&&(d>u?e=c[u]:(c.push(e=l.length?l.pop():new createjs.Sprite),e.parent=this,d++),e.spriteSheet=h,e.gotoAndStop(y),e.x=i,e.y=n,u++,i+=e.getBounds().width+this.letterSpacing)}else"\r"==g&&"\n"==this.text.charAt(v+1)&&v++,i=0,n+=a;else i+=o}for(;d>u;)l.push(e=c.pop()),e.parent=null,d--;l.length>t.maxPoolSize&&(l.length=t.maxPoolSize)}},createjs.BitmapText=createjs.promote(t,"Container")}(),this.createjs=this.createjs||{},function(){"use strict";function t(e,i,n,s){this.Container_constructor(),!t.inited&&t.init(),this.mode=e||t.INDEPENDENT,this.startPosition=i||0,this.loop=n,this.currentFrame=0,this.timeline=new createjs.Timeline(null,s,{paused:!0,position:i,useTicks:!0}),this.paused=!1,this.actionsEnabled=!0,this.autoReset=!0,this.frameBounds=this.frameBounds||null,this.framerate=null,this._synchOffset=0,this._prevPos=-1,this._prevPosition=0,this._t=0,this._managed={}}function e(){throw"MovieClipPlugin cannot be instantiated."}var i=createjs.extend(t,createjs.Container);t.INDEPENDENT="independent",t.SINGLE_FRAME="single",t.SYNCHED="synched",t.inited=!1,t.init=function(){t.inited||(e.install(),t.inited=!0)},i.getLabels=function(){return this.timeline.getLabels()},i.getCurrentLabel=function(){return this._updateTimeline(),this.timeline.getCurrentLabel()},i.getDuration=function(){return this.timeline.duration;
};try{Object.defineProperties(i,{labels:{get:i.getLabels},currentLabel:{get:i.getCurrentLabel},totalFrames:{get:i.getDuration},duration:{get:i.getDuration}})}catch(n){}i.initialize=t,i.isVisible=function(){return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY)},i.draw=function(t,e){return this.DisplayObject_draw(t,e)?!0:(this._updateTimeline(),this.Container_draw(t,e),!0)},i.play=function(){this.paused=!1},i.stop=function(){this.paused=!0},i.gotoAndPlay=function(t){this.paused=!1,this._goto(t)},i.gotoAndStop=function(t){this.paused=!0,this._goto(t)},i.advance=function(e){var i=t.INDEPENDENT;if(this.mode==i){for(var n=this,s=n.framerate;(n=n.parent)&&null==s;)n.mode==i&&(s=n._framerate);this._framerate=s;var r=null!=s&&-1!=s&&null!=e?e/(1e3/s)+this._t:1,o=0|r;for(this._t=r-o;!this.paused&&o--;)this._prevPosition=this._prevPos<0?0:this._prevPosition+1,this._updateTimeline()}},i.clone=function(){throw"MovieClip cannot be cloned."},i.toString=function(){return"[MovieClip (name="+this.name+")]"},i._tick=function(t){this.advance(t&&t.delta),this.Container__tick(t)},i._goto=function(t){var e=this.timeline.resolve(t);null!=e&&(-1==this._prevPos&&(this._prevPos=0/0),this._prevPosition=e,this._t=0,this._updateTimeline())},i._reset=function(){this._prevPos=-1,this._t=this.currentFrame=0,this.paused=!1},i._updateTimeline=function(){var e=this.timeline,i=this.mode!=t.INDEPENDENT;e.loop=null==this.loop?!0:this.loop;var n=i?this.startPosition+(this.mode==t.SINGLE_FRAME?0:this._synchOffset):this._prevPos<0?0:this._prevPosition,s=i||!this.actionsEnabled?createjs.Tween.NONE:null;if(this.currentFrame=e._calcPosition(n),e.setPosition(n,s),this._prevPosition=e._prevPosition,this._prevPos!=e._prevPos){this.currentFrame=this._prevPos=e._prevPos;for(var r in this._managed)this._managed[r]=1;for(var o=e._tweens,a=0,h=o.length;h>a;a++){var l=o[a],c=l._target;if(c!=this&&!l.passive){var u=l._stepPosition;c instanceof createjs.DisplayObject?this._addManagedChild(c,u):this._setState(c.state,u)}}var d=this.children;for(a=d.length-1;a>=0;a--){var p=d[a].id;1==this._managed[p]&&(this.removeChildAt(a),delete this._managed[p])}}},i._setState=function(t,e){if(t)for(var i=t.length-1;i>=0;i--){var n=t[i],s=n.t,r=n.p;for(var o in r)s[o]=r[o];this._addManagedChild(s,e)}},i._addManagedChild=function(e,i){e._off||(this.addChildAt(e,0),e instanceof t&&(e._synchOffset=i,e.mode==t.INDEPENDENT&&e.autoReset&&!this._managed[e.id]&&e._reset()),this._managed[e.id]=2)},i._getBounds=function(t,e){var i=this.DisplayObject_getBounds();return i||(this._updateTimeline(),this.frameBounds&&(i=this._rectangle.copy(this.frameBounds[this.currentFrame]))),i?this._transformBounds(i,t,e):this.Container__getBounds(t,e)},createjs.MovieClip=createjs.promote(t,"Container"),e.priority=100,e.install=function(){createjs.Tween.installPlugin(e,["startPosition"])},e.init=function(t,e,i){return i},e.step=function(){},e.tween=function(e,i,n,s,r,o){return e.target instanceof t?1==o?r[i]:s[i]:n}}(),this.createjs=this.createjs||{},function(){"use strict";function t(){throw"SpriteSheetUtils cannot be instantiated"}var e=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");e.getContext&&(t._workingCanvas=e,t._workingContext=e.getContext("2d"),e.width=e.height=1),t.addFlippedFrames=function(e,i,n,s){if(i||n||s){var r=0;i&&t._flip(e,++r,!0,!1),n&&t._flip(e,++r,!1,!0),s&&t._flip(e,++r,!0,!0)}},t.extractFrame=function(e,i){isNaN(i)&&(i=e.getAnimation(i).frames[0]);var n=e.getFrame(i);if(!n)return null;var s=n.rect,r=t._workingCanvas;r.width=s.width,r.height=s.height,t._workingContext.drawImage(n.image,s.x,s.y,s.width,s.height,0,0,s.width,s.height);var o=document.createElement("img");return o.src=r.toDataURL("image/png"),o},t.mergeAlpha=function(t,e,i){i||(i=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas")),i.width=Math.max(e.width,t.width),i.height=Math.max(e.height,t.height);var n=i.getContext("2d");return n.save(),n.drawImage(t,0,0),n.globalCompositeOperation="destination-in",n.drawImage(e,0,0),n.restore(),i},t._flip=function(e,i,n,s){for(var r=e._images,o=t._workingCanvas,a=t._workingContext,h=r.length/i,l=0;h>l;l++){var c=r[l];c.__tmp=l,a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,o.width+1,o.height+1),o.width=c.width,o.height=c.height,a.setTransform(n?-1:1,0,0,s?-1:1,n?c.width:0,s?c.height:0),a.drawImage(c,0,0);var u=document.createElement("img");u.src=o.toDataURL("image/png"),u.width=c.width,u.height=c.height,r.push(u)}var d=e._frames,p=d.length/i;for(l=0;p>l;l++){c=d[l];var f=c.rect.clone();u=r[c.image.__tmp+h*i];var v={image:u,rect:f,regX:c.regX,regY:c.regY};n&&(f.x=u.width-f.x-f.width,v.regX=f.width-c.regX),s&&(f.y=u.height-f.y-f.height,v.regY=f.height-c.regY),d.push(v)}var m="_"+(n?"h":"")+(s?"v":""),g=e._animations,y=e._data,_=g.length/i;for(l=0;_>l;l++){var b=g[l];c=y[b];var w={name:b+m,speed:c.speed,next:c.next,frames:[]};c.next&&(w.next+=m),d=c.frames;for(var x=0,P=d.length;P>x;x++)w.frames.push(d[x]+p*i);y[w.name]=w,g.push(w.name)}},createjs.SpriteSheetUtils=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.EventDispatcher_constructor(),this.maxWidth=2048,this.maxHeight=2048,this.spriteSheet=null,this.scale=1,this.padding=1,this.timeSlice=.3,this.progress=-1,this.framerate=t||0,this._frames=[],this._animations={},this._data=null,this._nextFrameIndex=0,this._index=0,this._timerID=null,this._scale=1}var e=createjs.extend(t,createjs.EventDispatcher);t.ERR_DIMENSIONS="frame dimensions exceed max spritesheet dimensions",t.ERR_RUNNING="a build is already running",e.addFrame=function(e,i,n,s,r){if(this._data)throw t.ERR_RUNNING;var o=i||e.bounds||e.nominalBounds;return!o&&e.getBounds&&(o=e.getBounds()),o?(n=n||1,this._frames.push({source:e,sourceRect:o,scale:n,funct:s,data:r,index:this._frames.length,height:o.height*n})-1):null},e.addAnimation=function(e,i,n,s){if(this._data)throw t.ERR_RUNNING;this._animations[e]={frames:i,next:n,speed:s}},e.addMovieClip=function(e,i,n,s,r,o){if(this._data)throw t.ERR_RUNNING;var a=e.frameBounds,h=i||e.bounds||e.nominalBounds;if(!h&&e.getBounds&&(h=e.getBounds()),h||a){var l,c,u=this._frames.length,d=e.timeline.duration;for(l=0;d>l;l++){var p=a&&a[l]?a[l]:h;this.addFrame(e,p,n,this._setupMovieClipFrame,{i:l,f:s,d:r})}var f=e.timeline._labels,v=[];for(var m in f)v.push({index:f[m],label:m});if(v.length)for(v.sort(function(t,e){return t.index-e.index}),l=0,c=v.length;c>l;l++){for(var g=v[l].label,y=u+v[l].index,_=u+(l==c-1?d:v[l+1].index),b=[],w=y;_>w;w++)b.push(w);(!o||(g=o(g,e,y,_)))&&this.addAnimation(g,b,!0)}}},e.build=function(){if(this._data)throw t.ERR_RUNNING;for(this._startBuild();this._drawNext(););return this._endBuild(),this.spriteSheet},e.buildAsync=function(e){if(this._data)throw t.ERR_RUNNING;this.timeSlice=e,this._startBuild();var i=this;this._timerID=setTimeout(function(){i._run()},50-50*Math.max(.01,Math.min(.99,this.timeSlice||.3)))},e.stopAsync=function(){clearTimeout(this._timerID),this._data=null},e.clone=function(){throw"SpriteSheetBuilder cannot be cloned."},e.toString=function(){return"[SpriteSheetBuilder]"},e._startBuild=function(){var e=this.padding||0;this.progress=0,this.spriteSheet=null,this._index=0,this._scale=this.scale;var i=[];this._data={images:[],frames:i,framerate:this.framerate,animations:this._animations};var n=this._frames.slice();if(n.sort(function(t,e){return t.height<=e.height?-1:1}),n[n.length-1].height+2*e>this.maxHeight)throw t.ERR_DIMENSIONS;for(var s=0,r=0,o=0;n.length;){var a=this._fillRow(n,s,o,i,e);if(a.w>r&&(r=a.w),s+=a.h,!a.h||!n.length){var h=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");h.width=this._getSize(r,this.maxWidth),h.height=this._getSize(s,this.maxHeight),this._data.images[o]=h,a.h||(r=s=0,o++)}}},e._setupMovieClipFrame=function(t,e){var i=t.actionsEnabled;t.actionsEnabled=!1,t.gotoAndStop(e.i),t.actionsEnabled=i,e.f&&e.f(t,e.d,e.i)},e._getSize=function(t,e){for(var i=4;Math.pow(2,++i)<t;);return Math.min(e,Math.pow(2,i))},e._fillRow=function(e,i,n,s,r){var o=this.maxWidth,a=this.maxHeight;i+=r;for(var h=a-i,l=r,c=0,u=e.length-1;u>=0;u--){var d=e[u],p=this._scale*d.scale,f=d.sourceRect,v=d.source,m=Math.floor(p*f.x-r),g=Math.floor(p*f.y-r),y=Math.ceil(p*f.height+2*r),_=Math.ceil(p*f.width+2*r);if(_>o)throw t.ERR_DIMENSIONS;y>h||l+_>o||(d.img=n,d.rect=new createjs.Rectangle(l,i,_,y),c=c||y,e.splice(u,1),s[d.index]=[l,i,_,y,n,Math.round(-m+p*v.regX-r),Math.round(-g+p*v.regY-r)],l+=_)}return{w:l,h:c}},e._endBuild=function(){this.spriteSheet=new createjs.SpriteSheet(this._data),this._data=null,this.progress=1,this.dispatchEvent("complete")},e._run=function(){for(var t=50*Math.max(.01,Math.min(.99,this.timeSlice||.3)),e=(new Date).getTime()+t,i=!1;e>(new Date).getTime();)if(!this._drawNext()){i=!0;break}if(i)this._endBuild();else{var n=this;this._timerID=setTimeout(function(){n._run()},50-t)}var s=this.progress=this._index/this._frames.length;if(this.hasEventListener("progress")){var r=new createjs.Event("progress");r.progress=s,this.dispatchEvent(r)}},e._drawNext=function(){var t=this._frames[this._index],e=t.scale*this._scale,i=t.rect,n=t.sourceRect,s=this._data.images[t.img],r=s.getContext("2d");return t.funct&&t.funct(t.source,t.data),r.save(),r.beginPath(),r.rect(i.x,i.y,i.width,i.height),r.clip(),r.translate(Math.ceil(i.x-n.x*e),Math.ceil(i.y-n.y*e)),r.scale(e,e),t.source.draw(r),r.restore(),++this._index<this._frames.length},createjs.SpriteSheetBuilder=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.DisplayObject_constructor(),"string"==typeof t&&(t=document.getElementById(t)),this.mouseEnabled=!1;var e=t.style;e.position="absolute",e.transformOrigin=e.WebkitTransformOrigin=e.msTransformOrigin=e.MozTransformOrigin=e.OTransformOrigin="0% 0%",this.htmlElement=t,this._oldProps=null}var e=createjs.extend(t,createjs.DisplayObject);e.isVisible=function(){return null!=this.htmlElement},e.draw=function(){return!0},e.cache=function(){},e.uncache=function(){},e.updateCache=function(){},e.hitTest=function(){},e.localToGlobal=function(){},e.globalToLocal=function(){},e.localToLocal=function(){},e.clone=function(){throw"DOMElement cannot be cloned."},e.toString=function(){return"[DOMElement (name="+this.name+")]"},e._tick=function(t){var e=this.getStage();e&&e.on("drawend",this._handleDrawEnd,this,!0),this.DisplayObject__tick(t)},e._handleDrawEnd=function(){var t=this.htmlElement;if(t){var e=t.style,i=this.getConcatenatedDisplayProps(this._props),n=i.matrix,s=i.visible?"visible":"hidden";if(s!=e.visibility&&(e.visibility=s),i.visible){var r=this._oldProps,o=r&&r.matrix,a=1e4;if(!o||!o.equals(n)){var h="matrix("+(n.a*a|0)/a+","+(n.b*a|0)/a+","+(n.c*a|0)/a+","+(n.d*a|0)/a+","+(n.tx+.5|0);e.transform=e.WebkitTransform=e.OTransform=e.msTransform=h+","+(n.ty+.5|0)+")",e.MozTransform=h+"px,"+(n.ty+.5|0)+"px)",r||(r=this._oldProps=new createjs.DisplayProps(!0,0/0)),r.matrix.copy(n)}r.alpha!=i.alpha&&(e.opacity=""+(i.alpha*a|0)/a,r.alpha=i.alpha)}}},createjs.DOMElement=createjs.promote(t,"DisplayObject")}(),this.createjs=this.createjs||{},function(){"use strict";function t(){}var e=t.prototype;e.getBounds=function(t){return t},e.applyFilter=function(t,e,i,n,s,r,o,a){r=r||t,null==o&&(o=e),null==a&&(a=i);try{var h=t.getImageData(e,i,n,s)}catch(l){return!1}return this._applyFilter(h)?(r.putImageData(h,o,a),!0):!1},e.toString=function(){return"[Filter]"},e.clone=function(){return new t},e._applyFilter=function(){return!0},createjs.Filter=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){(isNaN(t)||0>t)&&(t=0),(isNaN(e)||0>e)&&(e=0),(isNaN(i)||1>i)&&(i=1),this.blurX=0|t,this.blurY=0|e,this.quality=0|i}var e=createjs.extend(t,createjs.Filter);t.MUL_TABLE=[1,171,205,293,57,373,79,137,241,27,391,357,41,19,283,265,497,469,443,421,25,191,365,349,335,161,155,149,9,278,269,261,505,245,475,231,449,437,213,415,405,395,193,377,369,361,353,345,169,331,325,319,313,307,301,37,145,285,281,69,271,267,263,259,509,501,493,243,479,118,465,459,113,446,55,435,429,423,209,413,51,403,199,393,97,3,379,375,371,367,363,359,355,351,347,43,85,337,333,165,327,323,5,317,157,311,77,305,303,75,297,294,73,289,287,71,141,279,277,275,68,135,67,133,33,262,260,129,511,507,503,499,495,491,61,121,481,477,237,235,467,232,115,457,227,451,7,445,221,439,218,433,215,427,425,211,419,417,207,411,409,203,202,401,399,396,197,49,389,387,385,383,95,189,47,187,93,185,23,183,91,181,45,179,89,177,11,175,87,173,345,343,341,339,337,21,167,83,331,329,327,163,81,323,321,319,159,79,315,313,39,155,309,307,153,305,303,151,75,299,149,37,295,147,73,291,145,289,287,143,285,71,141,281,35,279,139,69,275,137,273,17,271,135,269,267,133,265,33,263,131,261,130,259,129,257,1],t.SHG_TABLE=[0,9,10,11,9,12,10,11,12,9,13,13,10,9,13,13,14,14,14,14,10,13,14,14,14,13,13,13,9,14,14,14,15,14,15,14,15,15,14,15,15,15,14,15,15,15,15,15,14,15,15,15,15,15,15,12,14,15,15,13,15,15,15,15,16,16,16,15,16,14,16,16,14,16,13,16,16,16,15,16,13,16,15,16,14,9,16,16,16,16,16,16,16,16,16,13,14,16,16,15,16,16,10,16,15,16,14,16,16,14,16,16,14,16,16,14,15,16,16,16,14,15,14,15,13,16,16,15,17,17,17,17,17,17,14,15,17,17,16,16,17,16,15,17,16,17,11,17,16,17,16,17,16,17,17,16,17,17,16,17,17,16,16,17,17,17,16,14,17,17,17,17,15,16,14,16,15,16,13,16,15,16,14,16,15,16,12,16,15,16,17,17,17,17,17,13,16,15,17,17,17,16,15,17,17,17,16,15,17,17,14,16,17,17,16,17,17,16,15,17,16,14,17,16,15,17,16,17,17,16,17,15,16,17,14,17,16,15,17,16,17,13,17,16,17,17,16,17,14,17,16,17,16,17,16,17,9],e.getBounds=function(t){var e=0|this.blurX,i=0|this.blurY;if(0>=e&&0>=i)return t;var n=Math.pow(this.quality,.2);return(t||new createjs.Rectangle).pad(e*n+1,i*n+1,e*n+1,i*n+1)},e.clone=function(){return new t(this.blurX,this.blurY,this.quality)},e.toString=function(){return"[BlurFilter]"},e._applyFilter=function(e){var i=this.blurX>>1;if(isNaN(i)||0>i)return!1;var n=this.blurY>>1;if(isNaN(n)||0>n)return!1;if(0==i&&0==n)return!1;var s=this.quality;(isNaN(s)||1>s)&&(s=1),s|=0,s>3&&(s=3),1>s&&(s=1);var r=e.data,o=0,a=0,h=0,l=0,c=0,u=0,d=0,p=0,f=0,v=0,m=0,g=0,y=0,_=0,b=0,w=i+i+1|0,x=n+n+1|0,P=0|e.width,S=0|e.height,C=P-1|0,T=S-1|0,E=i+1|0,k=n+1|0,j={r:0,b:0,g:0,a:0},I=j;for(h=1;w>h;h++)I=I.n={r:0,b:0,g:0,a:0};I.n=j;var A={r:0,b:0,g:0,a:0},M=A;for(h=1;x>h;h++)M=M.n={r:0,b:0,g:0,a:0};M.n=A;for(var B=null,D=0|t.MUL_TABLE[i],O=0|t.SHG_TABLE[i],L=0|t.MUL_TABLE[n],F=0|t.SHG_TABLE[n];s-- >0;){d=u=0;var R=D,H=O;for(a=S;--a>-1;){for(p=E*(g=r[0|u]),f=E*(y=r[u+1|0]),v=E*(_=r[u+2|0]),m=E*(b=r[u+3|0]),I=j,h=E;--h>-1;)I.r=g,I.g=y,I.b=_,I.a=b,I=I.n;for(h=1;E>h;h++)l=u+((h>C?C:h)<<2)|0,p+=I.r=r[l],f+=I.g=r[l+1],v+=I.b=r[l+2],m+=I.a=r[l+3],I=I.n;for(B=j,o=0;P>o;o++)r[u++]=p*R>>>H,r[u++]=f*R>>>H,r[u++]=v*R>>>H,r[u++]=m*R>>>H,l=d+((l=o+i+1)<C?l:C)<<2,p-=B.r-(B.r=r[l]),f-=B.g-(B.g=r[l+1]),v-=B.b-(B.b=r[l+2]),m-=B.a-(B.a=r[l+3]),B=B.n;d+=P}for(R=L,H=F,o=0;P>o;o++){for(u=o<<2|0,p=k*(g=r[u])|0,f=k*(y=r[u+1|0])|0,v=k*(_=r[u+2|0])|0,m=k*(b=r[u+3|0])|0,M=A,h=0;k>h;h++)M.r=g,M.g=y,M.b=_,M.a=b,M=M.n;for(c=P,h=1;n>=h;h++)u=c+o<<2,p+=M.r=r[u],f+=M.g=r[u+1],v+=M.b=r[u+2],m+=M.a=r[u+3],M=M.n,T>h&&(c+=P);if(u=o,B=A,s>0)for(a=0;S>a;a++)l=u<<2,r[l+3]=b=m*R>>>H,b>0?(r[l]=p*R>>>H,r[l+1]=f*R>>>H,r[l+2]=v*R>>>H):r[l]=r[l+1]=r[l+2]=0,l=o+((l=a+k)<T?l:T)*P<<2,p-=B.r-(B.r=r[l]),f-=B.g-(B.g=r[l+1]),v-=B.b-(B.b=r[l+2]),m-=B.a-(B.a=r[l+3]),B=B.n,u+=P;else for(a=0;S>a;a++)l=u<<2,r[l+3]=b=m*R>>>H,b>0?(b=255/b,r[l]=(p*R>>>H)*b,r[l+1]=(f*R>>>H)*b,r[l+2]=(v*R>>>H)*b):r[l]=r[l+1]=r[l+2]=0,l=o+((l=a+k)<T?l:T)*P<<2,p-=B.r-(B.r=r[l]),f-=B.g-(B.g=r[l+1]),v-=B.b-(B.b=r[l+2]),m-=B.a-(B.a=r[l+3]),B=B.n,u+=P}}return!0},createjs.BlurFilter=createjs.promote(t,"Filter")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.alphaMap=t,this._alphaMap=null,this._mapData=null}var e=createjs.extend(t,createjs.Filter);e.clone=function(){var e=new t(this.alphaMap);return e._alphaMap=this._alphaMap,e._mapData=this._mapData,e},e.toString=function(){return"[AlphaMapFilter]"},e._applyFilter=function(t){if(!this.alphaMap)return!0;if(!this._prepAlphaMap())return!1;for(var e=t.data,i=this._mapData,n=0,s=e.length;s>n;n+=4)e[n+3]=i[n]||0;return!0},e._prepAlphaMap=function(){if(!this.alphaMap)return!1;if(this.alphaMap==this._alphaMap&&this._mapData)return!0;this._mapData=null;var t,e=this._alphaMap=this.alphaMap,i=e;e instanceof HTMLCanvasElement?t=i.getContext("2d"):(i=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"),i.width=e.width,i.height=e.height,t=i.getContext("2d"),t.drawImage(e,0,0));try{var n=t.getImageData(0,0,e.width,e.height)}catch(s){return!1}return this._mapData=n.data,!0},createjs.AlphaMapFilter=createjs.promote(t,"Filter")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.mask=t}var e=createjs.extend(t,createjs.Filter);e.applyFilter=function(t,e,i,n,s,r,o,a){return this.mask?(r=r||t,null==o&&(o=e),null==a&&(a=i),r.save(),t!=r?!1:(r.globalCompositeOperation="destination-in",r.drawImage(this.mask,o,a),r.restore(),!0)):!0},e.clone=function(){return new t(this.mask)},e.toString=function(){return"[AlphaMaskFilter]"},createjs.AlphaMaskFilter=createjs.promote(t,"Filter")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i,n,s,r,o,a){this.redMultiplier=null!=t?t:1,this.greenMultiplier=null!=e?e:1,this.blueMultiplier=null!=i?i:1,this.alphaMultiplier=null!=n?n:1,this.redOffset=s||0,this.greenOffset=r||0,this.blueOffset=o||0,this.alphaOffset=a||0}var e=createjs.extend(t,createjs.Filter);e.toString=function(){return"[ColorFilter]"},e.clone=function(){return new t(this.redMultiplier,this.greenMultiplier,this.blueMultiplier,this.alphaMultiplier,this.redOffset,this.greenOffset,this.blueOffset,this.alphaOffset)},e._applyFilter=function(t){for(var e=t.data,i=e.length,n=0;i>n;n+=4)e[n]=e[n]*this.redMultiplier+this.redOffset,e[n+1]=e[n+1]*this.greenMultiplier+this.greenOffset,e[n+2]=e[n+2]*this.blueMultiplier+this.blueOffset,e[n+3]=e[n+3]*this.alphaMultiplier+this.alphaOffset;return!0},createjs.ColorFilter=createjs.promote(t,"Filter")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i,n){this.setColor(t,e,i,n)}var e=t.prototype;t.DELTA_INDEX=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],t.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],t.LENGTH=t.IDENTITY_MATRIX.length,e.setColor=function(t,e,i,n){return this.reset().adjustColor(t,e,i,n)},e.reset=function(){return this.copy(t.IDENTITY_MATRIX)},e.adjustColor=function(t,e,i,n){return this.adjustHue(n),this.adjustContrast(e),this.adjustBrightness(t),this.adjustSaturation(i)},e.adjustBrightness=function(t){return 0==t||isNaN(t)?this:(t=this._cleanValue(t,255),this._multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1]),this)},e.adjustContrast=function(e){if(0==e||isNaN(e))return this;e=this._cleanValue(e,100);var i;return 0>e?i=127+e/100*127:(i=e%1,i=0==i?t.DELTA_INDEX[e]:t.DELTA_INDEX[e<<0]*(1-i)+t.DELTA_INDEX[(e<<0)+1]*i,i=127*i+127),this._multiplyMatrix([i/127,0,0,0,.5*(127-i),0,i/127,0,0,.5*(127-i),0,0,i/127,0,.5*(127-i),0,0,0,1,0,0,0,0,0,1]),this},e.adjustSaturation=function(t){if(0==t||isNaN(t))return this;t=this._cleanValue(t,100);var e=1+(t>0?3*t/100:t/100),i=.3086,n=.6094,s=.082;return this._multiplyMatrix([i*(1-e)+e,n*(1-e),s*(1-e),0,0,i*(1-e),n*(1-e)+e,s*(1-e),0,0,i*(1-e),n*(1-e),s*(1-e)+e,0,0,0,0,0,1,0,0,0,0,0,1]),this},e.adjustHue=function(t){if(0==t||isNaN(t))return this;t=this._cleanValue(t,180)/180*Math.PI;var e=Math.cos(t),i=Math.sin(t),n=.213,s=.715,r=.072;return this._multiplyMatrix([n+e*(1-n)+i*-n,s+e*-s+i*-s,r+e*-r+i*(1-r),0,0,n+e*-n+.143*i,s+e*(1-s)+.14*i,r+e*-r+i*-.283,0,0,n+e*-n+i*-(1-n),s+e*-s+i*s,r+e*(1-r)+i*r,0,0,0,0,0,1,0,0,0,0,0,1]),this},e.concat=function(e){return e=this._fixMatrix(e),e.length!=t.LENGTH?this:(this._multiplyMatrix(e),this)},e.clone=function(){return(new t).copy(this)},e.toArray=function(){for(var e=[],i=0,n=t.LENGTH;n>i;i++)e[i]=this[i];return e},e.copy=function(e){for(var i=t.LENGTH,n=0;i>n;n++)this[n]=e[n];return this},e.toString=function(){return"[ColorMatrix]"},e._multiplyMatrix=function(t){var e,i,n,s=[];for(e=0;5>e;e++){for(i=0;5>i;i++)s[i]=this[i+5*e];for(i=0;5>i;i++){var r=0;for(n=0;5>n;n++)r+=t[i+5*n]*s[n];this[i+5*e]=r}}},e._cleanValue=function(t,e){return Math.min(e,Math.max(-e,t))},e._fixMatrix=function(e){return e instanceof t&&(e=e.toArray()),e.length<t.LENGTH?e=e.slice(0,e.length).concat(t.IDENTITY_MATRIX.slice(e.length,t.LENGTH)):e.length>t.LENGTH&&(e=e.slice(0,t.LENGTH)),e},createjs.ColorMatrix=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.matrix=t}var e=createjs.extend(t,createjs.Filter);e.toString=function(){return"[ColorMatrixFilter]"},e.clone=function(){return new t(this.matrix)},e._applyFilter=function(t){for(var e,i,n,s,r=t.data,o=r.length,a=this.matrix,h=a[0],l=a[1],c=a[2],u=a[3],d=a[4],p=a[5],f=a[6],v=a[7],m=a[8],g=a[9],y=a[10],_=a[11],b=a[12],w=a[13],x=a[14],P=a[15],S=a[16],C=a[17],T=a[18],E=a[19],k=0;o>k;k+=4)e=r[k],i=r[k+1],n=r[k+2],s=r[k+3],r[k]=e*h+i*l+n*c+s*u+d,r[k+1]=e*p+i*f+n*v+s*m+g,r[k+2]=e*y+i*_+n*b+s*w+x,r[k+3]=e*P+i*S+n*C+s*T+E;return!0},createjs.ColorMatrixFilter=createjs.promote(t,"Filter")}(),this.createjs=this.createjs||{},function(){"use strict";function t(){throw"Touch cannot be instantiated"}t.isSupported=function(){return!!("ontouchstart"in window||window.navigator.msPointerEnabled&&window.navigator.msMaxTouchPoints>0||window.navigator.pointerEnabled&&window.navigator.maxTouchPoints>0)},t.enable=function(e,i,n){return e&&e.canvas&&t.isSupported()?e.__touch?!0:(e.__touch={pointers:{},multitouch:!i,preventDefault:!n,count:0},"ontouchstart"in window?t._IOS_enable(e):(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)&&t._IE_enable(e),!0):!1},t.disable=function(e){e&&("ontouchstart"in window?t._IOS_disable(e):(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)&&t._IE_disable(e),delete e.__touch)},t._IOS_enable=function(e){var i=e.canvas,n=e.__touch.f=function(i){t._IOS_handleEvent(e,i)};i.addEventListener("touchstart",n,!1),i.addEventListener("touchmove",n,!1),i.addEventListener("touchend",n,!1),i.addEventListener("touchcancel",n,!1)},t._IOS_disable=function(t){var e=t.canvas;if(e){var i=t.__touch.f;e.removeEventListener("touchstart",i,!1),e.removeEventListener("touchmove",i,!1),e.removeEventListener("touchend",i,!1),e.removeEventListener("touchcancel",i,!1)}},t._IOS_handleEvent=function(t,e){if(t){t.__touch.preventDefault&&e.preventDefault&&e.preventDefault();for(var i=e.changedTouches,n=e.type,s=0,r=i.length;r>s;s++){var o=i[s],a=o.identifier;o.target==t.canvas&&("touchstart"==n?this._handleStart(t,a,e,o.pageX,o.pageY):"touchmove"==n?this._handleMove(t,a,e,o.pageX,o.pageY):("touchend"==n||"touchcancel"==n)&&this._handleEnd(t,a,e))}}},t._IE_enable=function(e){var i=e.canvas,n=e.__touch.f=function(i){t._IE_handleEvent(e,i)};void 0===window.navigator.pointerEnabled?(i.addEventListener("MSPointerDown",n,!1),window.addEventListener("MSPointerMove",n,!1),window.addEventListener("MSPointerUp",n,!1),window.addEventListener("MSPointerCancel",n,!1),e.__touch.preventDefault&&(i.style.msTouchAction="none")):(i.addEventListener("pointerdown",n,!1),window.addEventListener("pointermove",n,!1),window.addEventListener("pointerup",n,!1),window.addEventListener("pointercancel",n,!1),e.__touch.preventDefault&&(i.style.touchAction="none")),e.__touch.activeIDs={}},t._IE_disable=function(t){var e=t.__touch.f;void 0===window.navigator.pointerEnabled?(window.removeEventListener("MSPointerMove",e,!1),window.removeEventListener("MSPointerUp",e,!1),window.removeEventListener("MSPointerCancel",e,!1),t.canvas&&t.canvas.removeEventListener("MSPointerDown",e,!1)):(window.removeEventListener("pointermove",e,!1),window.removeEventListener("pointerup",e,!1),window.removeEventListener("pointercancel",e,!1),t.canvas&&t.canvas.removeEventListener("pointerdown",e,!1))},t._IE_handleEvent=function(t,e){if(t){t.__touch.preventDefault&&e.preventDefault&&e.preventDefault();var i=e.type,n=e.pointerId,s=t.__touch.activeIDs;if("MSPointerDown"==i||"pointerdown"==i){if(e.srcElement!=t.canvas)return;s[n]=!0,this._handleStart(t,n,e,e.pageX,e.pageY)}else s[n]&&("MSPointerMove"==i||"pointermove"==i?this._handleMove(t,n,e,e.pageX,e.pageY):("MSPointerUp"==i||"MSPointerCancel"==i||"pointerup"==i||"pointercancel"==i)&&(delete s[n],this._handleEnd(t,n,e)))}},t._handleStart=function(t,e,i,n,s){var r=t.__touch;if(r.multitouch||!r.count){var o=r.pointers;o[e]||(o[e]=!0,r.count++,t._handlePointerDown(e,i,n,s))}},t._handleMove=function(t,e,i,n,s){t.__touch.pointers[e]&&t._handlePointerMove(e,i,n,s)},t._handleEnd=function(t,e,i){var n=t.__touch,s=n.pointers;s[e]&&(n.count--,t._handlePointerUp(e,i,!0),delete s[e])},createjs.Touch=t}(),this.createjs=this.createjs||{},function(){"use strict";var t=createjs.EaselJS=createjs.EaselJS||{};t.version="0.8.2",t.buildDate="Thu, 26 Nov 2015 20:44:34 GMT"}();var fjs=function(){"use strict";var t={},e="hardReturn;",i=function(e){if(t.isString(e)){var i=e.match(/(.*)\s*[=-]>\s*(.*)/);i.shift();var n=i.shift().replace(/^\s*|\s(?=\s)|\s*$|,/g,"").split(" "),s=i.shift();return i=(/\s*return\s+/.test(s)?"":"return ")+s,n.push(i),Function.apply({},n)}},n=function(t){return t.length>0?[].slice.call(t,0):[]};t.isFunction=function(t){return!!(t&&t.constructor&&t.call&&t.apply)},t.isObject=function(e){return t.isFunction(e)||!!e&&"object"==typeof e},t.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)};var s=function(e){if(!t.isFunction(e)&&(e=i(e),!t.isFunction(e)))throw"fjs Error: Invalid function";return e};return t.curry=function(e){return e=s(e),function i(){var s=n(arguments);if(s.length===e.length)return e.apply(null,s);if(s.length>e.length){var r=e.apply(null,s);return t.fold(e,r,s.slice(e.length))}return function(){var t=n(arguments);return i.apply(null,s.concat(t))}}},t.each=t.curry(function(i,n){if(i=s(i),t.exists(n)&&t.isArray(n))for(var r=0;r<n.length;r+=1)if(i.call(null,n[r],r)===e)return}),t.map=t.curry(function(e,i){e=s(e);var n=[];return t.each(function(){n.push(e.apply(null,arguments))},i),n}),t.fold=t.foldl=t.curry(function(e,i,n){return e=s(e),t.each(function(t,n){i=e.call(null,i,t,n)},n),i}),t.reduce=t.reducel=t.foldll=t.curry(function(e,i){e=s(e);var n=i[0];return i.shift(),t.fold(e,n,i)}),t.clone=function(e){var i=[];return t.each(function(t){i.push(t)},e),i},t.first=t.head=t.take=t.curry(function(i,n){i=s(i);var r;return t.each(function(t){return i.call(null,t)?(r=t,e):void 0},n),r}),t.rest=t.tail=t.drop=t.curry(function(e,i){var n=t.select(e,i);return n.shift(),n}),t.last=t.curry(function(e,i){var n=t.clone(i);return t.first(e,n.reverse())}),t.every=t.all=t.curry(function(i,n){i=s(i);var r=!0;return t.each(function(t){return i.call(null,t)?void 0:(r=!1,e)},n),r}),t.any=t.contains=t.curry(function(i,n){i=s(i);var r=!1;return t.each(function(t){return i.call(null,t)?(r=!0,e):void 0},n),r}),t.select=t.filter=t.curry(function(e,i){e=s(e);var n=[];return t.each(function(t){e.call(null,t)&&n.push(t)},i),n}),t.best=t.curry(function(e,i){e=s(e);var n=function(t,i){return e.call(this,t,i)?t:i};return t.reduce(n,i)}),t["while"]=t.curry(function(i,n){i=s(i);var r=[];return t.each(function(t){return i.call(null,t)?void r.push(t):e},n),r}),t.compose=function(e){var i=t.any(function(e){return!t.isFunction(e)});if(e=n(arguments).reverse(),i(e))throw"fjs Error: Invalid function to compose";return function(){var i=arguments,n=t.each(function(t){i=[t.apply(null,i)]});return n(e),i[0]}},t.partition=t.curry(function(e,i){e=s(e);var n=[],r=[];return t.each(function(t){(e.call(null,t)?n:r).push(t)},i),[n,r]}),t.group=t.curry(function(e,i){e=s(e);var n,r={};return t.each(function(t){n=e.call(null,t),r[n]=r[n]||[],r[n].push(t)},i),r}),t.shuffle=function(e){var i,n;return t.each(function(t,s){i=Math.floor(Math.random()*(s+1)),n=e[s],e[s]=e[i],e[i]=n},e),e},t.toArray=function(e){return t.map(function(t){return[t,e[t]]},Object.keys(e))},t.apply=t.curry(function(e,i){var n=[];return t.isArray(e)&&(n=[].slice.call(e,1),e=e[0]),t.map(function(t){return t[e].apply(t,n)},i)}),t.assign=t.extend=t.curry(function(e,i){return t.each(function(t){i[t]=e[t]},Object.keys(e)),i}),t.prop=function(t){return function(e){return e[t]}},t.pluck=t.curry(function(e,i){return t.map(t.prop(e),i)}),t.nub=t.unique=t.distinct=t.curry(function(e,i){var n=i.length>0?[i[0]]:[];return t.each(function(i){t.any(t.curry(e)(i),n)||(n[n.length]=i)},i),n}),t.exists=function(t){return null!=t},t.truthy=function(e){return t.exists(e)&&e!==!1},t.falsy=function(e){return!t.truthy(e)},t.each(function(e){t["is"+e]=function(t){return Object.prototype.toString.call(t)==="[object "+e+"]"}},["Arguments","Date","Number","RegExp","String"]),t}();"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=fjs),exports.fjs=fjs);!function(t,e){"object"==typeof exports?module.exports=e.call(t):"function"==typeof define&&define.amd?define(function(){return e.call(t)}):t.Physics=e.call(t)}("undefined"!=typeof window?window:this,function(){"use strict";var t=this,e=t.document,i=function r(){return r.world.apply(r,arguments)};i.util={},function(){i.aabb=function(t,e,i,n){var s={x:0,y:0,hw:0,hh:0};return void 0===t?s:(t&&void 0!==t.x&&(i=e.x,n=e.y,e=t.y,t=t.x),void 0===n&&void 0!==t&&void 0!==e?(s.hw=.5*t,s.hh=.5*e,i&&void 0!==i.x&&(s.x=i.x,s.y=i.y),s):(s.hw=.5*Math.abs(i-t),s.hh=.5*Math.abs(n-e),s.x=.5*(i+t),s.y=.5*(n+e),s))},i.aabb.contains=function(t,e){return e.x>t.x-t.hw&&e.x<t.x+t.hw&&e.y>t.y-t.hh&&e.y<t.y+t.hh},i.aabb.clone=function(t){return{x:t.x,y:t.y,hw:t.hw,hh:t.hh}},i.aabb.union=function(t,e,i){var n=i===!0?t:{},s=Math.max(t.x+t.hw,e.x+e.hw),r=Math.max(t.y+t.hh,e.y+e.hh),o=Math.min(t.x-t.hw,e.x-e.hw),a=Math.min(t.y-t.hh,e.y-e.hh);return n.hw=.5*Math.abs(s-o),n.hh=.5*Math.abs(r-a),n.x=.5*(s+o),n.y=.5*(r+a),n},i.aabb.overlap=function(t,e){var i=t.x-t.hw,n=e.x-e.hw,s=t.x+t.hw,r=e.x+e.hw;return s>=n&&r>=s||r>=i&&s>=r?(i=t.y-t.hh,n=e.y-e.hh,s=t.y+t.hh,r=e.y+e.hh,s>=n&&r>=s||r>=i&&s>=r):!1}}(),function(){var t=1e-4,e=100,n=function(t,e,i){var n=e.normSq()-e.dot(t),s=e.dot(t)-t.normSq();return 0>n?i.clone(e).negate():s>0?i.clone(t).negate():(i.clone(e).vsub(t),i.perp(t.cross(i)>0))},s=function(t){var e,n,s=t.length,r=t[s-2],o=t[s-3],a=i.scratchpad(),h=a.vector().clone(r.pt),l=a.vector().clone(o.pt).vsub(h);return l.equals(i.vector.zero)?a.done({a:r.a,b:r.b}):(e=-l.dot(h)/l.normSq(),n=1-e,a.done(0>=n?{a:o.a,b:o.b}:0>=e?{a:r.a,b:r.b}:{a:h.clone(r.a).mult(n).vadd(l.clone(o.a).mult(e)).values(),b:h.clone(r.b).mult(n).vadd(l.clone(o.b).mult(e)).values()}))},r=function(r,o,a,h){var l,c,u,d,p=!1,f=!1,v=!1,m=[],g=1,y=i.scratchpad(),_=y.vector().clone(o||i.vector.axis[0]),b=y.vector(),w=y.vector(),x=y.vector(),P=y.vector(),S=0;for(d=r(_),g=m.push(d),b.clone(d.pt),_.negate();++S;){if(b.swap(w),d=r(_),g=m.push(d),b.clone(d.pt),h&&h(m),b.equals(i.vector.zero)){p=!0;break}if(!f&&b.dot(_)<=0){if(a)break;f=!0}if(2===g)_=n(b,w,_);else if(f){if(_.normalize(),d=w.dot(_),Math.abs(d-b.dot(_))<t){v=-d;break}w.normSq()<x.clone(m[0].pt).normSq()?m.shift():m.splice(1,1),_=n(x.clone(m[1].pt),P.clone(m[0].pt),_)}else if(l=l||y.vector(),c=c||y.vector(),l.clone(w).vsub(b),c.clone(m[0].pt).vsub(b),u=l.cross(c)>0,u^b.cross(l)>0)m.shift(),l.perp(!u),_.swap(l);else{if(!(u^c.cross(b)>0)){p=!0;break}m.splice(1,1),c.perp(u),_.swap(l)}if(S>e)return y.done(),{simplex:m,iterations:S,distance:0,maxIterationsReached:!0}}return y.done(),d={overlap:p,simplex:m,iterations:S},v!==!1&&(d.distance=v,d.closest=s(m)),d};i.gjk=r}(),function(){
i.statistics={pushRunningAvg:function(t,e,i,n){var s=t-i;return i+=s/e,n+=s*(t-i),[i,n]},pushRunningVectorAvg:function(t,e,i,n){var s=1/e,r=t.get(0)-i.get(0),o=t.get(1)-i.get(1);i.add(r*s,o*s),n&&(r*=t.get(0)-i.get(0),o*=t.get(1)-i.get(1),n.add(r,o))}}}(),function(){var t=function e(t,n,s){return this instanceof e?(this.v=new i.vector,this.o=new i.vector,t instanceof e?void this.clone(t):(t&&this.setTranslation(t),void this.setRotation(n||0,s))):new e(t,n)};t.prototype.setTranslation=function(t){return this.v.clone(t),this},t.prototype.setRotation=function(t,e){return this.cosA=Math.cos(t),this.sinA=Math.sin(t),e?this.o.clone(e):this.o.zero(),this},t.prototype.clone=function(e){return e?(this.setTranslation(e.v),this.cosA=e.cosA,this.sinA=e.sinA,this.o.clone(e.o),this):new t(this)},i.transform=t}(),function(t){var e=Math.sqrt,n=Math.min,s=Math.max,r=(Math.acos,Math.atan2),o=2*Math.PI,a=!!t.Float64Array,h=function l(t,e){return this instanceof l?(this._=a?new Float64Array(5):[],void(t&&(void 0!==t.x||t._&&t._.length)?this.clone(t):(this.recalc=!0,this.set(t,e)))):new l(t,e)};Object.defineProperties(h.prototype,{x:{get:function(){return+this._[0]},set:function(t){t=+t||0,this.recalc=t===this._[0],this._[0]=t}},y:{get:function(){return+this._[1]},set:function(t){t=+t||0,this.recalc=t===this._[1],this._[1]=t}}}),h.prototype.set=function(t,e){return this.recalc=!0,this._[0]=+t||0,this._[1]=+e||0,this},h.prototype.get=function(t){return this._[t]},h.prototype.vadd=function(t){return this.recalc=!0,this._[0]+=t._[0],this._[1]+=t._[1],this},h.prototype.vsub=function(t){return this.recalc=!0,this._[0]-=t._[0],this._[1]-=t._[1],this},h.prototype.add=function(t,e){return this.recalc=!0,this._[0]+=+t||0,this._[1]+=+e||0,this},h.prototype.sub=function(t,e){return this.recalc=!0,this._[0]-=t,this._[1]-=void 0===e?0:e,this},h.prototype.mult=function(t){return this.recalc||(this._[4]*=t*t,this._[3]*=t),this._[0]*=t,this._[1]*=t,this},h.prototype.dot=function(t){return this._[0]*t._[0]+this._[1]*t._[1]},h.prototype.cross=function(t){return-this._[0]*t._[1]+this._[1]*t._[0]},h.prototype.proj=function(t){return this.dot(t)/t.norm()},h.prototype.vproj=function(t){var e=this.dot(t)/t.normSq();return this.clone(t).mult(e)},h.prototype.angle=function(t){var e;if(this.equals(h.zero))return t?t.angle():0/0;for(e=t&&!t.equals(h.zero)?r(this._[1]*t._[0]-this._[0]*t._[1],this._[0]*t._[0]+this._[1]*t._[1]):r(this._[1],this._[0]);e>Math.PI;)e-=o;for(;e<-Math.PI;)e+=o;return e},h.prototype.angle2=function(t,e){for(var i=t._[0]-this._[0],n=t._[1]-this._[1],s=e._[0]-this._[0],a=e._[1]-this._[1],h=r(n*s-i*a,i*s+n*a);h>Math.PI;)h-=o;for(;h<-Math.PI;)h+=o;return h},h.prototype.norm=function(){return this.recalc&&(this.recalc=!1,this._[4]=this._[0]*this._[0]+this._[1]*this._[1],this._[3]=e(this._[4])),this._[3]},h.prototype.normSq=function(){return this.recalc&&(this.recalc=!1,this._[4]=this._[0]*this._[0]+this._[1]*this._[1],this._[3]=e(this._[4])),this._[4]},h.prototype.dist=function(t){var i,n;return e((i=t._[0]-this._[0])*i+(n=t._[1]-this._[1])*n)},h.prototype.distSq=function(t){var e,i;return(e=t._[0]-this._[0])*e+(i=t._[1]-this._[1])*i},h.prototype.perp=function(t){var e=this._[0];return t?(this._[0]=this._[1],this._[1]=-e):(this._[0]=-this._[1],this._[1]=e),this},h.prototype.normalize=function(){var t=this.norm();return 0===t?this:(t=1/t,this._[0]*=t,this._[1]*=t,this._[3]=1,this._[4]=1,this)},h.prototype.transform=function(t){var e=t.sinA,i=t.cosA,n=t.o._[0],s=t.o._[1];return this._[0]-=n,this._[1]-=s,this.set(this._[0]*i-this._[1]*e+n+t.v._[0],this._[0]*e+this._[1]*i+s+t.v._[1])},h.prototype.transformInv=function(t){var e=t.sinA,i=t.cosA,n=t.o._[0],s=t.o._[1];return this._[0]-=n+t.v._[0],this._[1]-=s+t.v._[1],this.set(this._[0]*i+this._[1]*e+n,-this._[0]*e+this._[1]*i+s)},h.prototype.rotate=function(t,e){var i,n,s=0,r=0;return"number"==typeof t?(i=Math.sin(t),n=Math.cos(t),e&&(s=e.x,r=e.y)):(i=t.sinA,n=t.cosA,s=t.o._[0],r=t.o._[1]),this._[0]-=s,this._[1]-=r,this.set(this._[0]*n-this._[1]*i+s,this._[0]*i+this._[1]*n+r)},h.prototype.rotateInv=function(t){return this.set((this._[0]-t.o._[0])*t.cosA+(this._[1]-t.o._[1])*t.sinA+t.o._[0],-(this._[0]-t.o._[0])*t.sinA+(this._[1]-t.o._[1])*t.cosA+t.o._[1])},h.prototype.translate=function(t){return this.vadd(t.v)},h.prototype.translateInv=function(t){return this.vsub(t.v)},h.prototype.clone=function(t){return t?t._?(this.recalc=t.recalc,t.recalc||(this._[3]=t._[3],this._[4]=t._[4]),this._[0]=t._[0],this._[1]=t._[1],this):this.set(t.x,t.y):new h(this)},h.prototype.swap=function(t){var e=this._;return this._=t._,t._=e,e=this.recalc,this.recalc=t.recalc,t.recalc=e,this},h.prototype.values=function(){return{x:this._[0],y:this._[1]}},h.prototype.zero=function(){return this._[3]=0,this._[4]=0,this._[0]=0,this._[1]=0,this},h.prototype.negate=function(t){return void 0!==t?(this._[t]=-this._[t],this):(this._[0]=-this._[0],this._[1]=-this._[1],this)},h.prototype.clamp=function(t,e){return this._[0]=n(s(this._[0],t.x),e.x),this._[1]=n(s(this._[1],t.y),e.y),this.recalc=!0,this},h.prototype.toString=function(){return"("+this._[0]+", "+this._[1]+")"},h.prototype.equals=function(t){return this._[0]===t._[0]&&this._[1]===t._[1]&&this._[2]===t._[2]},h.axis=[new h(1,0),new h(0,1)],h.zero=new h(0,0),i.vector=h}(this),function(t){var e=t.Physics;i.noConflict=function(){return t.Physics===i&&(t.Physics=e),i}}(this);var n=i.util.decorator=function(t,e){var n={},s={},r=function(t,e){var n,s;for(s in e)n=Object.getOwnPropertyDescriptor(e,s),n.get||n.set?Object.defineProperty(t,s,n):i.util.isFunction(n.value)&&(t[s]=n.value);return t},o=Object.getPrototypeOf;"function"!=typeof o&&(o="object"==typeof"test".__proto__?function(t){return t.__proto__}:function(t){return t.constructor.prototype});var a=Object.create;"function"!=typeof a&&(a=function(t){function e(){}return e.prototype=t,new e});var h=function(e,n){return"object"==typeof e?(s=r(s,e),void(s.type=t)):void("type"!==e&&i.util.isFunction(n)&&(s[e]=n))};h(e);var l=function(e,i,h,l){var c,u=s;if("string"!=typeof i)l=h,h=i;else{if(u=n[i],!u)throw'Error: "'+i+'" '+t+" not defined";u=u.prototype}if("function"==typeof h)c=n[e],c?c.prototype=r(c.prototype,h(o(c.prototype))):(c=n[e]=function(t){this.init&&this.init(t)},c.prototype=a(u),c.prototype=r(c.prototype,h(u,c.prototype))),c.prototype.type=t,c.prototype.name=e;else if(l=h||{},c=n[e],!c)throw'Error: "'+e+'" '+t+" not defined";return l?new c(l):void 0};return l.mixin=h,l};i.util.indexOf=function(t,e){for(var i=0,n=t.length;n>i;){if(n--,t[i]===e)return i;if(t[n]===e)return n;i++}return-1},i.util.clearArray=function(t){for(var e=t.length;e--;)t.pop();return t},i.util.throttle=function(t,e,i){var n,s,r=!1,o=function(){clearTimeout(n),r?(r=!1,n=setTimeout(o,e),t.apply(i,s)):n=!1};return i=i||null,function(){r=!0,s=arguments,n||o()}};var s=function(t,e){return i.util.isPlainObject(e)?i.util.extend({},t,e,s):void 0!==e?e:t};return i.util.options=function(t,e){var n,r={},o=[];return n=function(t,n){i.util.extend(e,t,n?s:null);for(var r=0,a=o.length;a>r;++r)o[r](e);return e},n.defaults=function(t,n){return i.util.extend(r,t,n?s:null),i.util.defaults(e,r,n?s:null),r},n.onChange=function(t){o.push(t)},e=e||n,n.defaults(t),n},i.util.pairHash=function(t,e){return t=0|t,e=0|e,(0|t)===(0|e)?-1:0|((0|t)>(0|e)?t<<16|65535&e:e<<16|65535&t)},i.util.bind=Function.prototype.bind?function(t,e,i){return i=Array.prototype.slice.call(arguments,1),Function.prototype.bind.apply(t,i)}:function(t,e,i){return i=Array.prototype.slice.call(arguments,2),function(){return t.apply(e,i.concat(Array.prototype.slice.call(arguments)))}},i.util.find=function(t,e){var i,n,s=t.length;for(i=0;s>i;i++)if(n=t[i],e(n,i,t))return n},i.util.filter=function(t,e){var i,n,s=t.length,r=[];for(i=0;s>i;i++)n=t[i],e(n,i,t)&&r.push(n);return r},function(){function t(t){i.util.clearArray(t),w.length<P&&w.push(t)}function e(t){var i=t.cache;i&&e(i),t.array=t.cache=t.criteria=t.object=t.number=t.string=t.value=null,x.length<P&&x.push(t)}function n(){return x.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function s(){return w.pop()||[]}function r(t,e){var n=typeof e;if(t=t.cache,"boolean"===n||null==e)return t[e]?0:-1;"number"!==n&&"string"!==n&&(n="object");var s="number"===n?e:S+e;return t=(t=t[n])&&t[s],"object"===n?t&&i.util.indexOf(t,e)>-1?0:-1:t?0:-1}function o(t){var e=this.cache,i=typeof t;if("boolean"===i||null==t)e[t]=!0;else{"number"!==i&&"string"!==i&&(i="object");var n="number"===i?t:S+t,s=e[i]||(e[i]={});"object"===i?(s[n]||(s[n]=[])).push(t):s[n]=!0}}function a(t){var e=-1,i=t.length,s=t[0],r=t[i/2|0],a=t[i-1];if(s&&"object"==typeof s&&r&&"object"==typeof r&&a&&"object"==typeof a)return!1;var h=n();h["false"]=h["null"]=h["true"]=h.undefined=!1;var l=n();for(l.array=t,l.cache=h,l.push=o;++e<i;)l.push(t[e]);return l}function h(t,e){return t+Math.floor(Math.random()*(e-t+1))}function l(t){return"function"==typeof t}function c(t){return"function"==typeof t&&k.test(t)}function u(t){var e,i;if(!t||y.call(t)!==m||(e=t.constructor,l(e)&&!(e instanceof e)))return!1;for(var n in t)i=n;return"undefined"==typeof i||_.call(t,i)}function d(n,o,h){var l=-1,c=i.util.indexOf,u=n?n.length:0,d=[],p=!o&&u>=b&&c===i.util.indexOf,f=h||p?s():d;if(p){var v=a(f);c=r,f=v}for(;++l<u;){var m=n[l],g=h?h(m,l,n):m;(o?!l||f[f.length-1]!==g:c(f,g)<0)&&((h||p)&&f.push(g),d.push(m))}return p?(t(f.array),e(f)):h&&t(f),d}var p={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},f=function(t){return t},v="[object Array]",m="[object Object]",g=Object.keys,y=Object.prototype.toString,_=Object.prototype.hasOwnProperty,b=75,w=[],x=[],P=40,S=+new Date+"",C=function(t){var e,i=t,n=[];if(!i)return n;if(!p[typeof t])return n;for(e in i)_.call(i,e)&&n.push(e);return n},T=g?function(t){return i.util.isObject(t)?g(t):[]}:C,E=0;i.util.uniqueId=function(t){var e=++E;return""+(t||"")+e},i.util.shuffle=function(t){var e,i,n,s,r=-1,o=t?t.length:0,a=Array("number"==typeof o?o:0);for(e=0,i=t.length;i>e;e++)n=t[e],s=h(0,++r),a[r]=a[s],a[s]=n;return a},i.util.isObject=function(t){return!(!t||!p[typeof t])},i.util.isFunction=l,i.util.isArray=Array.isArray||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&y.call(t)===v||!1};var k=RegExp("^"+String(y).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$");i.util.isPlainObject=Object.getPrototypeOf?function(t){if(!t||y.call(t)!==m)return!1;var e=t.valueOf,i=c(e)&&(i=Object.getPrototypeOf(e))&&Object.getPrototypeOf(i);return i?t===i||Object.getPrototypeOf(t)===i:u(t)}:u,i.util.uniq=function(t,e,i){return"boolean"!=typeof e&&null!=e&&(i=e,e=!1),d(t,e,i)};var j=function(t,e,i){var n,s=t,r=s;if(!s)return r;var o,a=arguments,h=0,l="number"==typeof i?2:a.length;for(l>2&&"function"==typeof a[l-1]&&(o=a[--l]);++h<l;)if(s=a[h],s&&p[typeof s])for(var c=-1,u=p[typeof s]&&T(s),d=u?u.length:0;++c<d;)n=u[c],r[n]=o?o(r[n],s[n]):s[n];return r};i.util.extend=j,i.util.defaults=function(t,e,i){var n,s=t,r=s;if(!s)return r;for(var o=arguments,a=0,h="number"==typeof i?2:o.length;++a<h;)if(s=o[a],s&&p[typeof s])for(var l=-1,c=p[typeof s]&&T(s),u=c?c.length:0;++l<u;)n=c[l],"undefined"==typeof r[n]&&(r[n]=s[n]);return r},i.util.sortedIndex=function(t,e,i){var n=0,s=t?t.length:n;for(i=i||f,e=i(e);s>n;){var r=n+s>>>1;i(t[r])<e?n=r+1:s=r}return n}}(),i.scratchpad=function(){var t,e,n="Error: Scratchpad used after .done() called. (Could it be unintentionally scoped?)",s="Error: Scratchpad usage space out of bounds. (Did you forget to call .done()?)",r="Error: Too many scratchpads created. (Did you forget to call .done()?)",o="Error: Object is already registered.",a=[],h=0,l=0;return t=function(){if(this._active=!1,this._indexArr=[],++h>=e.maxScratches)throw r},t.prototype={done:function(t){this._active=!1;for(var e=0;l>e;++e)this[e]=0;return a.push(this),t}},e=function c(e){if(e)return c.fn(e);var i=a.pop()||new t;return i._active=!0,i},e.maxScratches=100,e.maxIndex=20,e.fn=function(e){for(var i=[],n=0,s=e.length;s>n;n++)i.push(n);i="a"+i.join(",a");var r=new Function("fn, scratches, Scratch","return function("+i+"){ var scratch = scratches.pop() || new Scratch( scratches );scratch._active = true;return scratch.done( fn(scratch, "+i+") );};");return r(e,a,t)},e.register=function(i,r,a){var h=t.prototype,c=l++,u="_"+i+"Stack",d=a&&a.useFactory;if(i in h)throw o;t.prototype[i]=function(){var t=this[u]||(this[u]=[]),i=0|this[c];if(this[c]=i+1,!this._active)throw n;if(i>=e.maxIndex)throw s;return t[i]||(t[i]=d?r():new r)}},e.register("vector",i.vector),e.register("transform",i.transform),e}(),function(){function t(t){return t._priority_}var e=1;i.scratchpad.register("event",function(){return{}},{useFactory:!0});var n=function s(){return this instanceof s?void 0:new s};n.prototype={on:function(n,s,r,o){var a,h,l;if(this._topics=this._topics||(this._topics={}),i.util.isObject(n)){for(var c in n)this.on(c,n[c],s,r);return this}return a=this._topics[n]||(this._topics[n]=[]),h=s,i.util.isObject(r)?(s=i.util.bind(s,r),s._bindfn_=h,s._one_=h._one_,s._scope_=r):void 0===o&&(o=r),s._priority_=void 0===o?e:o,l=i.util.sortedIndex(a,s,t),a.splice(l,0,s),this},off:function(t,e,n){var s,r;if(!this._topics)return this;if(t===!0)return this._topics={},this;if(i.util.isObject(t)){for(var o in t)this.off(o,t[o]);return this}if(s=this._topics[t],!s)return this;if(e===!0)return this._topics[t]=[],this;for(var a=0,h=s.length;h>a;a++)if(r=s[a],!(r._bindfn_!==e&&r!==e||n&&r._scope_!==n)){s.splice(a,1);break}return this},emit:function(t,e){if(!this._topics)return this;var n,s,r=this._topics[t],o=r&&r.length,a=i.scratchpad();if(!o)return a.done(this);for(s=a.event(),s.topic=t,s.handler=n;o--;)n=r[o],n(e,s),n._one_&&r.splice(o,1);return a.done(this)},one:function(t,e,n){if(i.util.isObject(t)){for(var s in t)this.one(s,t[s],e,n);return this}return e._one_=!0,this.on(t,e,n),this}},i.util.pubsub=n}(),function(t){function e(){return u&&u.now?u.now()+u.timing.navigationStart:Date.now()}function n(){var i;t.requestAnimationFrame(n),l&&(i=e(),i&&c.emit("tick",i))}function s(){return l=!0,this}function r(){return l=!1,this}function o(t){return c.on("tick",t),this}function a(t){return c.off("tick",t),this}function h(){return!!l}var l=!0,c=i.util.pubsub(),u=t.performance;t.requestAnimationFrame?n():l=!1,i.util.ticker={now:e,start:s,stop:r,on:o,off:a,isActive:h}}(this),function(){var t=function(){return!0},e=i.util.indexOf,n=function(t,e){return function(i){return t(i[e])}},s=function(t,n){return function(s){s=n?s[n]:s;var r,o=0;if(i.util.isArray(s)){if(i.util.isArray(t)){if(r=s.length,r!==t.length)return!1;for(;r>o;){if(r--,-1===e(t,s[o])||-1===e(t,s[r]))return!1;o++}return!0}return e(s,t)>-1}return s===t}},r=function(t,e){var i=s(t,e);return function(t){return!i(t)}},o=function(t,n){return function(s){s=n?s[n]:s;var r,o=0;if(i.util.isArray(s)){for(r=s.length;r>o;){if(r--,e(t,s[o])>-1||e(t,s[r])>-1)return!0;o++}return!1}return e(t,s)>-1}},a=function(t,e){var i=o(t,e);return function(t){return!i(t)}},h=function(t){return t=new i.vector(t),function(e){var n=e.aabb();return i.aabb.contains(n,t)}},l=function(t){return t.next?function(e){for(var i=t;i;){if(!i(e))return!1;i=i.next}return!0}:t},c=function(t){return t.next?function(e){for(var i=t;i;){if(i(e))return!0;i=i.next}return!1}:t},u={$eq:s,$ne:r,$in:o,$nin:a,$at:h},d=function p(e,r){var o,a,h,d,f,v;if(r){if("$or"===r||"$and"===r){for(o=0,a=e.length;a>o;++o)v=p(e[o]),f=f?f.next=v:d=v;return"$or"===r?c(d):l(d)}if(o=u[r])return o(e);throw"Unknown query operation: "+r}for(o in e)h=e[o],v="$"===o[0]?p(h,o):i.util.isPlainObject(h)?n(p(h),o):s(h,o),f=f?f.next=v:d=v;return l(d||t)};i.query=d}(this),function(){var t={priority:0};i.behavior=n("behavior",{init:function(e){this.options=i.util.options(t),this.options(e)},applyTo:function(t){return this._targets=t===!0?null:i.util.uniq(t),this},getTargets:function(){return this._targets||(this._world?this._world._bodies:[])},setWorld:function(t){return this.disconnect&&this._world&&this.disconnect(this._world),this._world=t,this.connect&&t&&this.connect(t),this},connect:function(t){this.behave&&t.on("integrate:positions",this.behave,this,this.options.priority)},disconnect:function(t){this.behave&&t.off("integrate:positions",this.behave,this)},behave:null})}(),function(){{var t={hidden:!1,treatment:"dynamic",mass:1,restitution:1,cof:.8,view:null},e=1;2*Math.PI}i.body=n("body",{init:function(n){var s=this,r=i.vector;if(this.options=i.util.options(t,this),this.options.onChange(function(t){s.offset=new r(t.offset)}),this.options(n),this.state={pos:new r(this.x,this.y),vel:new r(this.vx,this.vy),acc:new r,angular:{pos:this.angle||0,vel:this.angularVelocity||0,acc:0},old:{pos:new r,vel:new r,acc:new r,angular:{pos:0,vel:0,acc:0}}},this._sleepAngPosMean=0,this._sleepAngPosVariance=0,this._sleepPosMean=new r,this._sleepPosVariance=new r,this._sleepMeanK=0,delete this.x,delete this.y,delete this.vx,delete this.vy,delete this.angle,delete this.angularVelocity,0===this.mass)throw"Error: Bodies must have non-zero mass";this.uid=e++,this.geometry=i.geometry("point")},sleep:function(t){return t===!0?this.asleep=!0:t===!1?(this.asleep=!1,this._sleepMeanK=0,this._sleepAngPosMean=0,this._sleepAngPosVariance=0,this._sleepPosMean.zero(),this._sleepPosVariance.zero(),this.sleepIdleTime=0):t&&!this.asleep&&this.sleepCheck(t),this.asleep},sleepCheck:function(t){var e=this._world&&this._world.options;if(!(this.sleepDisabled||e&&e.sleepDisabled)){{var n,s,r,o,a,h,l=i.scratchpad();l.vector(),l.vector()}if(t=t||0,o=this.geometry.aabb(),r=Math.max(o.hw,o.hh),this.asleep&&(s=this.state.vel.norm()+Math.abs(r*this.state.angular.vel),n=this.sleepSpeedLimit||e&&e.sleepSpeedLimit||0,s>=n))return this.sleep(!1),l.done();this._sleepMeanK++,a=this._sleepMeanK>1?1/(this._sleepMeanK-1):0,i.statistics.pushRunningVectorAvg(this.state.pos,this._sleepMeanK,this._sleepPosMean,this._sleepPosVariance),h=i.statistics.pushRunningAvg(Math.sin(this.state.angular.pos),this._sleepMeanK,this._sleepAngPosMean,this._sleepAngPosVariance),this._sleepAngPosMean=h[0],this._sleepAngPosVariance=h[1],s=this._sleepPosVariance.norm()+Math.abs(r*Math.asin(h[1])),s*=a,n=this.sleepVarianceLimit||e&&e.sleepVarianceLimit||0,n>=s?(n=this.sleepTimeLimit||e&&e.sleepTimeLimit||0,this.sleepIdleTime=(this.sleepIdleTime||0)+t,this.sleepIdleTime>n&&(this.asleep=!0)):this.sleep(!1),l.done()}},setWorld:function(t){return this.disconnect&&this._world&&this.disconnect(this._world),this._world=t,this.connect&&t&&this.connect(t),this},accelerate:function(t){return"dynamic"===this.treatment&&this.state.acc.vadd(t),this},applyForce:function(t,e){if("dynamic"!==this.treatment)return this;var n,s=i.scratchpad(),r=s.vector();return e&&this.moi&&(n=this.state,r.clone(e),this.state.angular.acc-=r.cross(t)/this.moi),this.accelerate(r.clone(t).mult(1/this.mass)),s.done(),this},getGlobalOffset:function(t){return t=t||new i.vector,t.clone(this.offset).rotate(this.state.angular.pos),t},aabb:function(){var t=this.state.angular.pos,e=i.scratchpad(),n=e.vector(),s=this.geometry.aabb(t);return this.getGlobalOffset(n),s.x+=this.state.pos._[0]+n._[0],s.y+=this.state.pos._[1]+n._[1],e.done(s)},toBodyCoords:function(t){return t.vsub(this.state.pos).rotate(-this.state.angular.pos)},toWorldCoords:function(t){return t.rotate(this.state.angular.pos).vadd(this.state.pos)},recalc:function(){return this}}),i.body.getCOM=function(t,e){var n,s,r,o=t&&t.length,a=0;if(e=e||new i.vector,!o)return e.zero();if(1===o)return e.clone(t[0].state.pos);for(e.zero(),r=0;o>r;r++)n=t[r],s=n.state.pos,e.add(s._[0]*n.mass,s._[1]*n.mass),a+=n.mass;return e.mult(1/a),e}}(),function(){i.geometry=n("geometry",{init:function(t){this.options=i.util.options(),this.options(t),this._aabb=new i.aabb},aabb:function(){return i.aabb.clone(this._aabb)},getFarthestHullPoint:function(t,e){return e=e||new i.vector,e.set(0,0)},getFarthestCorePoint:function(t,e){return e=e||new i.vector,e.set(0,0)}})}(),i.geometry.regularPolygonVertices=function(t,e){var i,n=[],s=2*Math.PI/t,r=0;for(i=0;t>i;i++)n.push({x:e*Math.cos(r),y:e*Math.sin(r)}),r+=s;return n},i.geometry.isPolygonConvex=function(t){var e=i.scratchpad(),n=e.vector(),s=e.vector(),r=e.vector(),o=!0,a=!1,h=t.length;if(!t||!h)return!1;if(3>h)return e.done(),o;n.clone(t[0]).vsub(r.clone(t[h-1]));for(var l=1;h>=l;++l){if(s.clone(t[l%h]).vsub(r.clone(t[(l-1)%h])),a===!1)a=n.cross(s);else if(a>0^n.cross(s)>0){o=!1;break}s.swap(n)}return e.done(),o},i.geometry.getPolygonMOI=function(t){var e,n=i.scratchpad(),s=n.vector(),r=n.vector(),o=0,a=0,h=t.length;if(2>h)return n.done(),0;if(2===h)return e=r.clone(t[1]).distSq(s.clone(t[0])),n.done(),e/12;s.clone(t[0]);for(var l=1;h>l;++l)r.clone(t[l]),e=Math.abs(r.cross(s)),o+=e*(r.normSq()+r.dot(s)+s.normSq()),a+=e,s.swap(r);return n.done(),o/(6*a)},i.geometry.isPointInPolygon=function(t,e){var n=i.scratchpad(),s=n.vector().clone(t),r=n.vector(),o=n.vector(),a=0,h=e.length;if(2>h)return a=s.equals(r.clone(e[0])),n.done(),a;if(2===h)return a=s.angle(r.clone(e[0])),a+=s.angle(r.clone(e[1])),n.done(),Math.abs(a)===Math.PI;r.clone(e[0]).vsub(s);for(var l=1;h>=l;++l)o.clone(e[l%h]).vsub(s),a+=o.angle(r),r.swap(o);return n.done(),Math.abs(a)>1e-6},i.geometry.getPolygonArea=function(t){var e=i.scratchpad(),n=e.vector(),s=e.vector(),r=0,o=t.length;if(3>o)return e.done(),0;n.clone(t[o-1]);for(var a=0;o>a;++a)s.clone(t[a]),r+=n.cross(s),n.swap(s);return e.done(),r/2},i.geometry.getPolygonCentroid=function(t){var e,n=i.scratchpad(),s=n.vector(),r=n.vector(),o=new i.vector,a=t.length;if(2>a)return n.done(),new i.vector(t[0]);if(2===a)return n.done(),new i.vector((t[1].x+t[0].x)/2,(t[1].y+t[0].y)/2);s.clone(t[a-1]);for(var h=0;a>h;++h)r.clone(t[h]),e=s.cross(r),s.vadd(r).mult(e),o.vadd(s),s.swap(r);return e=1/(6*i.geometry.getPolygonArea(t)),n.done(),o.mult(e)},i.geometry.nearestPointOnLine=function(t,e,n){var s,r,o=i.scratchpad(),a=o.vector().clone(t),h=o.vector().clone(e).vsub(a),l=o.vector().clone(n).vsub(a).vsub(h);return l.equals(i.vector.zero)?(o.done(),new i.vector(e)):(s=-l.dot(h)/l.normSq(),r=1-s,0>=r?(o.done(),new i.vector(n)):0>=s?(o.done(),new i.vector(e)):(a=new i.vector(n).mult(s).vadd(h.clone(e).mult(r)),o.done(),a))},function(){var t={drag:0};i.integrator=n("integrator",{init:function(e){this.options=i.util.options(t),this.options(e)},setWorld:function(t){return this.disconnect&&this._world&&this.disconnect(this._world),this._world=t,this.connect&&t&&this.connect(t),this},integrate:function(t,e){var i=this._world;return this.integrateVelocities(t,e),i&&i.emit("integrate:velocities",{bodies:t,dt:e}),this.integratePositions(t,e),i&&i.emit("integrate:positions",{bodies:t,dt:e}),this},connect:null,disconnect:null,integrateVelocities:function(){throw"The integrator.integrateVelocities() method must be overriden"},integratePositions:function(){throw"The integrator.integratePositions() method must be overriden"}})}(),function(){var s={meta:!1,metaRefresh:200,width:600,height:600,autoResize:!0};i.renderer=n("renderer",{init:function(n){var r=this,o="string"==typeof n.el?e.getElementById(n.el):n.el;this.options=i.util.options(s),this.options(n),this.el=o?o:e.body,this.container=o&&o.parentNode?o.parentNode:e.body,this.drawMeta=i.util.throttle(i.util.bind(this.drawMeta,this),this.options.metaRefresh),t.addEventListener("resize",i.util.throttle(function(){r.options.autoResize&&r.resize()}),100)},resize:function(t,e){void 0===t&&void 0===e&&(t=this.container.offsetWidth,e=this.container.offsetHeight),this.width=t||0,this.height=e||0},setWorld:function(t){return this.disconnect&&this._world&&this.disconnect(this._world),this._world=t,this.connect&&t&&this.connect(t),this},render:function(t,e){var i,n;this.beforeRender&&this.beforeRender(),this._world.emit("beforeRender",{renderer:this,bodies:t,meta:e}),this.options.meta&&this.drawMeta(e),this._interpolateTime=e.interpolateTime;for(var s=0,r=t.length;r>s;++s)i=t[s],n=i.view||(i.view=this.createView(i.geometry,i.styles)),i.hidden||this.drawBody(i,n);return this},createView:function(){throw"You must override the renderer.createView() method."},drawMeta:function(){throw"You must override the renderer.drawMeta() method."},drawBody:function(){throw"You must override the renderer.drawBody() method."}})}(),function(){var t=function s(t,e,i){for(var n,r,o=function(){return s(t,e,i)};n=t.shift();)if(r=n.apply(e,i),r&&r.then)return r.then(o)},e={timestep:6,maxIPF:4,webworker:!1,integrator:"verlet",sleepDisabled:!1,sleepSpeedLimit:.05,sleepVarianceLimit:.02,sleepTimeLimit:500},n=function r(t,e){return this instanceof r?void this.init(t,e):new r(t,e)};n.prototype=i.util.extend({},i.util.pubsub.prototype,{init:function(n,s){var r=this;(i.util.isFunction(n)||i.util.isArray(n))&&(s=n,n={}),this._meta={fps:0,ipf:0},this._bodies=[],this._behaviors=[],this._integrator=null,this._renderer=null,this._paused=!1,this._warp=1,this._time=0,this.options=i.util.options(e),this.options.onChange(function(t){r.timestep(t.timestep)}),this.options(n),this.add(i.integrator(this.options.integrator)),i.util.isFunction(s)?t([s],this,[this,i]):i.util.isArray(s)&&t(s,this,[this,i])},options:null,add:function(t){var e=0,n=t&&t.length||0,s=i.util.isArray(t)?t[0]:t;if(!s)return this;do switch(s.type){case"behavior":this.addBehavior(s);break;case"integrator":this.integrator(s);break;case"renderer":this.renderer(s);break;case"body":this.addBody(s);break;default:throw'Error: failed to add item of unknown type "'+s.type+'" to world'}while(++e<n&&(s=t[e]));return this},remove:function(t){var e=0,n=t&&t.length||0,s=i.util.isArray(t)?t[0]:t;if(!s)return this;do switch(s.type){case"behavior":this.removeBehavior(s);break;case"integrator":s===this._integrator&&this.integrator(null);break;case"renderer":s===this._renderer&&this.renderer(null);break;case"body":this.removeBody(s);break;default:throw'Error: failed to remove item of unknown type "'+s.type+'" from world'}while(++e<n&&(s=t[e]));return this},has:function(t){var e;if(!t)return!1;switch(t.type){case"behavior":e=this._behaviors;break;case"integrator":return this._integrator===t;case"renderer":return this._renderer===t;case"body":e=this._bodies;break;default:throw'Error: unknown type "'+t.type+'"'}return i.util.indexOf(e,t)>-1},integrator:function(t){return void 0===t?this._integrator:this._integrator===t?this:(this._integrator&&(this._integrator.setWorld(null),this.emit("remove:integrator",{integrator:this._integrator})),t&&(this._integrator=t,this._integrator.setWorld(this),this.emit("add:integrator",{integrator:this._integrator})),this)},renderer:function(t){return void 0===t?this._renderer:this._renderer===t?this:(this._renderer&&(this._renderer.setWorld(null),this.emit("remove:renderer",{renderer:this._renderer})),t&&(this._renderer=t,this._renderer.setWorld(this),this.emit("add:renderer",{renderer:this._renderer})),this)},timestep:function(t){return t?(this._dt=+t.toPrecision(4),this._maxJump=t*this.options.maxIPF,this):this._dt},wakeUpAll:function(){var t=0,e=this._bodies.length;for(t=0;e>t;t++)this._bodies[t].sleep(!1)},addBehavior:function(t){return this.has(t)?this:(t.setWorld(this),this._behaviors.push(t),this.emit("add:behavior",{behavior:t}),this)},getBehaviors:function(){return[].concat(this._behaviors)},removeBehavior:function(t){var e=this._behaviors;if(t)for(var i=0,n=e.length;n>i;++i)if(t===e[i]){e.splice(i,1),t.setWorld(null),this.emit("remove:behavior",{behavior:t});break}return this},addBody:function(t){return this.has(t)?this:(t.setWorld(this),this._bodies.push(t),this.emit("add:body",{body:t}),this)},getBodies:function(){return[].concat(this._bodies)},removeBody:function(t){var e=this._bodies;if(t)for(var i=0,n=e.length;n>i;++i)if(t===e[i]){e.splice(i,1),t.setWorld(null),this.emit("remove:body",{body:t});break}return this},findOne:function(t){var e=this,n="function"==typeof t?t:i.query(t);return i.util.find(e._bodies,n)||!1},find:function(t){var e=this,n="function"==typeof t?t:i.query(t);return i.util.filter(e._bodies,n)},iterate:function(t){this._integrator.integrate(this._bodies,t)},step:function(t){var e,n,s,r=this._time,o=this._warp,a=1/o,h=this._dt,l=h*a,c=this._maxJump*a,u=this._meta;if(this._paused||void 0===this._animTime)return this._animTime=t||this._animTime||i.util.ticker.now(),this._paused||this.emit("step",u),this;if(t=t||this._animTime+l,e=t-this._animTime,e>c&&(this._animTime=t-c,e=c),n=e*o,s=r+n-h,this.emit("beforeStep"),s>=r)for(;s>=r;)r+=h,this._animTime+=l,this._time=r,this.iterate(h);return u.fps=1e3/(t-this._lastTime),u.ipf=(n/h).toFixed(2),u.interpolateTime=h+s-r,this._lastTime=t,this.emit("step",u),this},warp:function(t){return void 0===t?this._warp:(this._warp=t||1,this)},render:function(){if(!this._renderer)throw"No renderer added to world";return this._renderer.render(this._bodies,this._meta),this.emit("render",{bodies:this._bodies,meta:this._meta,renderer:this._renderer}),this},pause:function(){return this._paused=!0,this.emit("pause"),this},unpause:function(){return this._paused=!1,this.emit("unpause"),this},isPaused:function(){return!!this._paused},destroy:function(){var t=this;t.pause(),this.emit("destroy"),t.off(!0),t.remove(t.getBodies()),t.remove(t.getBehaviors()),t.integrator(null),t.renderer(null)}}),i.world=n}(),i.integrator("verlet",function(t){return i.body.mixin({started:function(t){return void 0!==t&&(this._started=!0),!!this._started}}),{init:function(e){t.init.call(this,e)},integrateVelocities:function(t,e){for(var i,n=e*e,s=1-this.options.drag,r=null,o=this.prevDt||e,a=.5*(n+e*o),h=0,l=t.length;l>h;++h)r=t[h],i=r.state,"static"===r.treatment||r.sleep(e)?(i.vel.zero(),i.acc.zero(),i.angular.vel=0,i.angular.acc=0):(i.vel.equals(i.old.vel)&&r.started()?i.vel.clone(i.pos).vsub(i.old.pos):(i.old.pos.clone(i.pos).vsub(i.vel),i.vel.mult(e)),s&&i.vel.mult(s),i.vel.vadd(i.acc.mult(a)),i.vel.mult(1/e),i.old.vel.clone(i.vel),i.acc.zero(),i.angular.vel===i.old.angular.vel&&r.started()?i.angular.vel=i.angular.pos-i.old.angular.pos:(i.old.angular.pos=i.angular.pos-i.angular.vel,i.angular.vel*=e),i.angular.vel+=i.angular.acc*a,i.angular.vel/=e,i.old.angular.vel=i.angular.vel,i.angular.acc=0,r.started(!0))},integratePositions:function(t,e){for(var i,n=null,s=this.prevDt||e,r=e/s,o=0,a=t.length;a>o;++o)n=t[o],i=n.state,"static"===n.treatment||n.sleep()||(i.vel.mult(e*r),i.old.pos.clone(i.pos),i.pos.vadd(i.vel),i.vel.mult(1/(e*r)),i.old.vel.clone(i.vel),i.angular.vel*=e*r,i.old.angular.pos=i.angular.pos,i.angular.pos+=i.angular.vel,i.angular.vel/=e*r,i.old.angular.vel=i.angular.vel);this.prevDt=e}}}),i.geometry("point",function(){}),i.body("point",function(t){return{init:function(e){t.init.call(this,e),this.moi=0}}}),i.geometry("circle",function(t){var e={radius:1};return{init:function(n){t.init.call(this,n),this.options.defaults(e),this.options.onChange(function(t){this.radius=t.radius}),this.options(n),this._aabb=i.aabb(),this.radius=this.options.radius},aabb:function(){var t=this.radius;return this._aabb.hw!==t&&(this._aabb=i.aabb(-t,-t,t,t)),i.aabb.clone(this._aabb)},getFarthestHullPoint:function(t,e){return e=e||new i.vector,e.clone(t).normalize().mult(this.radius)},getFarthestCorePoint:function(t,e,n){return e=e||new i.vector,e.clone(t).normalize().mult(this.radius-n)}}}),i.geometry("compound",function(t){var e={};return{init:function(i){t.init.call(this,i),this.options.defaults(e),this.options(i),this.children=[]},addChild:function(t,e,n){return this._aabb=null,this.children.push({g:t,pos:new i.vector(e),angle:n}),this},clear:function(){return this._aabb=null,this.children=[],this},aabb:function(t){if(!t&&this._aabb)return i.aabb.clone(this._aabb);var e,n,s,r=i.scratchpad(),o=i.vector();t=t||0;for(var a=0,h=this.children.length;h>a;a++)n=this.children[a],e=n.g.aabb(t+n.angle),o.clone(n.pos),t&&o.rotate(t),e.x+=o._[0],e.y+=o._[1],s=s?i.aabb.union(s,e,!0):e;return t||(this._aabb=i.aabb.clone(s)),r.done(s)},getFarthestHullPoint:function(t,e){
var n,s,r=this.children.length,o=i.scratchpad(),a=o.vector(),h=0,l=0;for(e=e||new i.vector,s=0;r>s;s++)n=this.children[s],n.g.getFarthestHullPoint(t.rotate(-n.angle),a),h=a.rotate(n.angle).vadd(n.pos).proj(t.rotate(n.angle)),h>l&&(l=h,e.swap(a));return o.done(e)},getFarthestCorePoint:function(t,e,n){var s,r,o=this.children.length,a=i.scratchpad(),h=a.vector(),l=0,c=0;for(e=e||new i.vector,r=0;o>r;r++)s=this.children[r],s.g.getFarthestCorePoint(t.rotate(-s.angle),h,n),l=h.rotate(s.angle).vadd(s.pos).proj(t.rotate(s.angle)),l>c&&(c=l,e.swap(h));return a.done(e)}}}),i.geometry("convex-polygon",function(t){var e="Error: The vertices specified do not match that of a _convex_ polygon.",n={};return{init:function(e){var i=this;t.init.call(this,e),this.options.defaults(n),this.options.onChange(function(t){i.setVertices(t.vertices||[])}),this.options(e),i.setVertices(this.options.vertices||[])},setVertices:function(t){var n=i.scratchpad(),s=n.transform(),r=this.vertices=[];if(!i.geometry.isPolygonConvex(t))throw e;s.setRotation(0),s.setTranslation(i.geometry.getPolygonCentroid(t).negate());for(var o=0,a=t.length;a>o;++o)r.push(new i.vector(t[o]).translate(s));return this._area=i.geometry.getPolygonArea(r),this._aabb=!1,n.done(this)},aabb:function(t){if(!t&&this._aabb)return i.aabb.clone(this._aabb);var e,n=i.scratchpad(),s=n.vector(),r=n.transform().setRotation(t||0),o=n.vector().set(1,0).rotateInv(r),a=n.vector().set(0,1).rotateInv(r),h=this.getFarthestHullPoint(o,s).proj(o),l=-this.getFarthestHullPoint(o.negate(),s).proj(o),c=this.getFarthestHullPoint(a,s).proj(a),u=-this.getFarthestHullPoint(a.negate(),s).proj(a);return e=i.aabb(l,u,h,c),t||(this._aabb=i.aabb.clone(e)),n.done(),e},getFarthestHullPoint:function(t,e,n){var s,r,o,a=this.vertices,h=a.length,l=2;if(e=e||new i.vector,2>h)return n&&(n.idx=0),e.clone(a[0]);if(r=a[0].dot(t),s=a[1].dot(t),2===h)return o=s>=r?1:0,n&&(n.idx=o),e.clone(a[o]);if(s>=r){for(;h>l&&s>=r;)r=s,s=a[l].dot(t),l++;return s>=r&&l++,o=l-2,n&&(n.idx=l-2),e.clone(a[o])}for(l=h;l>1&&r>=s;)l--,s=r,r=a[l].dot(t);return o=(l+1)%h,n&&(n.idx=o),e.clone(a[o])},getFarthestCorePoint:function(t,e,n){var s,r=i.scratchpad(),o=r.vector(),a=r.vector(),h=this.vertices,l=h.length,c=this._area>0,u={};return e=this.getFarthestHullPoint(t,e,u),o.clone(h[(u.idx+1)%l]).vsub(e).normalize().perp(c),a.clone(h[(u.idx-1+l)%l]).vsub(e).normalize().perp(!c),s=n/(1+o.dot(a)),e.vadd(o.vadd(a).mult(s)),r.done(),e}}}),i.geometry("rectangle",function(t){var e={};return{init:function(i){var n=this;t.init.call(this,i),this.options.defaults(e),this.options.onChange(function(){n.width=n.options.width||1,n.height=n.options.height||1}),this.options(i)},aabb:function(t){if(!t)return i.aabb(this.width,this.height);var e=i.scratchpad(),n=e.vector(),s=e.transform().setRotation(t||0),r=e.vector().set(1,0).rotateInv(s),o=e.vector().set(0,1).rotateInv(s),a=this.getFarthestHullPoint(r,n).proj(r),h=-this.getFarthestHullPoint(r.negate(),n).proj(r),l=this.getFarthestHullPoint(o,n).proj(o),c=-this.getFarthestHullPoint(o.negate(),n).proj(o);return e.done(),i.aabb(h,c,a,l)},getFarthestHullPoint:function(t,e){e=e||new i.vector;var n=t.x,s=t.y;return n=0===n?0:0>n?.5*-this.width:.5*this.width,s=0===s?0:0>s?.5*-this.height:.5*this.height,e.set(n,s)},getFarthestCorePoint:function(t,e,i){var n,s;return e=this.getFarthestHullPoint(t,e),n=e.x,s=e.y,e.x=0===n?0:0>n?n+i:n-i,e.y=0===s?0:0>s?s+i:s-i,e}}}),i.body("circle",function(t){var e={radius:1};return{init:function(n){t.init.call(this,n),n=i.util.extend({},e,n),this.geometry=i.geometry("circle",{radius:n.radius}),this.recalc()},recalc:function(){t.recalc.call(this),this.moi=this.mass*this.geometry.radius*this.geometry.radius/2}}}),i.body("compound",function(t){return{init:function(e){t.init.call(this,e),this.mass=0,this.moi=0,this.children=[],this.geometry=i.geometry("compound"),this.addChildren(e.children)},connect:function(){if(this.mass<=0)throw"Can not add empty compound body to world."},addChild:function(t){return this.addChildren([t]),this},addChildren:function(t){var e,n,s,r=this,o=i.scratchpad(),a=o.vector().zero(),h=t&&t.length,l=0;if(!h)return o.done(this);for(s=0;h>s;s++)e=t[s],e._world&&e._world.remove(e),this.children.push(e),this.geometry.addChild(e.geometry,new i.vector(e.offset).rotate(e.state.angular.pos).vadd(e.state.pos),e.state.angular.pos),n=e.state.pos,a.add(n._[0]*e.mass,n._[1]*e.mass),l+=e.mass;return this.mass+=l,a.mult(1/this.mass),this.offset.vsub(a),this._world&&this._world.one("render",function(){r.view=null}),this.recalc(),o.done(this)},clear:function(){return this._aabb=null,this.moi=0,this.mass=0,this.offset.zero(),this.children=[],this.geometry.clear(),this},refreshGeometry:function(){this.geometry.clear();for(var t,e=0,n=this.children.length;n>e;e++)t=this.children[e],this.geometry.addChild(t.geometry,new i.vector(t.state.pos).vadd(t.offset),t.state.angular.pos);return this},recalc:function(){t.recalc.call(this);for(var e,i=0,n=0,s=this.children.length;s>n;n++)e=this.children[n],e.recalc(),i+=e.moi+e.mass*e.state.pos.normSq();return this.moi=i,this}}}),i.body("convex-polygon",function(t){var e={};return{init:function(n){t.init.call(this,n),n=i.util.extend({},e,n),this.geometry=i.geometry("convex-polygon",{vertices:n.vertices}),this.recalc()},recalc:function(){t.recalc.call(this),this.moi=i.geometry.getPolygonMOI(this.geometry.vertices)}}}),i.body("rectangle",function(t){var e={};return{init:function(n){t.init.call(this,n),n=i.util.extend({},e,n),this.geometry=i.geometry("rectangle",{width:n.width,height:n.height}),this.recalc()},recalc:function(){var e=this.geometry.width,i=this.geometry.height;t.recalc.call(this),this.moi=(e*e+i*i)*this.mass/12}}}),i.behavior("attractor",function(t){var e={pos:null,strength:1,order:2,max:!1,min:!1};return{init:function(n){var s=this;this._pos=new i.vector,t.init.call(this),this.options.defaults(e),this.options.onChange(function(t){s._maxDist=t.max===!1?1/0:t.max,s._minDist=t.min?t.min:10,s.position(t.pos)}),this.options(n)},position:function(t){var e=this;return t?(this._pos.clone(t),e):this._pos.values()},behave:function(){for(var t,e,n,s=this.getTargets(),r=this.options.order,o=this.options.strength,a=this._minDist,h=this._maxDist,l=i.scratchpad(),c=l.vector(),u=0,d=s.length;d>u;u++)t=s[u],c.clone(this._pos),c.vsub(t.state.pos),e=c.norm(),e>a&&h>e&&(n=o/Math.pow(e,r),t.accelerate(c.normalize().mult(n)));l.done()}}}),i.behavior("body-collision-detection",function(t){var e=[],n=function(t,n){var s=i.util.pairHash(t.uid,n.uid),r=e[s];return r||(r=e[s]=function(e){var i=r.tA,s=r.tB,o=r.tmpv1,a=r.tmpv2;return r.useCore?(o=t.geometry.getFarthestCorePoint(e.rotateInv(i),o,r.marginA),a=n.geometry.getFarthestCorePoint(e.rotate(i).rotateInv(s).negate(),a,r.marginB)):(o=t.geometry.getFarthestHullPoint(e.rotateInv(i),o),a=n.geometry.getFarthestHullPoint(e.rotate(i).rotateInv(s).negate(),a)),o.vadd(t.offset).transform(i),a.vadd(n.offset).transform(s),e.negate().rotate(s),{a:o.values(),b:a.values(),pt:o.vsub(a).values()}},r.tA=new i.transform,r.tB=new i.transform,r.tmpv1=new i.vector,r.tmpv2=new i.vector),r.useCore=!1,r.margin=0,r.tA.setRotation(t.state.angular.pos).setTranslation(t.state.pos),r.tB.setRotation(n.state.angular.pos).setTranslation(n.state.pos),r.bodyA=t,r.bodyB=n,r},s=function(t,e){var s,r,o,a,h=i.scratchpad(),l=h.vector(),c=h.vector(),u=h.vector(),d=!1,p=t.aabb(),f=Math.min(p.hw,p.hh),v=e.aabb(),m=Math.min(v.hw,v.hh);if(o=n(t,e),l.clone(t.state.pos).vadd(t.getGlobalOffset(u)).vsub(e.state.pos).vsub(e.getGlobalOffset(u)),r=i.gjk(o,l,!0),r.overlap){for(d={bodyA:t,bodyB:e},a=.01*Math.min(f||1,m||1),o.useCore=!0,o.marginA=0,o.marginB=0;(r.overlap||0===r.distance)&&(o.marginA<f||o.marginB<m);)o.marginA<f&&(o.marginA+=a),o.marginB<m&&(o.marginB+=a),r=i.gjk(o,l);if(r.overlap||r.maxIterationsReached)return h.done(!1);if(s=o.marginA+o.marginB-r.distance,0>=s)return h.done(!1);d.overlap=s,d.norm=l.clone(r.closest.b).vsub(c.clone(r.closest.a)).normalize().values(),d.mtv=l.mult(s).values(),d.pos=l.clone(d.norm).mult(o.marginA).vadd(c.clone(r.closest.a)).vsub(t.state.pos).values()}return h.done(d)},r=function(t,e){var n,s=i.scratchpad(),r=s.vector(),o=s.vector(),a=!1;return r.clone(e.state.pos).vadd(e.getGlobalOffset(o)).vsub(t.state.pos).vsub(t.getGlobalOffset(o)),n=r.norm()-(t.geometry.radius+e.geometry.radius),r.equals(i.vector.zero)&&r.set(1,0),0>=n&&(a={bodyA:t,bodyB:e,norm:r.normalize().values(),mtv:r.mult(-n).values(),pos:r.mult(-t.geometry.radius/n).vadd(o).values(),overlap:-n}),s.done(a)},o=function h(t,e){if(!("static"!==t.treatment&&"kinematic"!==t.treatment||"static"!==e.treatment&&"kinematic"!==e.treatment))return!1;if("circle"===t.geometry.name&&"circle"===e.geometry.name)return r(t,e);if("compound"===t.geometry.name||"compound"===e.geometry.name){var n,o,a,l,c="compound"===t.geometry.name,u=c?t:e,d=c?e:t,p=[],f=i.scratchpad(),v=(f.vector(),f.vector()),m=d.aabb();for(a=0,l=u.children.length;l>a;a++){if(o=u.children[a],v.clone(o.state.pos),o.offset.vadd(v.vadd(u.offset).rotate(-o.state.angular.pos)),o.state.pos.clone(u.state.pos),o.state.angular.pos+=u.state.angular.pos,i.aabb.overlap(m,o.aabb()))if(n=h(d,o),n instanceof Array)for(var g,y=0,_=n.length;_>y;y++)g=n[y],g.bodyA===o?g.bodyA=u:g.bodyB=u,p.push(g);else n&&(n.bodyA===o?n.bodyA=u:n.bodyB=u,p.push(n));o.state.angular.pos-=u.state.angular.pos,o.offset.vsub(v),o.state.pos.clone(v.rotate(o.state.angular.pos).vsub(u.offset))}return f.done(p)}return s(t,e)},a={check:"collisions:candidates",channel:"collisions:detected"};return{init:function(e){t.init.call(this),this.options.defaults(a),this.options(e)},connect:function(t){this.options.check===!0?t.on("integrate:velocities",this.checkAll,this):t.on(this.options.check,this.check,this)},disconnect:function(t){this.options.check===!0?t.off("integrate:velocities",this.checkAll,this):t.off(this.options.check,this.check,this)},check:function(t){for(var e,n,s,r=t.candidates,a=this.getTargets(),h=[],l=this.prevContacts||{},c={},u=i.util.pairHash,d=0,p=r.length;p>d;++d)if(e=r[d],a===this._world._bodies||i.util.indexOf(a,e.bodyA)>-1&&i.util.indexOf(a,e.bodyB)>-1)if(n=o(e.bodyA,e.bodyB),n instanceof Array)for(var f,v=0,m=n.length;m>v;v++)f=n[v],f&&(s=u(e.bodyA.uid,e.bodyB.uid),c[s]=!0,f.collidedPreviously=l[s],h.push(f));else n&&(s=u(e.bodyA.uid,e.bodyB.uid),c[s]=!0,n.collidedPreviously=l[s],h.push(n));this.prevContacts=c,h.length&&this._world.emit(this.options.channel,{collisions:h})},checkAll:function(t){for(var e,n,s,r,a=this.getTargets(),h=(t.dt,[]),l=this.prevContacts||{},c={},u=i.util.pairHash,d=0,p=a.length;p>d;d++){e=a[d];for(var f=d+1;p>f;f++)if(n=a[f],s=o(e,n),s instanceof Array)for(var v,m=0,g=s.length;g>m;m++)v=s[m],v&&(r=u(e.uid,n.uid),c[r]=!0,v.collidedPreviously=l[r],h.push(v));else s&&(r=u(e.uid,n.uid),c[r]=!0,s.collidedPreviously=l[r],h.push(s))}this.prevContacts=c,h.length&&this._world.emit(this.options.channel,{collisions:h})}}}),i.behavior("body-impulse-response",function(t){function e(t){return t.uid}function n(t,e,i){var n,s;return s=e.norm(),n=s-t.proj(e),n=Math.max(0,Math.min(s,n)),0===s?i.zero():i.clone(e).mult(n/s),i}var s={check:"collisions:detected",mtvThreshold:1,bodyExtractDropoff:.5,forceWakeupAboveOverlapThreshold:!0};return{init:function(e){t.init.call(this),this.options.defaults(s),this.options(e),this._bodyList=[]},applyTo:!1,connect:function(t){t.on(this.options.check,this.respond,this)},disconnect:function(t){t.off(this.options.check,this.respond,this)},collideBodies:function(t,e,s,r,o,a){var h="static"===t.treatment||"kinematic"===t.treatment,l="static"===e.treatment||"kinematic"===e.treatment,c=i.scratchpad(),u=c.vector().clone(o);if(h&&l)return void c.done();var d,p,f,v,m=h?0:1/t.moi,g=l?0:1/e.moi,y=h?0:1/t.mass,_=l?0:1/e.mass,b=t.restitution*e.restitution,w=t.cof*e.cof,x=c.vector().clone(s),P=c.vector().clone(x).perp(),S=c.vector(),C=c.vector().clone(r),T=c.vector().clone(r).vadd(t.state.pos).vsub(e.state.pos),E=t.state.angular.vel,k=e.state.angular.vel,j=c.vector().clone(e.state.vel).vadd(S.clone(T).perp().mult(k)).vsub(t.state.vel).vsub(S.clone(C).perp().mult(E)),I=C.proj(x),A=C.proj(P),M=T.proj(x),B=T.proj(P),D=j.proj(x),O=j.proj(P);return a&&(h?(n(e._mtvTotal,u,S),e._mtvTotal.vadd(S)):l?(n(t._mtvTotal,u.negate(),S),t._mtvTotal.vadd(S),u.negate()):(v=.5,u.mult(v),n(e._mtvTotal,u,S),e._mtvTotal.vadd(S),u.clone(o).mult(v-1),n(t._mtvTotal,u,S),t._mtvTotal.vadd(S))),D>=0?void c.done():(m=1/0===m?0:m,g=1/0===g?0:g,d=-((1+b)*D)/(y+_+m*A*A+g*B*B),h?(e.state.vel.vadd(x.mult(d*_)),e.state.angular.vel-=d*g*B):l?(t.state.vel.vsub(x.mult(d*y)),t.state.angular.vel+=d*m*A):(e.state.vel.vadd(x.mult(d*_)),e.state.angular.vel-=d*g*B,t.state.vel.vsub(x.mult(y*e.mass)),t.state.angular.vel+=d*m*A),w&&O&&(f=Math.abs(O)/(y+_+m*I*I+g*M*M),p=0>O?-1:1,d=w*Math.abs(d),d=Math.min(d,f),d*=p,h?(e.state.vel.vsub(P.mult(d*_)),e.state.angular.vel-=d*g*M):l?(t.state.vel.vadd(P.mult(d*y)),t.state.angular.vel+=d*m*I):(e.state.vel.vsub(P.mult(d*_)),e.state.angular.vel-=d*g*M,t.state.vel.vadd(P.mult(y*e.mass)),t.state.angular.vel+=d*m*I)),t.sleep()&&t.sleepCheck(),e.sleep()&&e.sleepCheck(),void c.done())},_pushUniq:function(t){var n=i.util.sortedIndex(this._bodyList,t,e);this._bodyList[n]!==t&&this._bodyList.splice(n,0,t)},respond:function(t){var e,n,s,r,o=this,a=t.collisions;for(n=0,s=a.length;s>n;++n)e=a[n],this._pushUniq(e.bodyA),this._pushUniq(e.bodyB),e.bodyA._mtvTotal=e.bodyA._mtvTotal||new i.vector,e.bodyB._mtvTotal=e.bodyB._mtvTotal||new i.vector,e.bodyA._oldmtvTotal=e.bodyA._oldmtvTotal||new i.vector,e.bodyB._oldmtvTotal=e.bodyB._oldmtvTotal||new i.vector,o.collideBodies(e.bodyA,e.bodyB,e.norm,e.pos,e.mtv,e.collidedPreviously);for(n=0,s=this._bodyList.length;s>n;++n)r=this._bodyList.pop(),r._mtvTotal.normSq()<this.options.mtvThreshold?r._mtvTotal.mult(this.options.bodyExtractDropoff):this.options.forceWakeupAboveOverlapThreshold&&r.sleep(!1),r.state.pos.vadd(r._mtvTotal),r.state.old.pos.vadd(r._mtvTotal),r._oldmtvTotal.swap(r._mtvTotal),r._mtvTotal.zero()}}}),i.behavior("constant-acceleration",function(t){var e={acc:{x:0,y:4e-4}};return{init:function(n){t.init.call(this),this.options.defaults(e),this.options(n),this._acc=new i.vector,this.setAcceleration(this.options.acc),delete this.options.acc},setAcceleration:function(t){return this._acc.clone(t),this},behave:function(){for(var t=this.getTargets(),e=0,i=t.length;i>e;++e)t[e].accelerate(this._acc)}}}),i.behavior("edge-collision-detection",function(t){var e=function(t,e,n){var s,r=t.aabb(),o=i.scratchpad(),a=t.getGlobalOffset(o.vector()),h=o.transform(),l=o.vector(),c=o.vector(),u=!1,d=[];return s=r.x+r.hw-e.max.x,s>=0&&(l.set(1,0).rotateInv(h.setRotation(t.state.angular.pos)),u={bodyA:t,bodyB:n,overlap:s,norm:{x:1,y:0},mtv:{x:s,y:0},pos:t.geometry.getFarthestHullPoint(l,c).rotate(h).vadd(a).values()},d.push(u)),s=r.y+r.hh-e.max.y,s>=0&&(l.set(0,1).rotateInv(h.setRotation(t.state.angular.pos)),u={bodyA:t,bodyB:n,overlap:s,norm:{x:0,y:1},mtv:{x:0,y:s},pos:t.geometry.getFarthestHullPoint(l,c).rotate(h).vadd(a).values()},d.push(u)),s=e.min.x-(r.x-r.hw),s>=0&&(l.set(-1,0).rotateInv(h.setRotation(t.state.angular.pos)),u={bodyA:t,bodyB:n,overlap:s,norm:{x:-1,y:0},mtv:{x:-s,y:0},pos:t.geometry.getFarthestHullPoint(l,c).rotate(h).vadd(a).values()},d.push(u)),s=e.min.y-(r.y-r.hh),s>=0&&(l.set(0,-1).rotateInv(h.setRotation(t.state.angular.pos)),u={bodyA:t,bodyB:n,overlap:s,norm:{x:0,y:-1},mtv:{x:0,y:-s},pos:t.geometry.getFarthestHullPoint(l,c).rotate(h).vadd(a).values()},d.push(u)),o.done(),d},n=function(t,i,n){return e(t,i,n)},s={aabb:null,restitution:.99,cof:1,channel:"collisions:detected"};return{init:function(e){t.init.call(this),this.options.defaults(s),this.options(e),this.setAABB(this.options.aabb),this.restitution=this.options.restitution,this.body=i.body("point",{treatment:"static",restitution:this.options.restitution,cof:this.options.cof})},setAABB:function(t){if(!t)throw"Error: aabb not set";return this._edges={min:{x:t.x-t.hw,y:t.y-t.hh},max:{x:t.x+t.hw,y:t.y+t.hh}},this},connect:function(t){t.on("integrate:positions",this.checkAll,this,2)},disconnect:function(t){t.off("integrate:positions",this.checkAll,this,2)},checkAll:function(t){for(var e,s,r,o=this.getTargets(),a=(t.dt,[]),h=this._edges,l=this.body,c=this.prevContacts||{},u={},d=i.util.pairHash,p=0,f=o.length;f>p;p++)if(e=o[p],"dynamic"===e.treatment&&(s=n(e,h,l))){r=d(e.uid,l.uid);for(var v=0,m=s.length;m>v;v++)u[r]=!0,s[v].collidedPreviously=c[r];a.push.apply(a,s)}this.prevContacts=u,a.length&&this._world.emit(this.options.channel,{collisions:a})}}}),i.behavior("interactive",function(n){if(!e)return{};var s={el:null,moveThrottle:10,minVel:{x:-5,y:-5},maxVel:{x:5,y:5}},r=function(t){var e=0,i=0;if(t.offsetParent)do e+=t.offsetLeft,i+=t.offsetTop;while(t=t.offsetParent);return{left:e,top:i}};return{init:function(t){var o=this;if(n.init.call(this),this.options.defaults(s),this.options(t),this.bodyData={},this.bodyDataByUID={},this.el="string"==typeof this.options.el?e.getElementById(this.options.el):this.options.el,!this.el)throw"No DOM element specified";o.grab=function(t){var e,n,s,a,h,l,c,u;if(o._world)for(t.changedTouches||(t.changedTouches=[t]),h=r(t.target),c=0,u=t.changedTouches.length;u>c;c++)a=t.changedTouches[c],s=a.identifier||a.pointerId||"mouse",e={idx:s,x:a.pageX-h.left,y:a.pageY-h.top},n=o._world.findOne({$at:new i.vector(e),$in:o.getTargets()}),n?(n.state.vel.zero(),n.state.angular.vel=0,n.isGrabbed=!0,l=o.bodyData[s]||{},l.body=n,n.sleep(!1),l.time=i.util.ticker.now(),l.treatment=o.bodyDataByUID[n.uid]?o.bodyDataByUID[n.uid].treatment:n.treatment,n.treatment="kinematic",l.pos=l.pos||new i.vector,l.pos.clone(e),l.offset=l.offset||new i.vector,l.offset.clone(e).vsub(n.state.pos),l.oldPos=l.oldPos||new i.vector,l.oldPos.clone(e),e.body=n,o.bodyData[s]=l,o.bodyDataByUID[n.uid]=l,o._world.emit("interact:grab",e)):o._world.emit("interact:poke",e)},o.move=i.util.throttle(function(t){var e,n,s,a,h,l,c,u;if(o._world)for(t.changedTouches||(t.changedTouches=[t]),h=r(o.el),c=0,u=t.changedTouches.length;u>c;c++)a=t.changedTouches[c],s=a.identifier||a.pointerId||"mouse",e={idx:s,x:a.pageX-h.left,y:a.pageY-h.top},l=o.bodyData[s],l&&(n=l.body,n.sleep(!1),l.time=i.util.ticker.now(),l.oldPos.clone(l.pos),l.pos.clone(e),e.body=n),o._world.emit("interact:move",e)},o.options.moveThrottle),o.release=function(t){var e,n,s,a,h,l,c,u,d;if(o._world)for(t.changedTouches||(t.changedTouches=[t]),u=0,d=t.changedTouches.length;d>u;u++)h=r(o.el),a=t.changedTouches[u],s=a.identifier||a.pointerId||"mouse",e={idx:s,x:a.pageX-h.left,y:a.pageY-h.top},l=o.bodyData[s],l&&(n=l.body,n.sleep(!1),l.pos.clone(e),c=Math.max(i.util.ticker.now()-l.time,o.options.moveThrottle),n.treatment=l.treatment,n.state.vel.clone(l.pos).vsub(l.oldPos).mult(1/c),n.state.vel.clamp(o.options.minVel,o.options.maxVel),n.isGrabbed=!1,e.body=n,delete n.isGrabbed),o._world.emit("interact:release",e),delete o.bodyData[s]}},connect:function(e){e.on("integrate:positions",this.behave,this),t.PointerEvent?(this.el.addEventListener("pointerdown",this.grab),t.addEventListener("pointermove",this.move),t.addEventListener("pointerup",this.release)):(this.el.addEventListener("mousedown",this.grab),this.el.addEventListener("touchstart",this.grab),t.addEventListener("mousemove",this.move),t.addEventListener("touchmove",this.move),t.addEventListener("mouseup",this.release),t.addEventListener("touchend",this.release))},disconnect:function(e){e.off("integrate:positions",this.behave,this),t.PointerEvent?(this.el.removeEventListener("pointerdown",this.grab),t.removeEventListener("pointermove",this.move),t.removeEventListener("pointerup",this.release)):(this.el.removeEventListener("mousedown",this.grab),this.el.removeEventListener("touchstart",this.grab),t.removeEventListener("mousemove",this.move),t.removeEventListener("touchmove",this.move),t.removeEventListener("mouseup",this.release),t.removeEventListener("touchend",this.release))},behave:function(t){var e,i,n,s=this,r=Math.max(t.dt,s.options.moveThrottle);for(var o in s.bodyData)n=s.bodyData[o],i=n.body,e=i.state,e.vel.clone(n.pos).vsub(n.offset).vsub(e.pos).mult(1/r)}}}),i.behavior("newtonian",function(t){var e={strength:1,max:!1,min:!1};return{init:function(i){var n=this;t.init.call(this),this.options.defaults(e),this.options.onChange(function(t){n._maxDistSq=t.max===!1?1/0:t.max*t.max,n._minDistSq=t.min?t.min*t.min:100*t.strength}),this.options(i)},calcPotential:function(t,e,n){var s,r,o,a=this.options.strength,h=this._minDistSq,l=this._maxDistSq;return o=n||new i.vector,o.clone(e).vsub(t),s=o.normSq(),s>h&&l>s?(r=a/s,o.normalize().mult(r)):o.zero()},behave:function(){var t,e,n,s,r,o,a,h,l,c,u,d,p=this.getTargets(),f=i.scratchpad(),v=f.vector(),m=f.vector(),g=f.vector();for(a=0,c=p.length;c>a;a++)for(t=p[a],o=a+1;c>o;o++){if(e=p[o],"compound"===t.name?n=t:"compound"===e.name&&(n=e,e=t),n)if("compound"===e.name)for(h=0,u=n.children.length;u>h;h++)for(s=n.children[h],n.toWorldCoords(m.clone(s.state.pos).vadd(n.offset)),l=0,d=e.children.length;d>l;l++)r=e.children[l],e.toWorldCoords(g.clone(r.state.pos).vadd(e.offset)),this.calcPotential(m,g,v),n.accelerate(v.mult(r.mass)),e.accelerate(v.mult(s.mass/r.mass).negate());else for(h=0,u=n.children.length;u>h;h++)s=n.children[h],n.toWorldCoords(m.clone(s.state.pos).vadd(n.offset)),this.calcPotential(m,e.state.pos,v),n.accelerate(v.mult(e.mass)),e.accelerate(v.mult(s.mass/e.mass).negate());else this.calcPotential(t.state.pos,e.state.pos,v),t.accelerate(v.mult(e.mass)),e.accelerate(v.mult(t.mass/e.mass).negate());n=null}f.done()}}}),i.behavior("sweep-prune",function(t){var e=1,n=function(){return e++},s={x:0,y:1},r=2,o=i.util.pairHash;return{init:function(e){t.init.call(this),this.options.defaults({channel:"collisions:candidates"}),this.options(e),this.encounters=[],this.candidates=[],this.clear()},clear:function(){this.tracked=[],this.pairs=[],this.intervalLists=[];for(var t=0;r>t;++t)this.intervalLists[t]=[]},connect:function(t){t.on("add:body",this.trackBody,this),t.on("remove:body",this.untrackBody,this),t.on("integrate:positions",this.sweep,this,1);for(var e=t.getBodies(),i=0,n=e.length;n>i;++i)this.trackBody({body:e[i]})},disconnect:function(t){t.off("add:body",this.trackBody,this),t.off("remove:body",this.untrackBody,this),t.off("integrate:positions",this.sweep,this,1),this.clear()},broadPhase:function(){return this.updateIntervals(),this.sortIntervalLists(),this._world&&this._world.emit("sweep-prune:intervals",this.intervalLists),this.checkOverlaps()},sortIntervalLists:function(){for(var t,e,i,n,s,o,a,h,l,c=0;r>c;++c)for(t=this.intervalLists[c],i=0,e=t.length,l=c;++i<e;){for(s=t[i],o=s.val.get(l),n=i,a=t[n-1],h=a&&a.val.get(l);n>0&&(h>o||h===o&&a.type&&!s.type);)t[n]=a,n--,a=t[n-1],h=a&&a.val.get(l);t[n]=s}},getPair:function(t,e,i){var n=o(t.id,e.id);if(n===!1)return null;var s=this.pairs[n];if(!s){if(!i)return null;s=this.pairs[n]={bodyA:t.body,bodyB:e.body,flag:1}}return i&&(s.flag=1),s},checkOverlaps:function(){var t,e,n,o,a,h,l,c,u,d=1<<s.z+1<<s.y+1<<s.x+1,p=this.encounters,f=0,v=this.candidates;i.util.clearArray(p),i.util.clearArray(v);for(var m=0;r>m;++m)for(t=0===m,a=this.intervalLists[m],l=0,h=a.length;h>l;l++)if(o=a[l],e=o.tracker,o.type)for(c=f,c=f-1;c>=0;c--)n=p[c],n===e?(f-1>c?p[c]=p.pop():p.pop(),f--):(u=this.getPair(e,n,t),u&&u.flag<d&&(u.flag=u.flag<<m+1,u.flag===d&&v.push(u)));else f=p.push(e);return v},updateIntervals:function(){for(var t,e,i,n=this.tracked,s=n.length;--s>=0;)t=n[s],e=t.interval,i=t.body.aabb(),e.min.val.clone(i).sub(i.hw,i.hh),e.max.val.clone(i).add(i.hw,i.hh)},trackBody:function(t){var e=t.body,s={id:n(),body:e},o={min:{type:!1,val:new i.vector,tracker:s},max:{type:!0,val:new i.vector,tracker:s}};s.interval=o,this.tracked.push(s);for(var a=0;r>a;++a)this.intervalLists[a].push(o.min,o.max)},untrackBody:function(t){for(var e,i,n,s,o=t.body,a=this.tracked,h=0,l=a.length;l>h;++h)if(n=a[h],n.body===o){a.splice(h,1);for(var c=0;r>c;++c){s=0,e=this.intervalLists[c];for(var u=0,d=e.length;d>u;++u)if(i=e[u],i===n.interval.min||i===n.interval.max){if(e.splice(u,1),u--,l--,s>0)break;s++}}break}},sweep:function(){var t,e=this;t=e.broadPhase(),t.length&&this._world.emit(this.options.channel,{candidates:t})}}}),i.behavior("verlet-constraints",function(t){var e=2*Math.PI,n={iterations:2};return{init:function(e){t.init.call(this),this.options.defaults(n),this.options(e),this._distanceConstraints=[],this._angleConstraints=[]},connect:function(t){var e=t.integrator();if(e&&e.name.indexOf("verlet")<0)throw'The rigid constraint manager needs a world with a "verlet" compatible integrator.';t.on("integrate:positions",this.resolve,this)},disconnect:function(t){t.off("integrate:positions",this.resolve,this)},drop:function(){return this._distanceConstraints=[],this._angleConstraints=[],this},distanceConstraint:function(t,e,n,s){var r;return t&&e?(r={id:i.util.uniqueId("dis-constraint"),type:"dis",bodyA:t,bodyB:e,stiffness:n||.5,targetLength:s||e.state.pos.dist(t.state.pos)},r.targetLengthSq=r.targetLength*r.targetLength,this._distanceConstraints.push(r),r):!1},angleConstraint:function(t,e,n,s,r){var o;return t&&e?(o={id:i.util.uniqueId("ang-constraint"),type:"ang",bodyA:t,bodyB:e,bodyC:n,stiffness:s||.5,targetAngle:r||e.state.pos.angle2(t.state.pos,n.state.pos)},this._angleConstraints.push(o),o):!1},remove:function(t){var e,n,s,r,o;if(s=i.util.isObject(t),n=s?t.type:t.substr(0,3),e="ang"===n?this._angleConstraints:this._distanceConstraints,s){for(r=0,o=e.length;o>r;++r)if(e[r]===t)return e.splice(r,1),this}else for(r=0,o=e.length;o>r;++r)if(e[r].id===t)return e.splice(r,1),this;return this},resolveAngleConstraints:function(t){for(var n,s,r,o,a=this._angleConstraints,h=i.scratchpad(),l=h.transform(),c=0,u=a.length;u>c;++c)n=a[c],s=n.bodyB.state.pos.angle2(n.bodyA.state.pos,n.bodyC.state.pos),r=s-n.targetAngle,r&&(r<=-Math.PI?r+=e:r>=Math.PI&&(r-=e),l.setTranslation(n.bodyB.state.pos),r*=-t*n.stiffness,"dynamic"===n.bodyA.treatment&&"dynamic"===n.bodyB.treatment&&"dynamic"===n.bodyC.treatment&&(o=1/(n.bodyA.mass+n.bodyB.mass+n.bodyC.mass)),"dynamic"===n.bodyA.treatment&&(s="dynamic"===n.bodyB.treatment&&"dynamic"===n.bodyC.treatment?r*(n.bodyB.mass+n.bodyC.mass)*o:"dynamic"!==n.bodyB.treatment?r*n.bodyC.mass/(n.bodyC.mass+n.bodyA.mass):r*n.bodyB.mass/(n.bodyB.mass+n.bodyA.mass),l.setRotation(s),n.bodyA.state.pos.translateInv(l),n.bodyA.state.pos.rotate(l),n.bodyA.state.pos.translate(l)),"dynamic"===n.bodyC.treatment&&(s="dynamic"===n.bodyA.treatment&&"dynamic"===n.bodyB.treatment?-r*(n.bodyB.mass+n.bodyA.mass)*o:"dynamic"!==n.bodyB.treatment?-r*n.bodyA.mass/(n.bodyC.mass+n.bodyA.mass):-r*n.bodyB.mass/(n.bodyB.mass+n.bodyC.mass),l.setRotation(s),n.bodyC.state.pos.translateInv(l),n.bodyC.state.pos.rotate(l),n.bodyC.state.pos.translate(l)),"dynamic"===n.bodyB.treatment&&(s="dynamic"===n.bodyA.treatment&&"dynamic"===n.bodyC.treatment?r*(n.bodyA.mass+n.bodyC.mass)*o:"dynamic"!==n.bodyA.treatment?r*n.bodyC.mass/(n.bodyC.mass+n.bodyB.mass):r*n.bodyA.mass/(n.bodyA.mass+n.bodyC.mass),l.setRotation(s).setTranslation(n.bodyA.state.pos),n.bodyB.state.pos.translateInv(l),n.bodyB.state.pos.rotate(l),n.bodyB.state.pos.translate(l),l.setTranslation(n.bodyC.state.pos),n.bodyB.state.pos.translateInv(l),n.bodyB.state.pos.rotateInv(l),n.bodyB.state.pos.translate(l)),n.bodyA.sleepCheck(),n.bodyB.sleepCheck(),n.bodyC.sleepCheck());h.done()},resolveDistanceConstraints:function(t){for(var e,n,s,r,o=this._distanceConstraints,a=i.scratchpad(),h=a.vector(),l=0,c=o.length;c>l;++l)e=o[l],h.clone(e.bodyB.state.pos).vsub(e.bodyA.state.pos),n=h.normSq()||1e-4*Math.random(),s=t*e.stiffness*(n-e.targetLengthSq)/n,h.mult(s),r="dynamic"!==e.bodyA.treatment||"dynamic"!==e.bodyB.treatment?1:e.bodyB.mass/(e.bodyA.mass+e.bodyB.mass),"dynamic"===e.bodyA.treatment&&("dynamic"===e.bodyB.treatment&&h.mult(r),e.bodyA.state.pos.vadd(h),"dynamic"===e.bodyB.treatment&&h.mult(1/r)),"dynamic"===e.bodyB.treatment&&("dynamic"===e.bodyA.treatment&&h.mult(1-r),e.bodyB.state.pos.vsub(h)),e.bodyA.sleepCheck(),e.bodyB.sleepCheck();a.done()},shuffleConstraints:function(){this._distanceConstraints=i.util.shuffle(this._distanceConstraints),this._angleConstraints=i.util.shuffle(this._angleConstraints)},resolve:function(){for(var t=this.options.iterations,e=1/t,i=0;t>i;i++)this.resolveDistanceConstraints(e),this.resolveAngleConstraints(e)},getConstraints:function(){return{distanceConstraints:[].concat(this._distanceConstraints),angleConstraints:[].concat(this._angleConstraints)}}}}),i.integrator("improved-euler",function(t){return{init:function(e){t.init.call(this,e)},integrateVelocities:function(t,e){for(var i,n=1-this.options.drag,s=null,r=0,o=t.length;o>r;++r)s=t[r],i=s.state,"static"===s.treatment||s.sleep(e)?(i.vel.zero(),i.acc.zero(),i.angular.vel=0,i.angular.acc=0):(i.old.vel.clone(i.vel),i.old.acc.clone(i.acc),i.vel.vadd(i.acc.mult(e)),n&&i.vel.mult(n),i.acc.zero(),i.old.angular.vel=i.angular.vel,i.angular.vel+=i.angular.acc*e,i.angular.acc=0)},integratePositions:function(t,e){for(var n,s=.5*e*e,r=null,o=i.scratchpad(),a=o.vector(),h=0,l=t.length;l>h;++h)r=t[h],n=r.state,"static"===r.treatment||r.sleep()||(n.old.pos.clone(n.pos),a.clone(n.old.vel),n.pos.vadd(a.mult(e)).vadd(n.old.acc.mult(s)),n.old.acc.zero(),n.old.angular.pos=n.angular.pos,n.angular.pos+=n.old.angular.vel*e+n.old.angular.acc*s,n.old.angular.acc=0);o.done()}}}),i.integrator("velocity-verlet-alt",function(t){return i.body.mixin({started:function(t){return void 0!==t&&(this._started=!0),!!this._started}}),{init:function(e){t.init.call(this,e)},integrateVelocities:function(t,e){for(var i,n=1-this.options.drag,s=null,r=0,o=t.length;o>r;++r)s=t[r],i=s.state,"static"!==s.treatment?(s.started()||(i.old.acc.clone(i.acc),i.old.acc.mult(e),i.old.vel.clone(i.vel).vsub(i.old.acc),i.old.acc.mult(1/e)),n&&i.vel.mult(n),i.vel.vadd(i.old.acc.vadd(i.acc).mult(.5*e)),s.started()||(i.old.angular.acc=i.angular.acc,i.old.angular.vel=i.angular.vel-i.old.angular.acc*e),i.angular.vel+=.5*(i.angular.acc+i.old.angular.acc)*e,i.angular.acc=0,s.started(!0)):(i.vel.zero(),i.acc.zero(),i.angular.vel=0,i.angular.acc=0)},integratePositions:function(t,e){for(var i,n=e*e,s=null,r=0,o=t.length;o>r;++r)s=t[r],i=s.state,"static"!==s.treatment&&(i.old.pos.clone(i.pos),i.old.vel.mult(e),i.old.acc.mult(.5*n),i.pos.vadd(i.old.vel).vadd(i.old.acc),i.old.vel.clone(i.vel),i.old.acc.clone(i.acc),i.acc.zero(),i.old.angular.pos=i.angular.pos,i.angular.pos+=i.angular.vel*e+.5*i.old.angular.acc*n,i.old.angular.vel=i.angular.vel,i.old.angular.acc=i.angular.acc,i.angular.acc=0)}}}),i.integrator("velocity-verlet",function(t){return i.body.mixin({started:function(t){return void 0!==t&&(this._started=!0),!!this._started}}),{init:function(e){t.init.call(this,e)},integrate:function(t,e){var i=this._world;return this.integratePositions(t,e),i&&i.emit("integrate:positions",{bodies:t,dt:e}),this.integrateVelocities(t,e),i&&i.emit("integrate:velocities",{bodies:t,dt:e}),this},integrateVelocities:function(t,e){for(var i,n=1-this.options.drag,s=null,r=0,o=t.length;o>r;++r)s=t[r],i=s.state,"static"===s.treatment||s.sleep()?(i.vel.zero(),i.acc.zero(),i.angular.vel=0,i.angular.acc=0):(n&&i.vel.mult(n),i.old.vel.clone(i.vel),i.vel.vadd(i.old.acc.vadd(i.acc).mult(.5*e)),i.old.acc.clone(i.acc),i.acc.zero(),i.old.angular.vel=i.angular.vel,i.old.angular.acc=i.angular.acc,i.angular.vel+=.5*(i.angular.acc+i.old.angular.acc)*e,i.angular.acc=0,s.started(!0))},integratePositions:function(t,e){for(var i,n=e*e,s=null,r=0,o=t.length;o>r;++r)s=t[r],i=s.state,"static"===s.treatment||s.sleep(e)||(s.started()||(i.old.acc.clone(i.acc),i.old.acc.mult(e),i.old.vel.clone(i.vel).vsub(i.old.acc),i.old.acc.mult(1/e)),i.old.pos.clone(i.pos),i.old.vel.mult(e),i.old.acc.mult(.5*n),i.pos.vadd(i.old.vel).vadd(i.old.acc),i.old.vel.mult(1/e),i.old.acc.mult(2/n),s.started()||(i.old.angular.acc=i.angular.acc,i.old.angular.vel=i.angular.vel-i.old.angular.acc*e),i.old.angular.pos=i.angular.pos,i.angular.pos+=i.angular.vel*e+.5*i.old.angular.acc*n);
}}}),i.renderer("canvas",function(t){if(!e)return{};var n=2*Math.PI,s=function(t,i){var n=e.createElement(t||"div");return i&&(n.innerHTML=i),n},r={white:"#fff",violet:"#542437",blue:"#53777A"},o={metaEl:null,styles:{point:r.blue,circle:{strokeStyle:r.blue,lineWidth:1,fillStyle:r.blue,angleIndicator:r.white},rectangle:{strokeStyle:r.violet,lineWidth:1,fillStyle:r.violet,angleIndicator:r.white},"convex-polygon":{strokeStyle:r.violet,lineWidth:1,fillStyle:r.violet,angleIndicator:r.white}},offset:{x:0,y:0}};return{init:function(n){var r=this;if(t.init.call(this,n),this.options.defaults(o,!0),this.options.onChange(function(){r.options.offset=new i.vector(r.options.offset)}),this.options(n,!0),this.hiddenCanvas=e.createElement("canvas"),this.hiddenCanvas.width=this.hiddenCanvas.height=100,!this.hiddenCanvas.getContext)throw"Canvas not supported";this.hiddenCtx=this.hiddenCanvas.getContext("2d");var a=this.el;if("CANVAS"!==a.nodeName.toUpperCase()&&(a=e.createElement("canvas"),this.el.appendChild(a),"string"==typeof this.options.el&&this.el===e.body&&(a.id=this.options.el),this.el=a),this.container=this.el.parentNode,this.ctx=a.getContext("2d"),this.els={},this.options.meta){var h=this.options.metaEl||s();h.className="pjs-meta",this.els.fps=s("span"),this.els.ipf=s("span"),h.appendChild(s("span","fps: ")),h.appendChild(this.els.fps),h.appendChild(s("br")),h.appendChild(s("span","ipf: ")),h.appendChild(this.els.ipf),a.parentNode.insertBefore(h,a)}this._layers={},this.addLayer("main",this.el),this.options.autoResize?this.resize():this.resize(this.options.width,this.options.height)},layer:function(t){return t in this._layers?this._layers[t]:null},addLayer:function(t,n,s){var r=this,o=[],a=i.util.extend({},this.options.styles),h={id:t,el:n||e.createElement("canvas"),options:i.util.options({width:this.el.width,height:this.el.height,manual:!1,autoResize:!0,follow:null,offset:null,scale:1,zIndex:1})(s)};if(t in this._layers)throw'Layer "'+t+'" already added.';return this.el.parentNode.insertBefore(h.el,this.el),h.el.style.position="absolute",h.el.style.zIndex=h.options.zIndex,h.el.className+=" pjs-layer-"+h.id,h.ctx=h.el.getContext("2d"),h.ctx.scale(1,1),h.el.width=h.options.width,h.el.height=h.options.height,h.bodies=o,h.reset=function(t){return o=t||[],h},h.addToStack=function(t){return i.util.isArray(t)?o.push.apply(o,t):o.push(t),h},h.removeFromStack=function(t){var e,n;if(i.util.isArray(t))for(e=0,n=t.length;n>e;++e)h.removeFromStack(t[e]);else e=i.util.indexOf(o,t),e>-1&&o.splice(e,1);return h},h.render=function(t){var e,n,s,l=i.scratchpad(),c=l.vector().set(0,0),u=h.options.scale,d=o.length,p=r._interpolateTime,f=d||"main"!==h.id?o:r._world._bodies;if(h.options.manual)return l.done(),h;for(h.options.offset&&("center"===h.options.offset?c.add(.5*h.el.width,.5*h.el.height).mult(1/u):c.vadd(h.options.offset).mult(1/u)),h.options.follow&&(c.vsub(h.options.follow.state.pos),c.sub(h.options.follow.state.vel.get(0)*p,h.options.follow.state.vel.get(1)*p)),t!==!1&&h.ctx.clearRect(0,0,h.el.width,h.el.height),1!==u&&(h.ctx.save(),h.ctx.scale(u,u)),s=0,d=f.length;d>s;++s)e=f[s],e.hidden||(n=e.view||(e.view=r.createView(e.geometry,e.styles||a[e.geometry.name])),r.drawBody(e,e.view,h.ctx,c));return 1!==u&&h.ctx.restore(),l.done(),h},this._layers[t]=h,h},removeLayer:function(t){var e=t.id?t.id:t,i=this._layers[e].el;return i!==this.el&&i.parentNode.removeChild(i),delete this._layers[e],this},resize:function(e,i){var n;t.resize.call(this,e,i);for(var s in this._layers)n=this._layers[s],n.options.autoResize&&(n.el.width=this.width,n.el.height=this.height);return this},setStyle:function(t,e){e=e||this.ctx,i.util.isObject(t)?(t.strokeStyle=t.lineWidth?t.strokeStyle:"rgba(0,0,0,0)",i.util.extend(e,t)):(e.fillStyle=e.strokeStyle=t,e.lineWidth=1)},drawCircle:function(t,e,i,s,r){r=r||this.ctx,r.beginPath(),this.setStyle(s,r),r.arc(t,e,i,0,n,!1),r.closePath(),r.stroke(),r.fill()},drawPolygon:function(t,e,i){var n=t[0],s=n.x,r=n.y,o=t.length;i=i||this.ctx,i.beginPath(),this.setStyle(e,i),i.moveTo(s,r);for(var a=1;o>a;++a)n=t[a],s=n.x,r=n.y,i.lineTo(s,r);o>2&&i.closePath(),i.stroke(),i.fill()},drawRect:function(t,e,i,n,s,r){var o=.5*i,a=.5*n;r=r||this.ctx,this.setStyle(s,r),r.beginPath(),r.rect(t-o,e-a,i,n),r.closePath(),r.stroke(),r.fill()},drawLine:function(t,e,i,n){var s=t.x,r=t.y;n=n||this.ctx,n.beginPath(),this.setStyle(i,n),n.moveTo(s,r),s=e.x,r=e.y,n.lineTo(s,r),n.stroke(),n.fill()},draw:function(t,e,i,n){var s=t.name,r=+(n&&n.x),o=+(n&&n.y),a=t.aabb().hw;if(i=i||this.ctx,e=e||this.options.styles[s]||this.options.styles.circle||{},i.save(),i.translate(r,o),"circle"===s)this.drawCircle(0,0,t.radius,e,i);else if("convex-polygon"===s)this.drawPolygon(t.vertices,e,i);else if("rectangle"===s)this.drawRect(0,0,t.width,t.height,e,i);else if("compound"===s)for(var h,l=0,c=t.children.length;c>l;l++)h=t.children[l],i.translate(h.pos.x,h.pos.y),i.rotate(h.angle),this.draw(h.g,e,i),i.rotate(-h.angle),i.translate(-h.pos.x,-h.pos.y);else this.drawCircle(0,0,1,e,i);return"compound"!==s&&e.angleIndicator&&(i.beginPath(),this.setStyle(e.angleIndicator,i),i.moveTo(0,0),i.lineTo(a,0),i.closePath(),i.stroke()),i.restore(),this},createView:function(t,e){var i,n=t.aabb(),s=n.hw+Math.abs(n.x),r=n.hh+Math.abs(n.y),o={x:s+1,y:r+1},a=this.hiddenCtx,h=this.hiddenCanvas;return e=e||this.options.styles[name]||this.options.styles.circle||{},e.src?(i=new Image,i.src=e.src,e.width&&(i.width=e.width),e.height&&(i.height=e.height),i):(o.x+=0|e.lineWidth,o.y+=0|e.lineWidth,h.width=2*s+2+(2*e.lineWidth|0),h.height=2*r+2+(2*e.lineWidth|0),this.draw(t,e,a,o),i=new Image(h.width,h.height),i.src=h.toDataURL("image/png"),i)},drawMeta:function(t){this.els.fps.innerHTML=t.fps.toFixed(2),this.els.ipf.innerHTML=t.ipf},drawBody:function(t,e,i,n){var s,r,o,a=t.state.pos,h=t.offset,l=t.state.vel,c=this._interpolateTime||0;n=n||this.options.offset,i=i||this.ctx,s=a._[0]+n.x+l._[0]*c,r=a._[1]+n.y+l._[1]*c,o=t.state.angular.pos+t.state.angular.vel*c,i.save(),i.translate(s,r),i.rotate(o),i.translate(h._[0],h._[1]),i.drawImage(e,-e.width/2,-e.height/2,e.width,e.height),i.restore()},render:function(t,e){this._world.emit("beforeRender",{renderer:this,meta:e}),this.options.meta&&this.drawMeta(e),this._interpolateTime=e.interpolateTime;for(var i in this._layers)this._layers[i].render();return this}}}),i.renderer("dom",function(t){if(!e)return{};var i={},n=e.createElement("div"),s=function(t){return t.replace(/(?:^|\s)\w/g,function(t){return t.toUpperCase()})},r=function(t){if(i[t])return i[t];for(var e,r=["Webkit","Moz","Ms","O"],o=0,a=r.length;a>o;++o)if(e=r[o]+s(t),e in n.style)return i[t]=e;return e in n.style?i[t]=t:!1},o="pjs-",a="px",h=r("transform"),l=r("borderRadius"),c=function(t,i){var n=e.createElement(t||"div");return i&&(n.innerHTML=i),n};return{init:function(e){t.init.call(this,e);var i=this.el;if(i.style.position="relative",i.style.overflow="hidden",i.style[h]="translateZ(0)",i.style.width=this.options.width+a,i.style.height=this.options.height+a,this.els={},e.meta){var n=c();n.className="pjs-meta",this.els.fps=c("span"),this.els.ipf=c("span"),n.appendChild(c("span","fps: ")),n.appendChild(this.els.fps),n.appendChild(c("br")),n.appendChild(c("span","ipf: ")),n.appendChild(this.els.ipf),i.appendChild(n)}this.options.autoResize?this.resize():this.resize(this.options.width,this.options.height)},resize:function(e,i){t.resize.call(this,e,i),this.el.style.width=this.width+a,this.el.style.height=this.height+a},pointProperties:function(t){t.style.width="2px",t.style.height="2px",t.style.marginLeft="-1px",t.style.marginTop="-1px",t.style[l]="50%"},circleProperties:function(t,e){var i=e.aabb();t.style.width=2*i.hw+a,t.style.height=2*i.hh+a,t.style.marginLeft=-i.hw+a,t.style.marginTop=-i.hh+a,t.style[l]="50%"},rectangleProperties:function(t,e){var i=e.aabb();t.style.width=2*i.hw+a,t.style.height=2*i.hh+a,t.style.marginLeft=-i.hw+a,t.style.marginTop=-i.hh+a},createView:function(t){var e,i=c(),n=t.name+"Properties";if(i.className=o+t.name,i.style.position="absolute",i.style.top="0px",i.style.left="0px","compound"===t.name)for(var s,r=0,a=t.children.length;a>r;r++)s=t.children[r],e=c(),e.className=o+t.name+" "+o+"child",e.style.position="absolute",e.style.top="0px",e.style.left="0px",this[s.g.name+"Properties"]&&this[s.g.name+"Properties"](e,s.g),e.style[h]="translate("+s.pos._[0]+"px,"+s.pos._[1]+"px) rotate("+s.angle+"rad)",i.appendChild(e);else this[n]&&this[n](i,t);return this.el.appendChild(i),i},connect:function(t){t.on("add:body",this.attach,this),t.on("remove:body",this.detach,this)},disconnect:function(t){t.off("add:body",this.attach,this),t.off("remove:body",this.detach,this)},detach:function(t){var e=t.nodeType&&t||t.body&&t.body.view,i=e&&e.parentNode;return e&&i&&i.removeChild(e),this},attach:function(t){var e=t.nodeType&&t||t.body&&t.body.view;return e&&this.el.appendChild(e),this},drawMeta:function(t){this.els.fps.innerHTML=t.fps.toFixed(2),this.els.ipf.innerHTML=t.ipf},drawBody:function(t,e){var i,n,s,r=t.state.pos,o=t.state.vel,a=t.offset,l=this._interpolateTime;i=r._[0]+o._[0]*l,n=r._[1]+o._[1]*l,s=t.state.angular.pos+t.state.angular.vel*l,e.style[h]="translate("+i+"px,"+n+"px) rotate("+s+"rad) translate("+a._[0]+"px,"+a._[1]+"px)"}}}),i.renderer("pixi",function(n){if(!e)return{};var s=(2*Math.PI,{white:"0xFFFFFF",violet:"0x542437",blue:"0x53777A"}),r={font:"18px monospace",fill:"black",align:"left"},o={metaEl:null,offset:{x:0,y:0},styles:{color:!1,point:s.blue,circle:{strokeStyle:s.blue,lineWidth:1,fillStyle:s.blue,angleIndicator:s.white,fillAlpha:1,strokeAlpha:1,alpha:1},rectangle:{strokeStyle:s.violet,lineWidth:1,fillStyle:s.violet,angleIndicator:s.white,fillAlpha:1,strokeAlpha:1,alpha:1},"convex-polygon":{strokeStyle:s.violet,lineWidth:1,fillStyle:s.violet,angleIndicator:s.white,fillAlpha:1,strokeAlpha:1,alpha:1}}};return{init:function(s){var r,a,h=this;if("undefined"==typeof PIXI)throw"PIXI not present - cannot continue";n.init.call(this,s),this.options.defaults(o,!0),this.options.onChange(function(){h.options.offset=new i.vector(h.options.offset)}),this.options(s,!0),a=!this.options.styles.color||"transparent"===this.options.styles.color,this.stage=new PIXI.Stage(this.options.styles.color),this.meta={},r=this.el&&"CANVAS"===this.el.nodeName?r:null,this.renderer=new PIXI.autoDetectRenderer(this.options.width,this.options.height,{view:r,transparent:a,resolution:t.devicePixelRatio||1}),r||(this.el=this.el||e.body,this.el.appendChild(this.renderer.view)),this.options.autoResize?this.resize():this.resize(this.options.width,this.options.height)},resize:function(t,e){n.resize.call(this,t,e),this.renderer.resize(this.width,this.height)},connect:function(t){t.on("add:body",this.attach,this),t.on("remove:body",this.detach,this)},disconnect:function(t){t.off("add:body",this.attach,this),t.off("remove:body",this.detach,this)},detach:function(t){var e=t instanceof PIXI.Graphics&&t||t.body&&t.body.view;return e&&this.stage.removeChild(e),this},attach:function(t){var e=t instanceof PIXI.Graphics&&t||t.body&&t.body.view;return e&&this.stage.addChild(e),this},loadSpriteSheets:function(t,e){if(!i.util.isArray(t))throw"Spritesheets must be defined in arrays";var n=this,s=new PIXI.AssetLoader(t);return s.load(),s.on("onComplete",function(){n.assetsLoaded=!0,e()}),n},drawBody:function(t,e){var i,n,s,r=t.state.pos,o=t.state.vel,a=t.offset,h=this._interpolateTime||0;i=r._[0]+o._[0]*h,n=r._[1]+o._[1]*h,s=t.state.angular.pos+t.state.angular.vel*h,e.position.set(i,n),e.pivot.set(-a._[0],-a._[1]),e.rotation=s},render:function(t,e){n.render.call(this,t,e),this.renderer.render(this.stage)},setStyles:function(t,e){return i.util.isObject(e)?(e.fillStyle&&"transparent"!==e.fillStyle?(t.beginFill(e.fillStyle),t.fillAlpha=void 0!==e.fillAlpha?e.fillAlpha:1):(t.beginFill(),t.fillAlpha=0),t.lineStyle(e.lineWidth||0,e.strokeStyle,void 0!==e.strokeAlpha?e.strokeAlpha:1),t.alpha=void 0!==e.alpha?e.alpha:1):(e&&"transparent"!==e?t.beginFill(e):(t.beginFill(),t.fillAlpha=0),t.lineStyle(0)),t},createCircle:function(t,e,i,n){var s=new PIXI.Graphics;return this.setStyles(s,n),s.drawCircle(t,e,i),s.endFill(),s},createRect:function(t,e,i,n,s){var r=new PIXI.Graphics;return this.setStyles(r,s),r.drawRect(t,e,i,n),r.endFill(),r},createPolygon:function(t,e){var i=t[0],n=i.x,s=i.y,r=t.length,o={x:n,y:s},a=new PIXI.Graphics;this.setStyles(a,e),a.moveTo(n,s);for(var h=1;r>h;++h)i=t[h],n=i.x,s=i.y,a.lineTo(n,s);return r>2&&a.lineTo(o.x,o.y),a.endFill(),a},createLine:function(t,e,i){var n=t.x,s=t.y,r=new PIXI.Graphics;return this.setStyles(r,i),r.moveTo(n,s),n=e.x,s=e.y,r.lineTo(n,s),r.endFill(),r},createView:function(t,e,i){var n=null,s=t.aabb(),r=s.hw+Math.abs(s.x),o=(s.hh+Math.abs(s.y),t.name);if(i=i||this.stage,e=e||this.options.styles[o]||this.options.styles.circle||{},e.src)return n=PIXI.Sprite.fromImage(e.src),n.anchor.set(.5,.5),e.anchor&&(n.anchor.x=e.anchor.x,n.anchor.y=e.anchor.y),e.width&&(n.width=e.width),e.height&&(n.height=e.height),i.addChild(n),n;if("circle"===o)n=this.createCircle(0,0,t.radius,e);else if("convex-polygon"===o)n=this.createPolygon(t.vertices,e);else if("rectangle"===o)n=this.createRect(-t.width/2,-t.height/2,t.width,t.height,e);else if("compound"===o){n=new PIXI.Graphics;for(var a,h,l=0,c=t.children.length;c>l;l++)a=t.children[l],h=this.createView(a.g,e,n),h.position.set(a.pos.x,a.pos.y),h.rotation=a.angle}else n=this.createCircle(0,0,1,e);return"compound"!==o&&e.angleIndicator&&"transparent"!==e.angleIndicator&&(n.lineStyle(e.lineWidth,e.angleIndicator),n.moveTo(0,0),n.lineTo(r,0)),"compound"!==o&&(n.cacheAsBitmap=!0),i.addChild(n),n},drawMeta:function(t){this.meta.loaded?(this.meta.fps.setText("FPS: "+t.fps.toFixed(2)),this.meta.ipf.setText("IPF: "+t.ipf)):(this.meta.fps=new PIXI.Text("FPS: "+t.fps.toFixed(2),r),this.meta.fps.position.x=15,this.meta.fps.position.y=5,this.meta.ipf=new PIXI.Text("IPF: "+t.ipf,r),this.meta.ipf.position.x=15,this.meta.ipf.position.y=30,this.stage.addChild(this.meta.fps),this.stage.addChild(this.meta.ipf),this.meta.loaded=!0)},createDisplay:function(t,e){var i=null,n=null;switch(t){case"sprite":return n=PIXI.Texture.fromImage(e.texture),i=new PIXI.Sprite(n),e.anchor&&(i.anchor.x=e.anchor.x,i.anchor.y=e.anchor.y),e.container?e.container.addChild(i):this.stage.addChild(i),i;case"movieclip":if(!this.assetsLoaded)throw"No assets have been loaded. Use loadSpritesheet() first";var s=[],r=0;for(r;r<e.frames.length;r++)n=PIXI.Texture.fromFrame(e.frames[r]),s.push(n);return i=new PIXI.MovieClip(s),e.anchor&&(i.anchor.x=e.anchor.x,i.anchor.y=e.anchor.y),e.container?e.container.addChild(i):this.stage.addChild(i),i;default:throw"Invalid PIXI.DisplayObject passed"}},centerAnchor:function(t){null!==t&&(t.anchor.x=.5,t.anchor.y=.5)}}}),i});(function(t,e){"use strict";if(typeof define==="function"&&define.amd){define(["exports"],e)}else if(typeof exports==="object"){e(exports)}else{var i={};t.PubSub=i;e(i)}})(typeof window==="object"&&window||this,function(t){"use strict";var e={},i=-1;function n(t){var e;for(e in t){if(t.hasOwnProperty(e)){return true}}return false}function s(t){return function e(){throw t}}function r(t,e,i){try{t(e,i)}catch(n){setTimeout(s(n),0)}}function o(t,e,i){t(e,i)}function a(t,i,n,s){var a=e[i],h=s?o:r,l;if(!e.hasOwnProperty(i)){return}for(l in a){if(a.hasOwnProperty(l)){h(a[l],t,n)}}}function h(t,e,i){return function n(){var n=String(t),s=n.lastIndexOf(".");a(t,t,e,i);while(s!==-1){n=n.substr(0,s);s=n.lastIndexOf(".");a(t,n,e,i)}}}function l(t){var i=String(t),s=Boolean(e.hasOwnProperty(i)&&n(e[i])),r=i.lastIndexOf(".");while(!s&&r!==-1){i=i.substr(0,r);r=i.lastIndexOf(".");s=Boolean(e.hasOwnProperty(i)&&n(e[i]))}return s}function c(t,e,i,n){var s=h(t,e,n),r=l(t);if(!r){return false}if(i===true){s()}else{setTimeout(s,0)}return true}t.publish=function(e,i){return c(e,i,false,t.immediateExceptions)};t.publishSync=function(e,i){return c(e,i,true,t.immediateExceptions)};t.subscribe=function(t,n){if(typeof n!=="function"){return false}if(!e.hasOwnProperty(t)){e[t]={}}var s="uid_"+String(++i);e[t][s]=n;return s};t.clearAllSubscriptions=function u(){e={}};t.clearSubscriptions=function d(t){var i;for(i in e){if(e.hasOwnProperty(i)&&i.indexOf(t)===0){delete e[i]}}};t.unsubscribe=function(t){var i=typeof t==="string"&&e.hasOwnProperty(t),n=!i&&typeof t==="string",s=typeof t==="function",r=false,o,a,h;if(i){delete e[t];return}for(o in e){if(e.hasOwnProperty(o)){a=e[o];if(n&&a[t]){delete a[t];r=t;break}if(s){for(h in a){if(a.hasOwnProperty(h)&&a[h]===t){delete a[h];r=true}}}}}return r}});function Application(){}Application.prototype.init=function(){this.windowWidth=window.innerWidth;this.windowHeight=window.innerHeight;this.pause=false;this.leftColor=getcomputedStyleAttr("paddleLeft","color");this.rightColor=getcomputedStyleAttr("paddleRight","color");this.scoreboard=new Scoreboard;this.referee=new Referee;this.playerPaddleControls=new PlayerPaddleControls;this.computerPaddleControls=new ComputerPaddleControls;this.canvas=new Canvas;this.canvas.init({canvasId:"canvas",physicsCanvasId:"physics",renderPhysics:false,bounds:{top:this.scoreboard.HEIGHT,bottom:this.windowHeight,left:0,right:this.windowWidth}});this.scoreboard.init({scoreLeftId:"scoreLeft",scoreRightId:"scoreRight"});this.referee.init();this.pubSubTokens=[["gameover",PubSub.subscribe("gameOver",this.reset.bind(this))]];this.initPaddlesBalls();this.initBlocks();window.requestAnimationFrame(this.update.bind(this));window.addEventListener("resize",this.reset.bind(this));window.addEventListener("keyup",this.keyUpHandler.bind(this))};Application.prototype.initPaddlesBalls=function(){var t=null;var e=null;e=this.canvas.addPaddle({name:"paddleLeft",x:5,y:this.windowHeight/2-Paddle.prototype.HEIGHT/2,color:this.leftColor});this.canvas.addBall({name:"ballLeft",x:5+Paddle.prototype.WIDTH,y:this.windowHeight/2-Ball.prototype.HEIGHT/2,color:this.leftColor});t=this.canvas.addPaddle({name:"paddleRight",x:this.windowWidth-5-Paddle.prototype.WIDTH,y:this.windowHeight/2-Paddle.prototype.HEIGHT/2,color:this.rightColor});this.canvas.addBall({name:"ballRight",x:this.windowWidth-5-Paddle.prototype.WIDTH-Ball.prototype.WIDTH,y:this.windowHeight/2-Ball.prototype.HEIGHT/2,color:this.rightColor});this.playerPaddleControls.init({paddle:t});this.computerPaddleControls.init({paddle:e})};Application.prototype.initBlocks=function(){var t=2;var e=.15;var i={left:this.windowWidth/2-this.windowWidth*e,right:this.windowWidth/2+this.windowWidth*e,top:this.canvas.bounds.top+t,bottom:this.canvas.bounds.bottom-t};var n=[];var s=[];Block.prototype.HEIGHT=Block.prototype.WIDTH=(i.bottom-i.top)/10;n=range(i.top,i.bottom,Block.prototype.HEIGHT+t);s=range(i.left,i.right,Block.prototype.WIDTH+t);fjs.each(function(t,e){fjs.each(function(i,n){var s=Math.random()>.6?true:false;var r=null;var o=null;if(s){result=Math.random()>.5?{color:this.leftColor,prizeFor:"paddleLeft"}:{color:this.rightColor,prizeFor:"paddleRight"};r=result.prizeFor;o=result.color}else{o=Block.prototype.COLOR;r=null}this.canvas.addBlock({name:"block"+e+"_"+n,x:i,y:t,color:o,prizeFor:r})}.bind(this),s)}.bind(this),n)};Application.prototype.update=function(){var t=null;if(this.pause){this.requestAnimationFrameId=window.requestAnimationFrame(this.update.bind(this));return}this.now=Date.now();if(!this.then){this.then=this.now}t=(this.now-this.then)/1e3;if(this.canvas.update(t)===true){this.requestAnimationFrameId=window.requestAnimationFrame(this.update.bind(this))}else{window.cancelAnimationFrame(this.requestAnimationFrameId)}this.then=this.now};Application.prototype.reset=function(){this.canvas.reset();this.scoreboard.reset();this.referee.reset();this.playerPaddleControls.reset();this.computerPaddleControls.reset();PubSub.clearAllSubscriptions();window.removeEventListener("resize",this.reset);fjs.each(function(t){PubSub.unsubscribe(t[1])}.bind(this),this.pubSubTokens);this.init()};Application.prototype.keyUpHandler=function(t){if(t.which===80){this.togglePause()}};Application.prototype.togglePause=function(){this.pause=!this.pause};function Ball(){}Ball.prototype=Object.create(CanvasElement.prototype);Ball.prototype.constructor=Ball;Ball.prototype.WIDTH=function(){var t=getcomputedStyleAttr("ballLeft","width");return parseInt(t.replace("px",""),10)}();Ball.prototype.HEIGHT=function(){var t=getcomputedStyleAttr("ballLeft","height");return parseInt(t.replace("px",""),10)}();function Block(){}Block.prototype=Object.create(CanvasElement.prototype);Block.prototype.constructor=Block;Block.prototype.WIDTH=function(){var t=getcomputedStyleAttr("blockBase","width");return parseInt(t.replace("px",""),10)}();Block.prototype.HEIGHT=function(){var t=getcomputedStyleAttr("blockBase","height");return parseInt(t.replace("px",""),10)}();Block.prototype.COLOR=function(){return getcomputedStyleAttr("blockBase","color")}();Block.prototype.init=function(t){CanvasElement.prototype.init.call(this,t);this.prizeFor=t.prizeFor||null;this.deleted=false};Block.prototype.isPrize=function(){return this.prizeFor!==null};Block.prototype.isPrizeForRight=function(){return this.isPrizeFor("right")};Block.prototype.isPrizeForLeft=function(){return this.isPrizeFor("left")};Block.prototype.isPrizeFor=function(t){if(!this.isPrize()){return false}return this.prizeFor.toLowerCase().indexOf(t.toLowerCase())>-1};function Canvas(){}Canvas.prototype.init=function(t){this.initParams=t;this.bounds=t.bounds;this.canvasId=t.canvasId;this.physicsCanvasId=t.physicsCanvasId;this.renderPhysics=t.renderPhysics;this.canvasNode=getNodeById(this.canvasId);this.canvasNode.width=window.innerWidth;this.canvasNode.height=window.innerHeight;this.paddles=[];this.balls=[];this.blocks=[];this.prizes=[];this.delta=0;this.stage=new createjs.Stage(this.canvasId);this.ballVelX=this.ballVelY=1;this.initPhysics();this.pubSubTokens=[];this.pubSubTokens.push(["updatePaddle",PubSub.subscribe("updatePaddle",this.updatePaddleFromMessage.bind(this))],["updateBlock",PubSub.subscribe("updateBlock",this.updateBlockFromMessage.bind(this))],["shakeCanvas",PubSub.subscribe("shakeCanvas",this.shakeCanvasAsync.bind(this))]);this.ready=true};Canvas.prototype.initPhysics=function(){var t=null;var e=null;this.world=Physics();if(this.renderPhysics){t=Physics.renderer("canvas",{el:this.physicsCanvasId,width:this.canvasNode.width,height:this.canvasNode.height});this.world.add(t)}else{e=getNodeById(this.physicsCanvasId);if(e){e.parentNode.removeChild(e)}}this.world.add(Physics.behavior("constant-acceleration"));this.world.add(Physics.behavior("body-impulse-response"));this.world.add(Physics.behavior("body-collision-detection"));this.world.add(Physics.behavior("sweep-prune"));this.worldBoundingBox=Physics.aabb(this.bounds.left,this.bounds.top,this.bounds.right,this.bounds.bottom);this.worldBoundingBox=Physics.behavior("edge-collision-detection",{aabb:this.worldBoundingBox,restitution:.5,cof:0});this.worldBoundingBox.body.canvasElementType="aabb";this.world.add(this.worldBoundingBox);this.world.on("collisions:detected",this.bodyCollisions.bind(this))};Canvas.prototype.update=function(t){if(this.ready===false){return false}this.delta=t;this.updateToPhysics();this.world.step(Date.now());this.updateFromPhysics();if(this.renderPhysics){this.world.render()}this.stage.update();return true};Canvas.prototype.reset=function(){this.ready=false;this.paddles=[];this.balls=[];this.blocks=[];this.prizes=[];this.stage.removeAllChildren();this.stage.removeAllEventListeners();this.stage=undefined;fjs.each(function(t){PubSub.unsubscribe(t[1])}.bind(this),this.pubSubTokens);this.world.destroy();this.world=undefined};Canvas.prototype.addPaddle=function(t){var e=this.addCanvasElement(Paddle,t);this.addStageRect(e);this.addPhysics(e,e.constructor.name,"rectangle",{x:e.x+e.WIDTH/2,y:e.y+e.HEIGHT/2,width:e.WIDTH,height:e.HEIGHT,treatment:"static",restitution:1,cof:0});return e};Canvas.prototype.addBlock=function(t){var e=this.addCanvasElement(Block,t);this.addStageRect(e);this.addPhysics(e,e.constructor.name,"rectangle",{x:e.x+e.WIDTH/2,y:e.y+e.HEIGHT/2,width:e.WIDTH,height:e.HEIGHT,mass:10,vy:1,restitution:1,cof:1})};Canvas.prototype.addBall=function(t){var e=this.addCanvasElement(Ball,t);this.addStageCirc(e);this.addPhysics(e,e.constructor.name,"circle",{x:e.x+e.WIDTH/2,y:e.y+e.HEIGHT/2,vx:t.name.toLowerCase().indexOf("right")!=-1?-2:2,vy:.5,radius:e.WIDTH/2,mass:5,restitution:1,cof:1})};Canvas.prototype.addCanvasElement=function(t,e){var i=this.getArrayKeyByType(t);var n=null;n=new t;n.init(e);this[i].push(n);return n};Canvas.prototype.addPhysics=function(t,e,i,n){var s=Physics.body(i,n);if(s){s.canvasElementType=e;s.canvasElement=t;t.physics=s;this.world.add(s)}return s};Canvas.prototype.addStageRect=function(t){return this.addStageShape(t,"drawRect")};Canvas.prototype.addStageCirc=function(t){return this.addStageShape(t,"drawEllipse")};Canvas.prototype.addStageShape=function(t,e){var i,n=null;i=new createjs.Shape;i.graphics.beginFill(t.color)[e](0,0,t.WIDTH,t.HEIGHT);i.x=t.x;i.y=t.y;i.regX=t.WIDTH/2;i.regY=t.HEIGHT/2;n=this.stage.addChild(i);n.canvasElement=t;t.view=n;t.id=n.id;return i};Canvas.prototype.updatePaddleFromMessage=function(t,e){this.updatePaddle(e.name,e)};Canvas.prototype.updateBlockFromMessage=function(t,e){this.updateBlock(e.name,e)};Canvas.prototype.updatePaddle=function(t,e){this.updateType(t,e,Paddle)};Canvas.prototype.updateBall=function(t,e){this.updateType(t,e,Ball)};Canvas.prototype.updateBlock=function(t,e){this.updateType(t,e,Block)};Canvas.prototype.updateType=function(t,e,i){var n=this.findByNameType(t,i);var s=i.name.toLowerCase();if(n){if(e.x){n.x=e.x;n.view.x=e.x}if(e.y){n.y=e.y;n.view.y=e.y}if(e.rotRad){n.rotRad=e.rotRad;n.view.rotation=radToDeg(e.rotRad)}if(e.color){n.changeColor(e.color)}e={};e[s]=n;PubSub.publish(s+"Updated",e)}};Canvas.prototype.removeByNameType=function(t,e){var i=this.findByNameType(t,e);var n=this.getArrayKeyByType(e);if(i&&this[n]){this[n]=fjs.select("x => x.name !== '"+t+"'",this[n]);if(n=="blocks"&&this[n].length<=0){PubSub.publish("noMoreBlocks",{})}}};Canvas.prototype.findByNameType=function(t,e){var i=this.getArrayKeyByType(e);return fjs.first("x => x.name === '"+t+"'",this[i])};Canvas.prototype.getArrayKeyByType=function(t){if(!t){return""}return t.name.toLowerCase()+"s"};Canvas.prototype.updateToPhysics=function(){if(!this.world){return}fjs.each(function(t){var e=null;if(t.canvasElementType==="Ball"){e=t.state.vel;t.state.vel=Physics.vector(e.x+sign(e.x)*this.ballVelX*this.delta,e.y+sign(e.y)*this.ballVelY*this.delta)}else if(t.canvasElementType==="Paddle"){t.state.pos=Physics.vector(t.canvasElement.x,t.canvasElement.y);t.state.angular.pos=t.canvasElement.rotRad}}.bind(this),this.world.getBodies())};Canvas.prototype.updateFromPhysics=function(){var t=null;if(!this.world){return}fjs.each(function(e){t={x:e.state.pos.x,y:e.state.pos.y,rotRad:e.state.angular.pos};if(e.canvasElementType==="Ball"){this.updateBall(e.canvasElement.name,t)}else if(e.canvasElementType==="Block"){this.updateBlock(e.canvasElement.name,t)}}.bind(this),this.world.getBodies())};Canvas.prototype.bodyCollisions=function(t){var e=t.collisions;function i(t,e,i){return fjs.first("x => x.canvasElementType === '"+i+"'",[t,e])}fjs.each(function(t){var e=t.bodyA;var n=t.bodyB;var s=fjs.curry(i)(e,n);var r=s("Block");var o=s("Ball");var a=s("Paddle");var h=s("aabb");function l(){if(!this.ready){return}this.stage.removeChild(r.canvasElement.view);this.world.remove(r);r.canvasElement.deleted=true;this.removeByNameType(r.canvasElement.name,Block)}if(r&&o){PubSub.publish("blockBallHit",{ball:o.canvasElement,block:r.canvasElement});window.setTimeout(l.bind(this),200)}if(o&&a){PubSub.publish("ballPaddleHit",{ball:o.canvasElement,paddle:a.canvasElement});this.ballVelX=this.ballVelY+=1e-4}if(o&&h){PubSub.publish("boundingBoxBallHit",{ball:o.canvasElement,boundingBox:h})}}.bind(this),e)};Canvas.prototype.shakeCanvasAsync=function(){window.setTimeout(this.shakeCanvas.bind(this),0)};Canvas.prototype.shakeCanvas=function(){if(!this.shakeCanvasSteps){this.shakeCanvasSteps=0}if(this.shakeCanvasSteps<=20){if(this.shakeCanvasSteps%2===0){this.canvasNode.style.position="absolute";this.canvasNode.style.top="-5px"}else{this.canvasNode.style.position="absolute";this.canvasNode.style.top="10px"}this.shakeCanvasSteps+=1;window.setTimeout(this.shakeCanvas.bind(this),10)}else{this.shakeCanvasSteps=0;this.canvasNode.style.position="absolute";this.canvasNode.style.top="0px"}};function CanvasElement(){}CanvasElement.prototype.init=function(t){this.initParams=t;this.id=t.id;this.name=t.name;this.x=t.x;this.y=t.y;this.color=t.color;this.rotRad=t.rotRad||0;this.view=null;this.physics=null};CanvasElement.prototype.changeColor=function(t){if(!this.view||!t){return}this.view.graphics._fill.style=t};CanvasElement.prototype.isRight=function(){return this.isSide("right")};CanvasElement.prototype.isLeft=function(){return this.isSide("left")};CanvasElement.prototype.isSide=function(t){if(!this.name||!t){return false}return this.name.toLowerCase().indexOf(t.toLowerCase())>-1};function ComputerPaddleControls(){}ComputerPaddleControls.prototype=Object.create(PaddleControls.prototype);ComputerPaddleControls.prototype.constructor=ComputerPaddleControls;ComputerPaddleControls.prototype.init=function(t){this.pubSubTokens=[];PaddleControls.prototype.init.call(this,t)};ComputerPaddleControls.prototype.movePaddle=function(t,e){var i=null;if(!e){return}i=e.ball;if(!i){return}if(i.name==="ballRight"){PubSub.publish("updatePaddle",{name:this.paddle.name,y:i.y-i.HEIGHT/2})}};ComputerPaddleControls.prototype.enable=function(){if(!this.pubSubTokens){return}this.pubSubTokens.push(["ballUpdated",PubSub.subscribe("ballUpdated",this.movePaddle.bind(this))])};ComputerPaddleControls.prototype.disable=function(){if(!this.pubSubTokens){return}fjs.each(function(t){PubSub.unsubscribe(t[1])}.bind(this),this.pubSubTokens)};function init(){var t=getNodeById("overlay");var e=new Application;e.init();overlay.style.visibility="hidden"}function Paddle(){}Paddle.prototype=Object.create(CanvasElement.prototype);Paddle.prototype.constructor=Paddle;Paddle.prototype.WIDTH=function(){var t=getcomputedStyleAttr("paddleLeft","width");return parseInt(t.replace("px",""),10)}();Paddle.prototype.HEIGHT=function(){var t=getcomputedStyleAttr("paddleLeft","height");return parseInt(t.replace("px",""),10)}();function PaddleControls(){}PaddleControls.prototype.init=function(t){if(!t||!t.paddle){return}this.initParams=t;this.paddle=t.paddle;this.enable()};PaddleControls.prototype.movePaddle=function(){};PaddleControls.prototype.enable=function(){};PaddleControls.prototype.disable=function(){};PaddleControls.prototype.reset=function(){this.disable()};function PlayerPaddleControls(){}PlayerPaddleControls.prototype=Object.create(PaddleControls.prototype);PlayerPaddleControls.prototype.constructor=PlayerPaddleControls;PlayerPaddleControls.prototype.movePaddle=function(t){var e=t.clientY;var i=t.clientX/window.innerWidth*6.283185307179586;PubSub.publish("updatePaddle",{name:this.paddle.name,y:e,rotRad:i})};PaddleControls.prototype.enable=function(){window.addEventListener("mousemove",this.movePaddle.bind(this))};PaddleControls.prototype.disable=function(){window.removeEventListener("mousemove",this.movePaddle.bind(this))};function Referee(){}Referee.prototype.init=function(t){if(!t){t={}}this.initParams=t;this.pubSubTokens=[];this.pubSubTokens.push(["blockBallHit",PubSub.subscribe("blockBallHit",this.blockBallHit.bind(this))],["ballPaddleHit",PubSub.subscribe("ballPaddleHit",this.ballPaddleHit.bind(this))],["boundingBoxBallHit",PubSub.subscribe("boundingBoxBallHit",this.boundingBoxBallHit.bind(this))],["noMoreBlocks",PubSub.subscribe("noMoreBlocks",this.gameOver.bind(this))])};Referee.prototype.reset=function(){this.pubSubTokens.forEach(function(t){PubSub.unsubscribe(t[1])})};Referee.prototype.blockBallHit=function(t,e){var i=e.ball;var n=e.block;if(!i||!n){return}if(i.isRight()&!n.isPrize()){PubSub.publish("updateScore",{scoreRight:{
score:1}});PubSub.publish("updateBlock",{name:n.name,color:"#f1c40f"})}else if(i.isRight()&&n.isPrizeForRight()){PubSub.publish("updateScore",{scoreRight:{score:20}});PubSub.publish("updateBlock",{name:n.name,color:"#7459FF"})}else if(i.isRight()&&n.isPrizeForLeft()){PubSub.publish("updateScore",{scoreLeft:{score:10}});PubSub.publish("shakeCanvas",{});PubSub.publish("updateBlock",{name:n.name,color:"#e74c3c"})}else if(i.isLeft()&&!n.isPrize()){PubSub.publish("updateScore",{scoreLeft:{score:1}});PubSub.publish("updateBlock",{name:n.name,color:"#f1c40f"})}else if(i.isLeft()&&n.isPrizeForLeft()){PubSub.publish("updateScore",{scoreLeft:{score:20}});PubSub.publish("updateBlock",{name:n.name,color:"#7459FF"})}else if(i.isLeft()&&n.isPrizeForRight()){PubSub.publish("updateScore",{scoreRight:{score:10}});PubSub.publish("updateBlock",{name:n.name,color:"#e74c3c"})}};Referee.prototype.ballPaddleHit=function(t,e){var i=e.ball;var n=e.paddle;if(!i||!n){return}if(i.isRight()&&n.isLeft()){PubSub.publish("updateScore",{scoreRight:{score:5}})}else if(i.isLeft()&&n.isRight()){PubSub.publish("updateScore",{scoreLeft:{score:5}});PubSub.publish("shakeCanvas",{})}};Referee.prototype.boundingBoxBallHit=function(t,e){var i=e.ball;if(!i){return}if(i.isRight()){PubSub.publish("updateScore",{scoreLeft:{score:1}});PubSub.publish("shakeCanvas",{})}else if(i.isLeft()){PubSub.publish("updateScore",{scoreRight:{score:1}})}};Referee.prototype.gameOver=function(t,e){PubSub.publish("gameOver",{})};function Scoreboard(){}Scoreboard.prototype.init=function(t){this.initParams=t;this.scoreLeftId=t.scoreLeftId;this.scoreRightId=t.scoreRightId;this.scoreLeftElement=getNodeById(this.scoreLeftId);this.scoreRightElement=getNodeById(this.scoreRightId);this.scoreElements=[this.scoreLeftElement,this.scoreRightElement];this.updateScorePubSubToken=PubSub.subscribe("updateScore",this.updateScore.bind(this));this.setEachScore(t.initialScore||0)};Scoreboard.prototype.HEIGHT=function(){var t=getcomputedStyleAttr("scoreLeft","height");return parseInt(t.replace("px",""),10)}();Scoreboard.prototype.reset=function(){this.setEachScore(0);this.scoreElements=undefined;PubSub.unsubscribe(this.updateScorePubSubToken)};Scoreboard.prototype.setEachScore=function(t){fjs.each(function(e){e.innerHTML=t}.bind(this),this.scoreElements)};Scoreboard.prototype.updateScore=function(t,e){if(e.scoreLeft){this.updateScoreLeft(e.scoreLeft.score)}if(e.scoreRight){this.updateScoreRight(e.scoreRight.score)}};Scoreboard.prototype.updateScoreLeft=function(t){this.updateScoreSide(t,0)};Scoreboard.prototype.updateScoreRight=function(t){this.updateScoreSide(t,1)};Scoreboard.prototype.updateScoreSide=function(t,e){var i=this.scoreElements[e].innerHTML;if(e<this.scoreElements.length){this.scoreElements[e].innerHTML=parseInt(i,10)+t}};function getcomputedStyleAttr(t,e){var i=getNodeById(t);return getComputedStyle(i)[e]}function getNodeById(t){return document.getElementById(t)}function range(t,e,i){var n=[];if(typeof i==="undefined"){i=1}if(t&&e&&i){while(t<=e){n.push(t);t+=i}}return n}function radToDeg(t){if(typeof t!=="number"){return 0}return t*(180/3.141592653589793)}function sign(t){if(typeof t!=="number"){return 1}if(t>=0){return 1}else{return-1}}